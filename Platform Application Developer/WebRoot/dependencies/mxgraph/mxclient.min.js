var a,mxClient={VERSION:"1.4.0.9",IS_IE:navigator.userAgent.indexOf("MSIE")>=0,IS_IE6:navigator.userAgent.indexOf("MSIE 6")>=0,IS_NS:navigator.userAgent.indexOf("Mozilla/")>=0&&navigator.userAgent.indexOf("MSIE")<0,IS_OP:navigator.userAgent.indexOf("Opera/")>=0,IS_OT:navigator.userAgent.indexOf("Presto/2.4")<0&&navigator.userAgent.indexOf("Presto/2.3")<0&&navigator.userAgent.indexOf("Presto/2.2")<0&&navigator.userAgent.indexOf("Presto/2.1")<0&&navigator.userAgent.indexOf("Presto/2.0")<0&&navigator.userAgent.indexOf("Presto/1")<
0,IS_SF:navigator.userAgent.indexOf("AppleWebKit/")>=0&&navigator.userAgent.indexOf("Chrome/")<0,IS_GC:navigator.userAgent.indexOf("Chrome/")>=0,IS_MT:navigator.userAgent.indexOf("Firefox/")>=0&&navigator.userAgent.indexOf("Firefox/1")<0&&navigator.userAgent.indexOf("Firefox/2")<0||navigator.userAgent.indexOf("Iceweasel/")>=0&&navigator.userAgent.indexOf("Iceweasel/1")<0&&navigator.userAgent.indexOf("Iceweasel/2")<0||navigator.userAgent.indexOf("SeaMonkey/")>=0&&navigator.userAgent.indexOf("SeaMonkey/1")<
0||navigator.userAgent.indexOf("Iceape/")>=0&&navigator.userAgent.indexOf("Iceape/1")<0,IS_SVG:navigator.userAgent.indexOf("Firefox/")>=0||navigator.userAgent.indexOf("Iceweasel/")>=0||navigator.userAgent.indexOf("Seamonkey/")>=0||navigator.userAgent.indexOf("Iceape/")>=0||navigator.userAgent.indexOf("Galeon/")>=0||navigator.userAgent.indexOf("Epiphany/")>=0||navigator.userAgent.indexOf("AppleWebKit/")>=0||navigator.userAgent.indexOf("Gecko/")>=0||navigator.userAgent.indexOf("Opera/")>=0,NO_FO:navigator.userAgent.indexOf("Firefox/1")>=
0||navigator.userAgent.indexOf("Iceweasel/1")>=0||navigator.userAgent.indexOf("Firefox/2")>=0||navigator.userAgent.indexOf("Iceweasel/2")>=0||navigator.userAgent.indexOf("SeaMonkey/1")>=0||navigator.userAgent.indexOf("Iceape/1")>=0||navigator.userAgent.indexOf("Camino/1")>=0||navigator.userAgent.indexOf("Epiphany/2")>=0||navigator.userAgent.indexOf("Opera/")>=0||navigator.userAgent.indexOf("Mozilla/2")>=0,IS_VML:navigator.appName.toUpperCase()=="MICROSOFT INTERNET EXPLORER",IS_MAC:navigator.userAgent.toUpperCase().indexOf("MACINTOSH")>
0,IS_TOUCH:navigator.userAgent.toUpperCase().indexOf("IPAD")>0||navigator.userAgent.toUpperCase().indexOf("IPOD")>0||navigator.userAgent.toUpperCase().indexOf("IPHONE")>0,IS_LOCAL:document.location.href.indexOf("http://")<0&&document.location.href.indexOf("https://")<0,WINDOW_SHADOWS:true,TOOLTIP_SHADOWS:true,MENU_SHADOWS:true,isBrowserSupported:function(){return this.IS_IE||this.IS_NS},link:function(b,d,e){e=e||document;if(this.IS_IE6)e.write('<link rel="'+b+'" href="'+d+'" charset="ISO-8859-1" type="text/css"/>');
else{var f=e.createElement("link");f.setAttribute("rel",b);f.setAttribute("href",d);f.setAttribute("charset","ISO-8859-1");f.setAttribute("type","text/css");e.getElementsByTagName("head")[0].appendChild(f)}},include:function(b){document.write('<script src="'+b+'"><\/script>')},unload:function(){mxEvent.release(document.documentElement);mxEvent.release(window)}};
if(typeof mxBasePath!="undefined"&&mxBasePath.length>0){if(mxBasePath.substring(mxBasePath.length-1)=="/")mxBasePath=mxBasePath.substring(0,mxBasePath.length-1);mxClient.basePath=mxBasePath}else mxClient.basePath=".";if(typeof mxImageBasePath!="undefined"&&mxImageBasePath.length>0){if(mxImageBasePath.substring(mxImageBasePath.length-1)=="/")mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1);mxClient.imageBasePath=mxImageBasePath}else mxClient.imageBasePath=mxClient.basePath+"/images";
if(typeof mxLanguage!="undefined")mxClient.language=mxLanguage;else{mxClient.language=mxClient.IS_IE?navigator.userLanguage:navigator.language;var dash=mxClient.language.indexOf("-");if(dash>0)mxClient.language=mxClient.language.substring(0,dash)}mxClient.link("stylesheet",mxClient.basePath+"/css/common.css");
if(mxClient.IS_IE){document.namespaces.add("v","urn:schemas-microsoft-com:vml");document.namespaces.add("o","urn:schemas-microsoft-com:office:office");mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css")}
var mxLog={consoleResource:mxClient.language!="none"?"console":"",TRACE:false,DEBUG:true,WARN:true,buffer:"",init:function(){if(mxLog.window==null&&document.body!=null){var b=(mxResources.get(mxLog.consoleResource)||mxLog.consoleResource)+" - mxGraph "+mxClient.VERSION,d=document.createElement("table");d.setAttribute("width","100%");d.setAttribute("height","100%");var e=document.createElement("tbody"),f=document.createElement("tr"),g=document.createElement("td");g.style.verticalAlign="top";mxLog.textarea=
document.createElement("textarea");mxLog.textarea.setAttribute("readOnly","true");mxLog.textarea.style.width="100%";mxLog.textarea.style.height="100%";mxLog.textarea.value=mxLog.buffer;g.appendChild(mxLog.textarea);f.appendChild(g);e.appendChild(f);f=document.createElement("tr");mxLog.td=document.createElement("td");mxLog.td.style.verticalAlign="top";mxLog.td.setAttribute("height","30px");f.appendChild(mxLog.td);e.appendChild(f);d.appendChild(e);mxLog.addButton("Info",function(){mxLog.info()});mxLog.addButton("DOM",
function(){var h=mxUtils.getInnerHtml(document.body);mxLog.debug(h)});mxLog.addButton("Trace",function(){mxLog.TRACE=!mxLog.TRACE;mxLog.TRACE?mxLog.debug("Tracing enabled"):mxLog.debug("Tracing disabled")});mxLog.addButton("Copy",function(){try{mxUtils.copy(mxLog.textarea.value)}catch(h){mxUtils.alert(h)}});mxLog.addButton("Show",function(){try{mxUtils.popup(mxLog.textarea.value)}catch(h){mxUtils.alert(h)}});mxLog.addButton("Clear",function(){mxLog.textarea.value=""});mxLog.window=new mxWindow(b,
d,document.body.clientWidth-320,(document.body.clientHeight||document.documentElement.clientHeight)-210,300,160);mxLog.window.setMaximizable(true);mxLog.window.setScrollable(true);mxLog.window.setResizable(true);mxLog.window.setClosable(true);mxLog.window.destroyOnClose=false;if(mxClient.IS_NS&&document.compatMode!="BackCompat"){b=function(){var h=mxLog.window.getElement();mxLog.textarea.style.height=h.offsetHeight-78+"px"};mxLog.window.addListener(mxEvent.RESIZE_END,b);mxLog.window.addListener(mxEvent.MAXIMIZE,
b);mxLog.window.addListener(mxEvent.NORMALIZE,b);mxLog.window.getElement();mxLog.textarea.style.height="96px"}}},info:function(){mxLog.writeln(mxUtils.toString(navigator))},addButton:function(b,d){var e=document.createElement("button");mxUtils.write(e,b);mxEvent.addListener(e,"click",d);mxLog.td.appendChild(e)},isVisible:function(){if(mxLog.window!=null)return mxLog.window.isVisible();return false},show:function(){mxLog.setVisible(true)},setVisible:function(b){mxLog.window==null&&mxLog.init();mxLog.window!=
null&&mxLog.window.setVisible(b)},enter:function(b){if(mxLog.TRACE){mxLog.writeln("Entering "+b);return(new Date).getTime()}},leave:function(b,d){if(mxLog.TRACE){d=d!=0?" ("+((new Date).getTime()-d)+" ms)":"";mxLog.writeln("Leaving "+b+d)}},debug:function(){mxLog.DEBUG&&mxLog.writeln.apply(this,arguments)},warn:function(){mxLog.WARN&&mxLog.writeln.apply(this,arguments)},write:function(){for(var b="",d=0;d<arguments.length;d++){b+=arguments[d];if(d<arguments.length-1)b+=" "}if(mxLog.textarea!=null){mxLog.textarea.value+=
b;if(navigator.userAgent.indexOf("Presto/2.5")>=0){mxLog.textarea.style.visibility="hidden";mxLog.textarea.style.visibility="visible"}mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight}else mxLog.buffer+=b},writeln:function(){for(var b="",d=0;d<arguments.length;d++){b+=arguments[d];if(d<arguments.length-1)b+=" "}mxLog.write(b+"\n")}},mxObjectIdentity={FIELD_NAME:"mxObjectId",counter:0,get:function(b){if(typeof b=="object"&&b[mxObjectIdentity.FIELD_NAME]==null){var d=mxUtils.getFunctionName(b.constructor);
b[mxObjectIdentity.FIELD_NAME]=d+"#"+mxObjectIdentity.counter++}return b[mxObjectIdentity.FIELD_NAME]},clear:function(b){typeof b=="object"&&delete b[mxObjectIdentity.FIELD_NAME]}};function mxDictionary(){this.clear()}a=mxDictionary.prototype;a.map=null;a.clear=function(){this.map={}};a.get=function(b){return this.map[mxObjectIdentity.get(b)]};a.put=function(b,d){b=mxObjectIdentity.get(b);var e=this.map[b];this.map[b]=d;return e};
a.remove=function(b){b=mxObjectIdentity.get(b);var d=this.map[b];delete this.map[b];return d};a.getKeys=function(){var b=[];for(key in this.map)b.push(key);return b};a.getValues=function(){var b=[];for(key in this.map)b.push(this.map[key]);return b};a.visit=function(b){for(key in this.map)b(key,this.map[key])};
var mxResources={resources:[],add:function(b,d){d=d!=null?d:mxClient.language;if(d!=mxConstants.NONE){try{var e=mxUtils.load(b+".properties");e.isReady()&&mxResources.parse(e.getText())}catch(f){}try{e=mxUtils.load(b+"_"+d+".properties");e.isReady()&&mxResources.parse(e.getText())}catch(g){}}},parse:function(b){if(b!=null){b=b.split("\n");for(var d=0;d<b.length;d++){var e=b[d].indexOf("=");if(e>0){var f=b[d].substring(0,e),g=b[d].length;b[d].charCodeAt(g-1)==13&&g--;e=b[d].substring(e+1,g);mxResources.resources[f]=
unescape(e)}}}},get:function(b,d,e){b=mxResources.resources[b];if(b==null)b=e;if(b!=null&&d!=null){e=[];for(var f=null,g=0;g<b.length;g++){var h=b.charAt(g);if(h=="{")f="";else if(f!=null&&h=="}"){f=parseInt(f)-1;f>=0&&f<d.length&&e.push(d[f]);f=null}else if(f!=null)f+=h;else e.push(h)}b=e.join("")}return b}};function mxPoint(b,d){this.x=b!=null?b:0;this.y=d!=null?d:0}mxPoint.prototype.x=null;mxPoint.prototype.y=null;mxPoint.prototype.equals=function(b){return b.x==this.x&&b.y==this.y};
mxPoint.prototype.clone=function(){return mxUtils.clone(this)};function mxRectangle(b,d,e,f){mxPoint.call(this,b,d);this.width=e!=null?e:0;this.height=f!=null?f:0}mxRectangle.prototype=new mxPoint;a=mxRectangle.prototype;a.constructor=mxRectangle;a.width=null;a.height=null;a.getCenterX=function(){return this.x+this.width/2};a.getCenterY=function(){return this.y+this.height/2};
a.add=function(b){if(b!=null){var d=Math.min(this.x,b.x),e=Math.min(this.y,b.y),f=Math.max(this.x+this.width,b.x+b.width);b=Math.max(this.y+this.height,b.y+b.height);this.x=d;this.y=e;this.width=f-d;this.height=b-e}};a.grow=function(b){this.x-=b;this.y-=b;this.width+=2*b;this.height+=2*b};a.getPoint=function(){return new mxPoint(this.x,this.y)};a.equals=function(b){return b.x==this.x&&b.y==this.y&&b.width==this.width&&b.height==this.height};
var mxEffects={animateChanges:function(b,d,e){var f=0,g=function(){for(var j=false,k=0;k<d.length;k++){var l=d[k];if(l.constructor==mxGeometryChange||l.constructor==mxTerminalChange||l.constructor==mxValueChange||l.constructor==mxChildChange||l.constructor==mxStyleChange){var m=b.getView().getState(l.cell||l.child,false);if(m!=null){j=true;if(l.constructor!=mxGeometryChange||b.model.isEdge(l.cell))mxUtils.setOpacity(m.shape.node,100*f/10);else{var n=b.getView().scale,o=(l.geometry.x-l.previous.x)*
n,p=(l.geometry.y-l.previous.y)*n,q=(l.geometry.width-l.previous.width)*n;n=(l.geometry.height-l.previous.height)*n;if(f==0){m.x-=o;m.y-=p;m.width-=q;m.height-=n}else{m.x+=o/10;m.y+=p/10;m.width+=q/10;m.height+=n/10}b.cellRenderer.redraw(m);mxEffects.cascadeOpacity(b,l.cell,100*f/10)}}}}mxUtils.repaintGraph(b,new mxPoint(1,1));if(f<10&&j){f++;window.setTimeout(g,h)}else e!=null&&e()},h=30;g()},cascadeOpacity:function(b,d,e){for(var f=b.model.getChildCount(d),g=0;g<f;g++){var h=b.model.getChildAt(d,
g),j=b.getView().getState(h);if(j!=null){mxUtils.setOpacity(j.shape.node,e);mxEffects.cascadeOpacity(b,h,e)}}d=b.model.getEdges(d);if(d!=null)for(g=0;g<d.length;g++){f=b.getView().getState(d[g]);f!=null&&mxUtils.setOpacity(f.shape.node,e)}},fadeOut:function(b,d,e,f,g,h){f=f||40;g=g||30;var j=d||100;mxUtils.setOpacity(b,j);if(h||h==null){var k=function(){j=Math.max(j-f,0);mxUtils.setOpacity(b,j);if(j>0)window.setTimeout(k,g);else{b.style.visibility="hidden";e&&b.parentNode&&b.parentNode.removeChild(b)}};
window.setTimeout(k,g)}else{b.style.visibility="hidden";e&&b.parentNode&&b.parentNode.removeChild(b)}}},mxUtils={errorResource:mxClient.language!="none"?"error":"",closeResource:mxClient.language!="none"?"close":"",errorImage:mxClient.imageBasePath+"/error.gif",removeCursors:function(b){if(b.style!=null)b.style.cursor="";b=b.childNodes;if(b!=null)for(var d=b.length,e=0;e<d;e+=1)mxUtils.removeCursors(b[e])},repaintGraph:function(b,d){b=b.container;if(b!=null&&d!=null&&(mxClient.IS_GC||0)&&(b.scrollLeft>
0||b.scrollTop>0)){var e=document.createElement("div");e.style.position="absolute";e.style.left=d.x+"px";e.style.top=d.y+"px";e.style.width="1px";e.style.height="1px";b.appendChild(e);b.removeChild(e)}},getCurrentStyle:function(){return mxClient.IS_IE?function(b){return b!=null?b.currentStyle:null}:function(b){return b!=null?window.getComputedStyle(b,""):null}}(),hasScrollbars:function(b){b=mxUtils.getCurrentStyle(b);return b!=null&&(b.overflow=="scroll"||b.overflow=="auto")},bind:function(b,d){return function(){return d.apply(b,
arguments)}},eval:function(b){var d=null;if(b.indexOf("function")>=0)try{eval("var _mxJavaScriptExpression="+b);d=_mxJavaScriptExpression;_mxJavaScriptExpression=null}catch(e){mxLog.warn(e.message+" while evaluating "+b)}else try{d=eval(b)}catch(f){mxLog.warn(f.message+" while evaluating "+b)}return d},findNode:function(b,d,e){var f=b.getAttribute(d);if(f!=null&&f==e)return b;for(b=b.firstChild;b!=null;){f=mxUtils.findNode(b,d,e);if(f!=null)return f;b=b.nextSibling}return null},selectSingleNode:function(){return mxClient.IS_IE?
function(b,d){return b.selectSingleNode(d)}:function(b,d){return b.evaluate(d,b,null,XPathResult.ANY_TYPE,null).iterateNext()}}(),getFunctionName:function(b){var d=null;if(b!=null)if(b.name!=null)d=b.name;else{b=b.toString();for(d=9;b.charAt(d)==" ";)d++;var e=b.indexOf("(",d);d=b.substring(d,e)}return d},indexOf:function(b,d){if(b!=null&&d!=null)for(var e=0;e<b.length;e++)if(b[e]==d)return e;return-1},remove:function(b,d){var e=null;if(typeof d=="object")for(var f=mxUtils.indexOf(d,b);f>=0;){d.splice(f,
1);e=b;f=mxUtils.indexOf(d,b)}for(var g in d)if(d[g]==b){delete d[g];e=b}return e},isNode:function(b,d,e,f){if(b!=null&&!isNaN(b.nodeType)&&(d==null||b.nodeName.toLowerCase()==d.toLowerCase()))return e==null||b.getAttribute(e)==f;return false},getChildNodes:function(b,d){d=d||mxConstants.NODETYPE_ELEMENT;var e=[];for(b=b.firstChild;b!=null;){b.nodeType==d&&e.push(b);b=b.nextSibling}return e},createXmlDocument:function(){var b=null;if(document.implementation&&document.implementation.createDocument)b=
document.implementation.createDocument("","",null);else if(window.ActiveXObject)b=new ActiveXObject("Microsoft.XMLDOM");return b},parseXml:function(){return mxClient.IS_IE?function(b){var d=mxUtils.createXmlDocument();d.async="false";d.loadXML(b);return d}:function(b){return(new DOMParser).parseFromString(b,"text/xml")}}(),clearSelection:function(){if(document.selection)return function(){document.selection.empty()};else if(window.getSelection)return function(){window.getSelection().removeAllRanges()}}(),
getPrettyXml:function(b,d,e){var f=[];if(b!=null){d=d||"  ";e=e||"";if(b.nodeType==mxConstants.NODETYPE_TEXT)f.push(b.nodeValue);else{f.push(e+"<"+b.nodeName);var g=b.attributes;if(g!=null)for(var h=0;h<g.length;h++){var j=mxUtils.htmlEntities(g[h].nodeValue);f.push(" "+g[h].nodeName+'="'+j+'"')}g=b.firstChild;if(g!=null){for(f.push(">\n");g!=null;){f.push(mxUtils.getPrettyXml(g,d,e+d));g=g.nextSibling}f.push(e+"</"+b.nodeName+">\n")}else f.push("/>\n")}}return f.join("")},removeWhitespace:function(b,
d){for(b=d?b.previousSibling:b.nextSibling;b!=null&&b.nodeType==mxConstants.NODETYPE_TEXT;){var e=d?b.previousSibling:b.nextSibling,f=mxUtils.getTextContent(b);mxUtils.trim(f).length==0&&b.parentNode.removeChild(b);b=e}},htmlEntities:function(b,d){b=b||"";b=b.replace(/&/g,"&amp;");b=b.replace(/"/g,"&quot;");b=b.replace(/\'/g,"&#39;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");if(d==null||d)b=b.replace(/\n/g,"&#xa;");return b},isVml:function(b){return b!=null&&b.tagUrn=="urn:schemas-microsoft-com:vml"},
getXml:function(b,d){var e="";if(b!=null){e=b.xml;e=e==null?mxClient.IS_IE?b.innerHTML:(new XMLSerializer).serializeToString(b):e.replace(/\r\n\t[\t]*/g,"").replace(/>\r\n/g,">").replace(/\r\n/g,"\n")}d=d||"&#xa;";return e=e.replace(/\n/g,d)},getTextContent:function(b){var d="";if(b!=null){if(b.firstChild!=null)b=b.firstChild;d=b.nodeValue||""}return d},getInnerHtml:function(){return mxClient.IS_IE?function(b){if(b!=null)return b.innerHTML;return""}:function(b){if(b!=null)return(new XMLSerializer).serializeToString(b);
return""}}(),getOuterHtml:function(){return mxClient.IS_IE?function(b){if(b!=null){var d=[];d.push("<"+b.nodeName);for(var e=b.attributes,f=0;f<e.length;f++){var g=e[f].nodeValue;if(g!=null&&g.length>0){d.push(" ");d.push(e[f].nodeName);d.push('="');d.push(g);d.push('"')}}if(b.innerHTML.length==0)d.push("/>");else{d.push(">");d.push(b.innerHTML);d.push("</"+b.nodeName+">")}return d.join("")}return""}:function(b){if(b!=null)return(new XMLSerializer).serializeToString(b);return""}}(),write:function(b,
d,e){e=e!=null?e:document;d=e.createTextNode(d);b!=null&&b.appendChild(d);return d},writeln:function(b,d,e){e=e!=null?e:document;d=e.createTextNode(d);if(b!=null){b.appendChild(d);b.appendChild(document.createElement("br"))}return d},br:function(b,d){d=d||1;for(var e,f=0;f<d;f++){e=document.createElement("br");b!=null&&b.appendChild(e)}return e},button:function(b,d){var e=document.createElement("button");mxUtils.write(e,b);mxEvent.addListener(e,"click",function(f){d(f)});return e},para:function(b,
d){var e=document.createElement("p");mxUtils.write(e,d);b!=null&&b.appendChild(e);return e},linkAction:function(b,d,e,f,g){return mxUtils.link(b,d,function(){e.execute(f)},g)},linkInvoke:function(b,d,e,f,g,h){return mxUtils.link(b,d,function(){e[f](g)},h)},link:function(b,d,e,f){var g=document.createElement("span");g.style.color="blue";g.style.textDecoration="underline";g.style.cursor="pointer";if(f!=null)g.style.paddingLeft=f+"px";mxEvent.addListener(g,"click",e);mxUtils.write(g,d);b!=null&&b.appendChild(g);
return g},fit:function(b){var d=parseInt(b.offsetLeft),e=parseInt(b.offsetWidth),f=document.body,g=document.documentElement,h=(f.scrollLeft||g.scrollLeft)+(f.clientWidth||g.clientWidth);if(d+e>h)b.style.left=Math.max(f.scrollLeft||g.scrollLeft,h-e)+"px";d=parseInt(b.offsetTop);e=parseInt(b.offsetHeight);h=(f.scrollTop||g.scrollTop)+Math.max(f.clientHeight||0,g.clientHeight);if(d+e>h)b.style.top=Math.max(f.scrollTop||g.scrollTop,h-e)+"px"},open:function(b){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(d){mxUtils.alert("Permission to read file denied.");
return""}var e=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);e.initWithPath(b);if(!e.exists()){mxUtils.alert("File not found.");return""}b=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);b.init(e,1,4,null);e=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);e.init(b);return e.read(e.available())}else{e=
(new ActiveXObject("Scripting.FileSystemObject")).OpenTextFile(b,1);b=e.readAll();e.close();return b}},save:function(b,d){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){mxUtils.alert("Permission to write file denied.");return}var f=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);f.initWithPath(b);f.exists()||f.create(0,420);b=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
b.init(f,34,4,null);b.write(d,d.length);b.flush();b.close()}else{f=(new ActiveXObject("Scripting.FileSystemObject")).CreateTextFile(b,true);f.Write(d);f.Close()}},saveAs:function(b){var d=document.createElement("iframe");d.setAttribute("src","");d.style.visibility="hidden";document.body.appendChild(d);try{if(mxClient.IS_NS){var e=d.contentDocument;e.open();e.write(b);e.close();try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");d.focus();saveDocument(e)}catch(f){mxUtils.alert("Permission to save document denied.")}}else{e=
d.contentWindow.document;e.write(b);e.execCommand("SaveAs",false,document.location)}}finally{document.body.removeChild(d)}},copy:function(b){if(window.clipboardData)window.clipboardData.setData("Text",b);else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(d){var e=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);
if(e){e.addDataFlavor("text/unicode");var f={};f=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);f.data=b;e.setTransferData("text/unicode",f,b.length*2);d.setData(e,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}}}},load:function(b){b=new mxXmlRequest(b,null,"GET",false);b.send();return b},get:function(b,d,e){return(new mxXmlRequest(b,null,"GET")).send(d,e)},post:function(b,d,e,f){return(new mxXmlRequest(b,d)).send(e,f)},submit:function(b,
d,e){return(new mxXmlRequest(b,d)).simulate(e)},loadInto:function(b,d,e){if(mxClient.IS_IE)d.onreadystatechange=function(){d.readyState==4&&e()};else d.addEventListener("load",e,false);d.load(b)},getValue:function(b,d,e){b=b!=null?b[d]:null;if(b==null)b=e;return b},clone:function(b,d,e){e=e!=null?e:false;var f=null;if(b!=null&&typeof b.constructor=="function"){f=new b.constructor;for(var g in b)if(g!=mxObjectIdentity.FIELD_NAME&&(d==null||mxUtils.indexOf(d,g)<0))f[g]=!e&&typeof b[g]=="object"?mxUtils.clone(b[g]):
b[g]}return f},equalPoints:function(b,d){if(b==null&&d!=null||b!=null&&d==null||b!=null&&d!=null&&b.length!=d.length)return false;else if(b!=null&&d!=null)for(var e=0;e<b.length;e++)if(b[e]==d[e]||b[e]!=null&&!b[e].equals(d[e]))return false;return true},equalEntries:function(b,d){if(b==null&&d!=null||b!=null&&d==null||b!=null&&d!=null&&b.length!=d.length)return false;else if(b!=null&&d!=null)for(var e in b)if(b[e]!=d[e])return false;return true},toString:function(b){var d="";for(var e in b)try{if(b[e]==
null)d+=e+" = [null]\n";else if(typeof b[e]=="function")d+=e+" => [Function]\n";else if(typeof b[e]=="object"){var f=mxUtils.getFunctionName(b[e].constructor);d+=e+" => ["+f+"]\n"}else d+=e+" = "+b[e]+"\n"}catch(g){d+=e+"="+g.message}return d},toRadians:function(b){return Math.PI*b/180},getBoundingBox:function(b,d){var e=null;if(b!=null&&d!=null&&d!=0){d=mxUtils.toRadians(d);e=Math.cos(d);var f=Math.sin(d),g=new mxPoint(b.x+b.width/2,b.y+b.height/2),h=new mxPoint(b.x,b.y);d=new mxPoint(b.x+b.width,
b.y);var j=new mxPoint(d.x,b.y+b.height);b=new mxPoint(b.x,j.y);h=mxUtils.getRotatedPoint(h,e,f,g);d=mxUtils.getRotatedPoint(d,e,f,g);j=mxUtils.getRotatedPoint(j,e,f,g);b=mxUtils.getRotatedPoint(b,e,f,g);e=new mxRectangle(h.x,h.y,0,0);e.add(new mxRectangle(d.x,d.y,0,0));e.add(new mxRectangle(j.x,j.y,0,0));e.add(new mxRectangle(b.x,b.Y,0,0))}return e},getRotatedPoint:function(b,d,e,f){f!=null||new mxPoint;f=b.x-c.x;b=b.y-c.y;return new mxPoint(f*d-b*e+c.x,b*d+f*e+c.y)},findNearestSegment:function(b,
d,e){var f=-1;if(b.absolutePoints.length>0)for(var g=b.absolutePoints[0],h=null,j=1;j<b.absolutePoints.length;j++){var k=b.absolutePoints[j];g=mxUtils.ptSegDistSq(g.x,g.y,k.x,k.y,d,e);if(h==null||g<h){h=g;f=j-1}g=k}return f},contains:function(b,d,e){return b.x<=d&&b.x+b.width>=d&&b.y<=e&&b.y+b.height>=e},intersects:function(b,d){var e=b.width,f=b.height,g=d.width,h=d.height;if(g<=0||h<=0||e<=0||f<=0)return false;var j=b.x;b=b.y;var k=d.x;d=d.y;g+=k;h+=d;e+=j;f+=b;return(g<k||g>j)&&(h<d||h>b)&&(e<
j||e>k)&&(f<b||f>d)},intersectsHotspot:function(b,d,e,f,g,h){f=f!=null?f:1;g=g!=null?g:0;h=h!=null?h:0;if(f>0){var j=b.getCenterX(),k=b.getCenterY(),l=b.width,m=b.height,n=mxUtils.getValue(b.style,mxConstants.STYLE_STARTSIZE);if(n>0)if(mxUtils.getValue(b.style,mxConstants.STYLE_HORIZONTAL,true)){k=b.y+n/2;m=n}else{j=b.x+n/2;l=n}l=Math.max(g,l*f);m=Math.max(g,m*f);if(h>0){l=Math.min(l,h);m=Math.min(m,h)}b=new mxRectangle(j-l/2,k-m/2,l,m);return mxUtils.contains(b,d,e)}return true},getOffset:function(b){for(var d=
0,e=0;b.offsetParent;){d+=b.offsetLeft;e+=b.offsetTop;b=b.offsetParent}return new mxPoint(d,e)},getScrollOrigin:function(b){for(var d=document.body,e=document.documentElement,f=new mxPoint(d.scrollLeft||e.scrollLeft,d.scrollTop||e.scrollTop);b!=null&&b!=d&&b!=e;){f.x+=b.scrollLeft;f.y+=b.scrollTop;b=b.parentNode}return f},convertPoint:function(b,d,e){var f=mxUtils.getScrollOrigin(b);b=mxUtils.getOffset(b);b.x-=f.x;b.y-=f.y;return new mxPoint(d-b.x,e-b.y)},ltrim:function(b,d){d=d||"\\s";return b.replace(new RegExp("^["+
d+"]+","g"),"")},rtrim:function(b,d){d=d||"\\s";return b.replace(new RegExp("["+d+"]+$","g"),"")},trim:function(b,d){return mxUtils.ltrim(mxUtils.rtrim(b,d),d)},isNumeric:function(b){return b!=null&&(b.length==null||b.length>0&&b.indexOf("0x")<0&&b.indexOf("0X")<0)&&!isNaN(b)},mod:function(b,d){return(b%d+d)%d},intersection:function(b,d,e,f,g,h,j,k){var l=(k-h)*(e-b)-(j-g)*(f-d);j=((j-g)*(d-h)-(k-h)*(b-g))/l;g=((e-b)*(d-h)-(f-d)*(b-g))/l;if(j>=0&&j<=1&&g>=0&&g<=1)return new mxPoint(b+j*(e-b),d+j*
(f-d));return null},ptSegDistSq:function(b,d,e,f,g,h){e-=b;f-=d;g-=b;h-=d;b=g*e+h*f;if(b<=0)e=0;else{g=e-g;h=f-h;b=g*e+h*f;e=b<=0?0:b*b/(e*e+f*f)}g=g*g+h*h-e;if(g<0)g=0;return g},relativeCcw:function(b,d,e,f,g,h){e-=b;f-=d;g-=b;h-=d;b=g*f-h*e;if(b==0){b=g*e+h*f;if(b>0){g-=e;h-=f;b=g*e+h*f;if(b<0)b=0}}return b<0?-1:b>0?1:0},animateChanges:function(){mxEffects.animateChanges.apply(this,arguments)},cascadeOpacity:function(){mxEffects.cascadeOpacity.apply(this,arguments)},fadeOut:function(){mxEffects.fadeOut.apply(this,
arguments)},setOpacity:function(b,d){if(mxUtils.isVml(b))b.style.filter=d>=100?null:"alpha(opacity="+d/5+")";else if(mxClient.IS_IE)b.style.filter=d>=100?null:"alpha(opacity="+d+")";else b.style.opacity=d/100},createImage:function(b){var d=b.toUpperCase(),e=null;if(d.substring(d.length-3,d.length).toUpperCase()=="PNG"&&mxClient.IS_IE6){e=document.createElement("DIV");e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+b+"', sizingMethod='scale')"}else{e=document.createElement("img");
e.setAttribute("src",b);e.setAttribute("border","0")}return e},sortCells:function(b,d){d=d!=null?d:true;b.sort(function(e,f){e=mxCellPath.create(e).split(mxCellPath.PATH_SEPARATOR);f=mxCellPath.create(f).split(mxCellPath.PATH_SEPARATOR);f=mxCellPath.compare(e,f);return f==0?0:f>0==d?1:-1});return b},getStylename:function(b){if(b!=null){b=b.split(";")[0];if(b.indexOf("=")<0)return b}return""},getStylenames:function(b){var d=[];if(b!=null){b=b.split(";");for(var e=0;e<b.length;e++)b[e].indexOf("=")<
0&&d.push(b[e])}return d},indexOfStylename:function(b,d){if(b!=null&&d!=null){b=b.split(";");for(var e=0,f=0;f<b.length;f++){if(b[f]==d)return e;e+=b[f].length+1}}return-1},addStylename:function(b,d){if(mxUtils.indexOfStylename(b,d)<0){if(b==null)b="";else if(b.length>0&&b.charAt(b.length-1)!=";")b+=";";b+=d}return b},removeStylename:function(b,d){var e=[];if(b!=null){b=b.split(";");for(var f=0;f<b.length;f++)b[f]!=d&&e.push(b[f])}return e.join(";")},removeAllStylenames:function(b){var d=[];if(b!=
null){b=b.split(";");for(var e=0;e<b.length;e++)b[e].indexOf("=")>=0&&d.push(b[e])}return d.join(";")},setCellStyles:function(b,d,e,f){if(d!=null&&d.length>0){b.beginUpdate();try{for(var g=0;g<d.length;g++)if(d[g]!=null){var h=mxUtils.setStyle(b.getStyle(d[g]),e,f);b.setStyle(d[g],h)}}finally{b.endUpdate()}}},setStyle:function(b,d,e){var f=e!=null&&(typeof e.length=="undefined"||e.length>0);if(b==null||b.length==0){if(f)b=d+"="+e}else{var g=b.indexOf(d+"=");if(g<0){if(f){f=b.charAt(b.length-1)==";"?
"":";";b=b+f+d+"="+e}}else{d=f?d+"="+e:"";e=b.indexOf(";",g);f||e++;b=b.substring(0,g)+d+(e>g?b.substring(e):"")}}return b},setCellStyleFlags:function(b,d,e,f,g){if(d!=null&&d.length>0){b.beginUpdate();try{for(var h=0;h<d.length;h++)if(d[h]!=null){var j=mxUtils.setStyleFlag(b.getStyle(d[h]),e,f,g);b.setStyle(d[h],j)}}finally{b.endUpdate()}}},setStyleFlag:function(b,d,e,f){if(b==null||b.length==0)b=f||f==null?d+"="+e:d+"=0";else{var g=b.indexOf(d+"=");if(g<0){g=b.charAt(b.length-1)==";"?"":";";b=f||
f==null?b+g+d+"="+e:b+g+d+"=0"}else{var h=b.indexOf(";",g),j="";j=h<0?b.substring(g+d.length+1):b.substring(g+d.length+1,h);j=f==null?parseInt(j)^e:f?parseInt(j)|e:parseInt(j)&~e;b=b.substring(0,g)+d+"="+j+(h>=0?b.substring(h):"")}}return b},getSizeForString:function(b,d,e){var f=document.createElement("div");f.style.fontSize=d||mxConstants.DEFAULT_FONTSIZE;f.style.fontFamily=e||mxConstants.DEFAULT_FONTFAMILY;f.style.position="absolute";f.style.display="inline";f.style.visibility="hidden";f.innerHTML=
b;document.body.appendChild(f);b=new mxRectangle(0,0,f.offsetWidth,f.offsetHeight);document.body.removeChild(f);return b},getViewXml:function(b,d,e,f,g){f=f!=null?f:0;g=g!=null?g:0;d=d!=null?d:1;if(e==null)e=[b.getModel().getRoot()];var h=b.getView(),j=null,k=h.isEventsEnabled();h.setEventsEnabled(false);var l=h.drawPane;h.drawPane=b.dialect==mxConstants.DIALECT_SVG?document.createElementNS(mxConstants.NS_SVG,"g"):h.drawPane.cloneNode(false);h.canvas.appendChild(h.drawPane);var m=h.getTranslate();
h.translate=new mxPoint(f,g);d=new mxTemporaryCellStates(b.getView(),d,e);try{j=(new mxCodec).encode(b.getView())}finally{d.destroy();h.translate=m;h.canvas.removeChild(h.drawPane);h.drawPane=l;h.setEventsEnabled(k)}return j},getScaleForPageCount:function(b,d,e,f){if(b<1)return 1;e=e!=null?e:mxConstants.PAGE_FORMAT_A4_PORTRAIT;f=f!=null?f:0;var g=e.width-f*2;e=e.height-f*2;f=d.getGraphBounds().clone();d=d.getView().getScale();f.width/=d;f.height/=d;d=f.width;var h=1;e=d/f.height/(g/e);f=Math.sqrt(b);
h=Math.sqrt(e);e=f*h;f=f/h;if(e<1&&f>b){var j=f/b;f=b;e/=j}if(f<1&&e>b){j=e/b;e=b;f/=j}j=Math.ceil(e)*Math.ceil(f);for(h=0;j>b;){j=Math.floor(e)/e;var k=Math.floor(f)/f;if(j==1)j=Math.floor(e-1)/e;if(k==1)k=Math.floor(f-1)/f;j=j>k?j:k;e*=j;f*=j;j=Math.ceil(e)*Math.ceil(f);h++;if(h>10)break}h=g*e/d;return h*0.99999},show:function(b,d,e,f){e=e!=null?e:0;f=f!=null?f:0;if(d==null)d=window.open().document;else d.open();var g=b.getGraphBounds();e=-g.x+e;f=-g.y+f;if(mxClient.IS_IE){g="<html>";g+="<head>";
for(var h=document.getElementsByTagName("base"),j=0;j<h.length;j++)g+=h[j].outerHTML;g+="<style>";for(j=0;j<document.styleSheets.length;j++)try{g+=document.styleSheets(j).cssText}catch(k){}g+="</style>";g+="</head>";g+="<body>";g+=b.container.innerHTML;g+="</body>";g+="<html>";d.writeln(g);d.close();b=d.body.getElementsByTagName("DIV")[0];if(b!=null){b.style.position="absolute";b.style.left=e+"px";b.style.top=f+"px"}}else{d.writeln("<html");d.writeln("<head>");h=document.getElementsByTagName("base");
for(j=0;j<h.length;j++)d.writeln(mxUtils.getOuterHtml(h[j]));h=document.getElementsByTagName("link");for(j=0;j<h.length;j++)d.writeln(mxUtils.getOuterHtml(h[j]));h=document.getElementsByTagName("style");for(j=0;j<h.length;j++)d.writeln(mxUtils.getOuterHtml(h[j]));d.writeln("</head>");d.writeln("</html>");d.close();d.documentElement.appendChild(d.createElement("body"));for(b=b.container.firstChild;b!=null;){j=b.cloneNode(true);d.body.appendChild(j);b=b.nextSibling}b=d.getElementsByTagName("g")[0];
if(b!=null){b.setAttribute("transform","translate("+e+","+f+")");e=b.ownerSVGElement;e.setAttribute("width",g.width+Math.max(g.x,0)+3);e.setAttribute("height",g.height+Math.max(g.y,0)+3)}}mxUtils.removeCursors(d.body);return d},printScreen:function(b){var d=window.open();mxUtils.show(b,d.document);b=function(){d.focus();d.print();d.close()};mxClient.IS_GC?d.setTimeout(b,500):b()},popup:function(b,d){if(d){var e=document.createElement("div");e.style.overflow="scroll";e.style.width="636px";e.style.height=
"460px";d=document.createElement("pre");d.innerHTML=mxUtils.htmlEntities(b,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");e.appendChild(d);e=new mxWindow("Popup Window",e,document.body.clientWidth/2-320,(document.body.clientHeight||document.documentElement.clientHeight)/2-240,640,480,false,true);e.setClosable(true);e.setVisible(true)}else if(mxClient.IS_NS){e=window.open();e.document.writeln("<pre>"+mxUtils.htmlEntities(b)+"</pre");e.document.close()}else{e=window.open();d=e.document.createElement("pre");
d.innerHTML=mxUtils.htmlEntities(b,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");e.document.body.appendChild(d)}},alert:function(b){alert(b)},prompt:function(b,d){return prompt(b,d)},confirm:function(b){return confirm(b)},error:function(b,d,e,f){var g=document.createElement("div");g.style.padding="20px";var h=document.createElement("img");h.setAttribute("src",f||mxUtils.errorImage);h.setAttribute("valign","bottom");h.style.verticalAlign="middle";g.appendChild(h);g.appendChild(document.createTextNode("\u00a0"));
g.appendChild(document.createTextNode("\u00a0"));g.appendChild(document.createTextNode("\u00a0"));mxUtils.write(g,b);b=document.body.clientWidth;f=document.body.clientHeight||document.documentElement.clientHeight;var j=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,g,(b-d)/2,f/4,d,null,false,true);if(e){mxUtils.br(g);d=document.createElement("p");e=document.createElement("button");if(mxClient.IS_IE)e.style.cssText="float:right";else e.setAttribute("style","float:right");
mxEvent.addListener(e,"click",function(){j.destroy()});mxUtils.write(e,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource);d.appendChild(e);g.appendChild(d);mxUtils.br(g);j.setClosable(true)}j.setVisible(true);return j},makeDraggable:function(b,d,e,f,g,h,j,k,l,m){g=g!=null?g:0;h=h!=null?h:mxConstants.TOOLTIP_VERTICAL_OFFSET;l=l!=null?l:true;m=m!=null?m:function(p,q){return d.getCellAt(p,q)};var n=mxClient.IS_TOUCH?"touchmove":"mousemove",o=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(b,
mxClient.IS_TOUCH?"touchstart":"mousedown",function(p){if(d.isEnabled()&&!mxEvent.isConsumed(p)){d.isMouseDown=true;var q=f!=null?f.cloneNode(true):b.cloneNode(true);if(k){var r=d.view.scale;q.style.width=parseInt(q.style.width)*r+"px";q.style.height=parseInt(q.style.height)*r+"px";g*=r;h*=r}q.style.zIndex=3;q.style.position="absolute";mxUtils.setOpacity(q,70);var s=null,u=false,v=mxEvent.getClientX(p),w=mxEvent.getClientY(p),t=null,z=function(){};if(l&&d.isDropEnabled()){t=new mxCellHighlight(d,
mxConstants.DROP_TARGET_COLOR);z=function(x){x=d.getView().getState(x);t.highlight(x)}}var C=function(x){var D=mxEvent.getClientX(x),E=mxEvent.getClientY(x),A=mxUtils.getScrollOrigin(),B=mxUtils.convertPoint(d.container,D,E);q.style.left=D+A.x+g+"px";q.style.top=E+A.y+h+"px";if(u){if(d.autoScroll&&(j==null||j))d.scrollPointToVisible(B.x,B.y,d.autoExtend)}else{u=true;document.body.appendChild(q)}s=m(B.x,B.y);z(s);mxEvent.consume(x)},y=function(x){mxEvent.removeListener(document,n,C);mxEvent.removeListener(document,
o,y);q.parentNode!=null&&q.parentNode.removeChild(q);if(t!=null){t.destroy();t=null}try{var D=mxEvent.getClientX(x),E=mxEvent.getClientY(x),A=mxUtils.convertPoint(d.container,D,E),B=2*d.tolerance;if(A.x>=d.container.scrollLeft&&A.y>=d.container.scrollTop&&A.x<=d.container.scrollLeft+d.container.clientWidth&&A.y<=d.container.scrollTop+d.container.clientHeight&&(Math.abs(D-v)>B||Math.abs(E-w)>B)){d.container.focus();e(d,x,s)}}finally{mxEvent.consume(x);d.isMouseDown=false}};mxEvent.addListener(document,
n,C);mxEvent.addListener(document,o,y);mxEvent.consume(p)}})}},mxConstants={DEFAULT_HOTSPOT:0.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,RENDERING_HINT_EXACT:"exact",RENDERING_HINT_FASTER:"faster",RENDERING_HINT_FASTEST:"fastest",DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SHADOWCOLOR:"gray",SVG_SHADOWTRANSFORM:"translate(2 3)",
NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",HIGHLIGHT_STROKEWIDTH:3,CURSOR_MOVABLE_VERTEX:"move",CURSOR_MOVABLE_EDGE:"move",CURSOR_MOVABLE_LABEL:"default",CURSOR_BEND_HANDLE:"pointer",CURSOR_CONNECT:"pointer",
HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",EDGE_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:true,EDGE_SELECTION_DASHED:true,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:mxClient.IS_IE?2:3,HANDLE_SIZE:7,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",
LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",LOCKED_HANDLE_FILLCOLOR:"#FF0000",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:0.15,LINE_ARCSIZE:20,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,826,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,
0,1169,826),NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_SOURCE_PORT:"sourcePort",STYLE_TARGET_PORT:"targetPort",STYLE_OPACITY:"opacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_OVERFLOW:"overflow",STYLE_ORTHOGONAL:"orthogonal",STYLE_EXIT_X:"exitX",STYLE_EXIT_Y:"exitY",STYLE_EXIT_PERIMETER:"exitPerimeter",STYLE_ENTRY_X:"entryX",STYLE_ENTRY_Y:"entryY",STYLE_ENTRY_PERIMETER:"entryPerimeter",STYLE_WHITE_SPACE:"whiteSpace",STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_GRADIENTCOLOR:"gradientColor",
STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_IMAGE_BACKGROUND:"imageBackground",STYLE_IMAGE_BORDER:"imageBorder",
STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_INDICATOR_DIRECTION:"indicatorDirection",
STYLE_SHADOW:"shadow",STYLE_SEGMENT:"segment",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_DASHED:"dashed",STYLE_ROUNDED:"rounded",STYLE_SMOOTH:"smooth",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",
STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_LOOP:"loopStyle",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",
SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_BLOCK:"block",ARROW_OPEN:"open",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",
DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal",EDGESTYLE_ELBOW:"elbowEdgeStyle",EDGESTYLE_ENTITY_RELATION:"entityRelationEdgeStyle",EDGESTYLE_LOOP:"loopEdgeStyle",EDGESTYLE_SIDETOSIDE:"sideToSideEdgeStyle",EDGESTYLE_TOPTOBOTTOM:"topToBottomEdgeStyle",PERIMETER_ELLIPSE:"ellipsePerimeter",PERIMETER_RECTANGLE:"rectanglePerimeter",PERIMETER_RHOMBUS:"rhombusPerimeter",PERIMETER_TRIANGLE:"trianglePerimeter"};
function mxEventObject(b){this.name=b;this.properties=[];for(var d=1;d<arguments.length;d+=2)if(arguments[d+1]!=null)this.properties[arguments[d]]=arguments[d+1]}a=mxEventObject.prototype;a.properties=null;a.properties=null;a.consumed=false;a.getName=function(){return this.name};a.getProperties=function(){return this.properties};a.getProperty=function(b){return this.properties[b]};a.isConsumed=function(){return this.consumed};a.consume=function(){this.consumed=true};
function mxMouseEvent(b,d){this.evt=b;this.state=d}a=mxMouseEvent.prototype;a.consumed=false;a.evt=null;a.state=null;a.getEvent=function(){return this.evt};a.getSource=function(){return mxEvent.getSource(this.evt)};a.isSource=function(b){if(b!=null)for(var d=this.getSource();d!=null;){if(d==b.node)return true;d=d.parentNode}return false};a.getX=function(){return mxEvent.getClientX(this.getEvent())};a.getY=function(){return mxEvent.getClientY(this.getEvent())};a.getState=function(){return this.state};
a.getCell=function(){var b=this.getState();if(b!=null)return b.cell;return null};a.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent())};a.isConsumed=function(){return this.consumed};a.consume=function(b){(b=b!=null?b:true)&&this.evt.preventDefault&&this.evt.preventDefault();this.evt.returnValue=false;this.consumed=true};function mxEventSource(b){this.setEventSource(b)}a=mxEventSource.prototype;a.eventListeners=null;a.eventsEnabled=true;a.eventSource=null;a.isEventsEnabled=function(){return this.eventsEnabled};
a.setEventsEnabled=function(b){this.eventsEnabled=b};a.getEventSource=function(){return this.eventSource};a.setEventSource=function(b){this.eventSource=b};a.addListener=function(b,d){if(this.eventListeners==null)this.eventListeners=[];this.eventListeners.push(b);this.eventListeners.push(d)};a.removeListener=function(b){if(this.eventListeners!=null)for(var d=0;d<this.eventListeners.length;)if(this.eventListeners[d+1]==b)this.eventListeners.splice(d,2);else d+=2};
a.fireEvent=function(b,d){if(this.eventListeners!=null&&this.isEventsEnabled()){if(b==null)b=new mxEventObject;if(d==null)d=this.getEventSource();if(d==null)d=this;d=[d,b];for(var e=0;e<this.eventListeners.length;e+=2){var f=this.eventListeners[e];if(f==null||f==b.getName())this.eventListeners[e+1].apply(this,d)}}};
var mxEvent={addListener:function(){var b=function(d,e,f){if(d.mxListenerList==null)d.mxListenerList=[];d.mxListenerList.push({name:e,f:f})};return mxClient.IS_IE?function(d,e,f){d.attachEvent("on"+e,f);b(d,e,f)}:function(d,e,f){d.addEventListener(e,f,false);b(d,e,f)}}(),redirectMouseEvents:function(b,d,e,f,g,h,j){var k=function(){return typeof e=="function"?e():e},l=mxClient.IS_TOUCH?"touchmove":"mousemove",m=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(b,mxClient.IS_TOUCH?"touchstart":
"mousedown",function(n){if(f!=null)f(n);else mxEvent.isConsumed(n)||d.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n,k()))});mxEvent.addListener(b,l,function(n){if(g!=null)g(n);else mxEvent.isConsumed(n)||d.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n,k()))});mxEvent.addListener(b,m,function(n){if(h!=null)h(n);else mxEvent.isConsumed(n)||d.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n,k()))});mxEvent.addListener(b,"dblclick",function(n){if(j!=null)j(n);else if(!mxEvent.isConsumed(n)){var o=
k();d.dblClick(n,o!=null?o.cell:null)}})},removeListener:function(){var b=function(d,e,f){if(d.mxListenerList!=null){e=d.mxListenerList.length;for(var g=0;g<e;g++)if(d.mxListenerList[g].f==f){d.mxListenerList.splice(g,1);break}if(d.mxListenerList.length==0)d.mxListenerList=null}};return mxClient.IS_IE?function(d,e,f){d.detachEvent("on"+e,f);b(d,e,f)}:function(d,e,f){d.removeEventListener(e,f,false);b(d,e,f)}}(),removeAllListeners:function(b){var d=b.mxListenerList;if(d!=null)for(;d.length>0;){var e=
d[0];mxEvent.removeListener(b,e.name,e.f)}},release:function(b){if(b!=null){mxEvent.removeAllListeners(b);b=b.childNodes;if(b!=null)for(var d=b.length,e=0;e<d;e+=1)mxEvent.release(b[e])}},addMouseWheelListener:function(b){if(b!=null){var d=function(e){if(e==null)e=window.event;var f=0;f=mxClient.IS_NS&&!mxClient.IS_GC?-e.detail/2:e.wheelDelta/120;f!=0&&b(e,f>0)};mxClient.IS_NS?mxEvent.addListener(window,mxClient.IS_GC?"mousewheel":"DOMMouseScroll",d):mxEvent.addListener(document,"mousewheel",d)}},
disableContextMenu:function(){return mxClient.IS_IE?function(b){mxEvent.addListener(b,"contextmenu",function(){return false})}:function(b){b.setAttribute("oncontextmenu","return false;")}}(),getSource:function(b){return b.srcElement!=null?b.srcElement:b.target},isConsumed:function(b){return b.isConsumed!=null&&b.isConsumed},isLeftMouseButton:function(b){return b.button==(mxClient.IS_IE?1:0)},isRightMouseButton:function(b){return b.button==2},isPopupTrigger:function(b){return mxEvent.isRightMouseButton(b)||
mxEvent.isShiftDown(b)&&!mxEvent.isControlDown(b)},isShiftDown:function(b){return b!=null?b.shiftKey:false},isAltDown:function(b){return b!=null?b.altKey:false},isControlDown:function(b){return b!=null?b.ctrlKey:false},isMetaDown:function(b){return b!=null?b.metaKey:false},getMainEvent:function(b){if((b.type=="touchstart"||b.type=="touchmove")&&b.touches!=null&&b.touches[0]!=null)b=b.touches[0];else if(b.type=="touchend"&&b.changedTouches!=null&&b.changedTouches[0]!=null)b=b.changedTouches[0];return b},
getClientX:function(b){return mxEvent.getMainEvent(b).clientX},getClientY:function(b){return mxEvent.getMainEvent(b).clientY},consume:function(b,d){if(d==null||d)if(b.preventDefault){b.stopPropagation();b.preventDefault()}else b.cancelBubble=true;b.isConsumed=true;b.returnValue=false},LABEL_HANDLE:-1,MOUSE_DOWN:"mouseDown",MOUSE_MOVE:"mouseMove",MOUSE_UP:"mouseUp",ACTIVATE:"activate",RESIZE_START:"resizeStart",RESIZE:"resize",RESIZE_END:"resizeEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",
MINIMIZE:"minimize",NORMALIZE:"normalize",MAXIMIZE:"maximize",HIDE:"hide",SHOW:"show",CLOSE:"close",DESTROY:"destroy",REFRESH:"refresh",SIZE:"size",SELECT:"select",FIRED:"fired",GET:"get",RECEIVE:"receive",CONNECT:"connect",DISCONNECT:"disconnect",SUSPEND:"suspend",RESUME:"resume",MARK:"mark",SESSION:"session",ROOT:"root",POST:"post",OPEN:"open",SAVE:"save",BEFORE_ADD_VERTEX:"beforeAddVertex",ADD_VERTEX:"addVertex",AFTER_ADD_VERTEX:"afterAddVertex",DONE:"done",EXECUTE:"execute",BEGIN_UPDATE:"beginUpdate",
END_UPDATE:"endUpdate",BEFORE_UNDO:"beforeUndo",UNDO:"undo",REDO:"redo",CHANGE:"change",NOTIFY:"notify",LAYOUT_CELLS:"layoutCells",CLICK:"click",SCALE:"scale",TRANSLATE:"translate",SCALE_AND_TRANSLATE:"scaleAndTranslate",UP:"up",DOWN:"down",ADD:"add",CLEAR:"clear",ADD_CELLS:"addCells",CELLS_ADDED:"cellsAdded",MOVE_CELLS:"moveCells",CELLS_MOVED:"cellsMoved",RESIZE_CELLS:"resizeCells",CELLS_RESIZED:"cellsResized",TOGGLE_CELLS:"toggleCells",CELLS_TOGGLED:"cellsToggled",ORDER_CELLS:"orderCells",CELLS_ORDERED:"cellsOrdered",
REMOVE_CELLS:"removeCells",CELLS_REMOVED:"cellsRemoved",GROUP_CELLS:"groupCells",UNGROUP_CELLS:"ungroupCells",REMOVE_CELLS_FROM_PARENT:"removeCellsFromParent",FOLD_CELLS:"foldCells",CELLS_FOLDED:"cellsFolded",ALIGN_CELLS:"alignCells",LABEL_CHANGED:"labelChanged",CONNECT_CELL:"connectCell",CELL_CONNECTED:"cellConnected",SPLIT_EDGE:"splitEdge",FLIP_EDGE:"flipEdge",START_EDITING:"startEditing",ADD_OVERLAY:"addOverlay",REMOVE_OVERLAY:"removeOverlay",UPDATE_CELL_SIZE:"updateCellSize",ESCAPE:"escape",CLICK:"click",
DOUBLE_CLICK:"doubleClick"};function mxXmlRequest(b,d,e,f,g,h){this.url=b;this.params=d;this.method=e||"POST";this.async=f!=null?f:true;this.username=g;this.password=h}a=mxXmlRequest.prototype;a.url=null;a.params=null;a.method=null;a.async=null;a.username=null;a.password=null;a.request=null;a.isReady=function(){return this.request.readyState==4};a.getDocumentElement=function(){var b=this.getXml();if(b!=null)return b.documentElement;return null};
a.getXml=function(){var b=this.request.responseXML;if(b==null||b.documentElement==null)b=mxUtils.parseXml(this.request.responseText);return b};a.getText=function(){return this.request.responseText};a.getStatus=function(){return this.request.status};a.create=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};else if(typeof ActiveXObject!="undefined")return function(){return new ActiveXObject("Microsoft.XMLHTTP")}}();
a.send=function(b){this.request=this.create();if(this.request!=null){this.request.onreadystatechange=mxUtils.bind(this,function(){this.isReady()&&b!=null&&b(this)});this.request.open(this.method,this.url,this.async,this.username,this.password);this.setRequestHeaders(this.request,this.params);this.request.send(this.params)}};a.setRequestHeaders=function(b,d){d!=null&&b.setRequestHeader("Content-Type","application/x-www-form-urlencoded")};
a.simulate=function(b,d){b=b||document;var e=null;if(b==document){e=window.onbeforeunload;window.onbeforeunload=null}var f=b.createElement("form");f.setAttribute("method",this.method);f.setAttribute("action",this.url);d!=null&&f.setAttribute("target",d);f.style.display="none";f.style.visibility="hidden";d=this.params.indexOf("&")>0?this.params.split("&"):this.params.split();for(var g=0;g<d.length;g++){var h=d[g].indexOf("=");if(h>0){var j=d[g].substring(0,h),k=d[g].substring(h+1);h=b.createElement("textarea");
h.setAttribute("name",j);k=k.replace(/\n/g,"&#xa;");j=b.createTextNode(k);h.appendChild(j);f.appendChild(h)}}b.body.appendChild(f);f.submit();b.body.removeChild(f);if(e!=null)window.onbeforeunload=e};
var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return mxClipboard.cells==null},cut:function(b,d){d=mxClipboard.copy(b,d);mxClipboard.insertCount=0;mxClipboard.removeCells(b,d);return d},removeCells:function(b,d){b.removeCells(d)},copy:function(b,d){d=d||b.getSelectionCells();d=b.getExportableCells(d);mxClipboard.insertCount=1;mxClipboard.cells=b.cloneCells(d);return d},paste:function(b){if(mxClipboard.cells!=null){var d=b.getImportableCells(mxClipboard.cells),e=mxClipboard.insertCount*
mxClipboard.STEPSIZE,f=b.getDefaultParent();d=b.importCells(d,e,e,f);mxClipboard.insertCount++;b.setSelectionCells(d)}}};
function mxWindow(b,d,e,f,g,h,j,k,l,m){if(d!=null){j=j!=null?j:true;this.content=d;this.init(e,f,g,h,m);this.installMaximizeHandler();this.installMinimizeHandler();this.installCloseHandler();this.setMinimizable(j);mxUtils.write(this.title,b||"");if(k==null||k)this.installMoveHandler();l!=null&&l.parentNode!=null?l.parentNode.replaceChild(this.div,l):document.body.appendChild(this.div)}}mxWindow.prototype=new mxEventSource;a=mxWindow.prototype;a.constructor=mxWindow;
a.closeImage=mxClient.imageBasePath+"/close.gif";a.minimizeImage=mxClient.imageBasePath+"/minimize.gif";a.normalizeImage=mxClient.imageBasePath+"/normalize.gif";a.maximizeImage=mxClient.imageBasePath+"/maximize.gif";a.resizeImage=mxClient.imageBasePath+"/resize.gif";a.visible=false;a.content=false;a.minimumSize=new mxRectangle(0,0,50,40);a.content=false;a.destroyOnClose=true;
a.init=function(b,d,e,f,g){g=g!=null?g:"mxWindow";this.div=document.createElement("div");this.div.className=g;this.div.style.left=b+"px";this.div.style.top=d+"px";if(!mxClient.IS_IE&&mxClient.WINDOW_SHADOWS){this.shadow=document.createElement("div");this.shadow.style.background=mxConstants.SHADOWCOLOR;mxUtils.setOpacity(this.shadow,70);this.shadow.style.position="absolute";this.shadow.style.display="inline"}else if(mxClient.IS_IE&&!mxClient.WINDOW_SHADOWS)this.div.style.filter="";this.table=document.createElement("table");
this.table.className=g;if(e!=null){if(!mxClient.IS_IE)this.div.style.width=e+"px";this.table.style.width=e+"px"}if(f!=null){if(!mxClient.IS_IE)this.div.style.height=f+"px";this.table.style.height=f+"px"}b=document.createElement("tbody");d=document.createElement("tr");this.title=document.createElement("td");this.title.className=g+"Title";d.appendChild(this.title);b.appendChild(d);d=document.createElement("tr");this.td=document.createElement("td");this.td.className=g+"Pane";this.contentWrapper=document.createElement("div");
this.contentWrapper.className=g+"Pane";this.contentWrapper.style.width="100%";this.contentWrapper.appendChild(this.content);if(mxClient.IS_IE||this.content.nodeName.toUpperCase()!="DIV")this.contentWrapper.style.height="100%";this.td.appendChild(this.contentWrapper);d.appendChild(this.td);b.appendChild(d);this.table.appendChild(b);this.div.appendChild(this.table);g=mxUtils.bind(this,function(){this.activate()});b=mxClient.IS_TOUCH?"touchstart":"mousedown";mxEvent.addListener(this.title,b,g);mxEvent.addListener(this.table,
b,g);this.shadow!=null&&mxEvent.addListener(this.div,"DOMNodeInserted",mxUtils.bind(this,function(h){var j=mxEvent.getSource(h),k=mxUtils.bind(this,function(){mxEvent.removeListener(j,"load",k);this.updateShadow()});mxEvent.addListener(j,"load",k);this.updateShadow()}));this.hide()};a.setScrollable=function(b){if(navigator.userAgent.indexOf("Presto/2.5")<0)this.contentWrapper.style.overflow=b?"auto":"hidden"};
a.updateShadow=function(){if(this.shadow!=null){this.shadow.style.visibility=this.div.style.visibility;this.shadow.style.left=parseInt(this.div.style.left)+3+"px";this.shadow.style.top=parseInt(this.div.style.top)+3+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";this.shadow.parentNode!=this.div.parentNode&&this.div.parentNode.appendChild(this.shadow)}};
a.activate=function(){if(mxWindow.activeWindow!=this){var b=mxUtils.getCurrentStyle(this.getElement());b=b!=null?b.zIndex:3;if(mxWindow.activeWindow){var d=mxWindow.activeWindow.getElement();if(d!=null&&d.style!=null)d.style.zIndex=b}d=mxWindow.activeWindow;this.getElement().style.zIndex=b+1;mxWindow.activeWindow=this;this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,"previousWindow",d))}};a.getElement=function(){return this.div};a.fit=function(){mxUtils.fit(this.div)};
a.isResizable=function(){if(this.resize!=null)return this.resize.style.display!="none";return false};
a.setResizable=function(b){if(b)if(this.resize==null){this.resize=document.createElement("img");this.resize.style.position="absolute";this.resize.style.bottom="2px";this.resize.style.right="2px";this.resize.setAttribute("src",mxClient.imageBasePath+"/resize.gif");this.resize.style.cursor="nw-resize";var d=mxClient.IS_TOUCH?"touchmove":"mousemove",e=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(this.resize,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(f){this.activate();
var g=mxEvent.getClientX(f),h=mxEvent.getClientY(f),j=this.div.offsetWidth,k=this.div.offsetHeight,l=mxUtils.bind(this,function(n){var o=mxEvent.getClientX(n)-g,p=mxEvent.getClientY(n)-h;this.setSize(j+o,k+p);this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.RESIZE,"event",n));mxEvent.consume(n)}),m=mxUtils.bind(this,function(n){mxEvent.removeListener(document,d,l);mxEvent.removeListener(document,e,m);this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,"event",n));mxEvent.consume(n)});
mxEvent.addListener(document,d,l);mxEvent.addListener(document,e,m);this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,"event",f));mxEvent.consume(f)}));this.div.appendChild(this.resize)}else this.resize.style.display="inline";else if(this.resize!=null)this.resize.style.display="none"};
a.setSize=function(b,d){b=Math.max(this.minimumSize.width,b);d=Math.max(this.minimumSize.height,d);if(!mxClient.IS_IE){this.div.style.width=b+"px";this.div.style.height=d+"px"}this.table.style.width=b+"px";this.table.style.height=d+"px";if(!mxClient.IS_IE)this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px"};a.setMinimizable=function(b){this.minimize.style.display=b?"":"none"};
a.installMinimizeHandler=function(){this.minimize=document.createElement("img");this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("align","right");this.minimize.setAttribute("title","Minimize");this.minimize.style.cursor="pointer";this.minimize.style.marginRight="1px";this.minimize.style.display="none";this.title.appendChild(this.minimize);var b=false,d=null,e=null,f=mxUtils.bind(this,function(g){this.activate();if(b){b=false;this.minimize.setAttribute("src",this.minimizeImage);
this.minimize.setAttribute("title","Minimize");this.contentWrapper.style.display="";this.maximize.style.display=d;if(!mxClient.IS_IE)this.div.style.height=e;this.table.style.height=e;if(this.resize!=null)this.resize.style.visibility="";this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",g))}else{b=true;this.minimize.setAttribute("src",this.normalizeImage);this.minimize.setAttribute("title","Normalize");this.contentWrapper.style.display="none";d=this.maximize.style.display;
this.maximize.style.display="none";e=this.table.style.height;if(!mxClient.IS_IE)this.div.style.height=this.title.offsetHeight+"px";this.table.style.height=this.title.offsetHeight+"px";if(this.resize!=null)this.resize.style.visibility="hidden";this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,"event",g))}mxEvent.consume(g)});mxEvent.addListener(this.minimize,mxClient.IS_TOUCH?"touchstart":"mousedown",f)};a.setMaximizable=function(b){this.maximize.style.display=b?"":"none"};
a.installMaximizeHandler=function(){this.maximize=document.createElement("img");this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("align","right");this.maximize.setAttribute("title","Maximize");this.maximize.style.cursor="default";this.maximize.style.marginLeft="1px";this.maximize.style.cursor="pointer";this.maximize.style.display="none";this.title.appendChild(this.maximize);var b=false,d=null,e=null,f=null,g=null,h=mxUtils.bind(this,function(j){this.activate();if(this.maximize.style.display!=
"none"){if(b){b=false;this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("title","Maximize");this.contentWrapper.style.display="";this.minimize.style.visibility="";this.div.style.left=d+"px";this.div.style.top=e+"px";if(!mxClient.IS_IE){this.div.style.height=f;this.div.style.width=g;k=mxUtils.getCurrentStyle(this.contentWrapper);if(k.overflow=="auto"||this.resize!=null)this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px"}this.table.style.height=
f;this.table.style.width=g;if(this.resize!=null)this.resize.style.visibility="";this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",j))}else{b=true;this.maximize.setAttribute("src",this.normalizeImage);this.maximize.setAttribute("title","Normalize");this.contentWrapper.style.display="";this.minimize.style.visibility="hidden";d=parseInt(this.div.style.left);e=parseInt(this.div.style.top);f=this.table.style.height;g=this.table.style.width;this.div.style.left="0px";this.div.style.top=
"0px";if(!mxClient.IS_IE){this.div.style.height=document.body.clientHeight-2+"px";this.div.style.width=document.body.clientWidth-2+"px"}this.table.style.width=document.body.clientWidth-2+"px";this.table.style.height=document.body.clientHeight-2+"px";if(this.resize!=null)this.resize.style.visibility="hidden";if(this.shadow!=null)this.shadow.style.visibility="none";if(!mxClient.IS_IE){var k=mxUtils.getCurrentStyle(this.contentWrapper);if(k.overflow=="auto"||this.resize!=null)this.contentWrapper.style.height=
this.div.offsetHeight-this.title.offsetHeight-2+"px"}this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,"event",j))}mxEvent.consume(j)}});mxEvent.addListener(this.maximize,mxClient.IS_TOUCH?"touchstart":"mousedown",h);mxEvent.addListener(this.title,"dblclick",h)};
a.installMoveHandler=function(){this.title.style.cursor="move";var b=mxClient.IS_TOUCH?"touchmove":"mousemove",d=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(this.title,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(e){var f=mxEvent.getClientX(e),g=mxEvent.getClientY(e),h=this.getX(),j=this.getY(),k=mxUtils.bind(this,function(m){var n=mxEvent.getClientX(m)-f,o=mxEvent.getClientY(m)-g;this.setLocation(h+n,j+o);this.fireEvent(new mxEventObject(mxEvent.MOVE,"event",
m));mxEvent.consume(m)}),l=mxUtils.bind(this,function(m){mxEvent.removeListener(document,b,k);mxEvent.removeListener(document,d,l);this.fireEvent(new mxEventObject(mxEvent.MOVE_END,"event",m));mxEvent.consume(m)});mxEvent.addListener(document,b,k);mxEvent.addListener(document,d,l);this.fireEvent(new mxEventObject(mxEvent.MOVE_START,"event",e));mxEvent.consume(e)}))};a.setLocation=function(b,d){this.div.style.left=b+"px";this.div.style.top=d+"px";this.updateShadow()};a.getX=function(){return parseInt(this.div.style.left)};
a.getY=function(){return parseInt(this.div.style.top)};
a.installCloseHandler=function(){this.closeImg=document.createElement("img");this.closeImg.setAttribute("src",this.closeImage);this.closeImg.setAttribute("align","right");this.closeImg.setAttribute("title","Close");this.closeImg.style.marginLeft="2px";this.closeImg.style.cursor="pointer";this.closeImg.style.display="none";this.title.insertBefore(this.closeImg,this.title.firstChild);mxEvent.addListener(this.closeImg,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(b){this.fireEvent(new mxEventObject(mxEvent.CLOSE,
"event",b));this.destroyOnClose?this.destroy():this.setVisible(false);mxEvent.consume(b)}))};a.setImage=function(b){this.image=document.createElement("img");this.image.setAttribute("src",b);this.image.setAttribute("align","left");this.image.style.marginRight="4px";this.image.style.marginLeft="0px";this.image.style.marginTop="-2px";this.title.insertBefore(this.image,this.title.firstChild)};a.setClosable=function(b){this.closeImg.style.display=b?"":"none"};
a.isVisible=function(){if(this.div!=null)return this.div.style.visibility!="hidden";return false};a.setVisible=function(b){if(this.div!=null&&this.isVisible()!=b)b?this.show():this.hide();this.updateShadow()};a.show=function(){this.div.style.visibility="";this.activate();var b=mxUtils.getCurrentStyle(this.contentWrapper);if(!mxClient.IS_IE&&(b.overflow=="auto"||this.resize!=null))this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px";this.fireEvent(new mxEventObject(mxEvent.SHOW))};
a.hide=function(){this.div.style.visibility="hidden";this.fireEvent(new mxEventObject(mxEvent.HIDE))};a.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY));if(this.div!=null){mxEvent.release(this.div);this.div.parentNode.removeChild(this.div);this.div=null}if(this.shadow!=null){this.shadow.parentNode.removeChild(this.shadow);this.shadow=null}this.contentWrapper=this.content=this.title=null};
function mxForm(b){this.table=document.createElement("table");this.table.className=b;this.body=document.createElement("tbody");this.table.appendChild(this.body)}a=mxForm.prototype;a.table=null;a.body=false;a.getTable=function(){return this.table};
a.addButtons=function(b,d){var e=document.createElement("tr"),f=document.createElement("td");e.appendChild(f);f=document.createElement("td");var g=document.createElement("button");mxUtils.write(g,mxResources.get("ok")||"OK");f.appendChild(g);mxEvent.addListener(g,"click",function(){b()});g=document.createElement("button");mxUtils.write(g,mxResources.get("cancel")||"Cancel");f.appendChild(g);mxEvent.addListener(g,"click",function(){d()});e.appendChild(f);this.body.appendChild(e)};
a.addText=function(b,d){var e=document.createElement("input");e.setAttribute("type","text");e.value=d;return this.addField(b,e)};a.addCheckbox=function(b,d){var e=document.createElement("input");e.setAttribute("type","checkbox");this.addField(b,e);if(d)e.checked=true;return e};a.addTextarea=function(b,d,e){var f=document.createElement("textarea");mxClient.IS_NS&&e--;f.setAttribute("rows",e||2);f.value=d;return this.addField(b,f)};
a.addCombo=function(b,d,e){var f=document.createElement("select");e!=null&&f.setAttribute("size",e);d&&f.setAttribute("multiple","true");return this.addField(b,f)};a.addOption=function(b,d,e,f){var g=document.createElement("option");mxUtils.writeln(g,d);g.setAttribute("value",e);f&&g.setAttribute("selected",f);b.appendChild(g)};
a.addField=function(b,d){var e=document.createElement("tr"),f=document.createElement("td");mxUtils.write(f,b);e.appendChild(f);f=document.createElement("td");f.appendChild(d);e.appendChild(f);this.body.appendChild(e);return d};function mxImage(b,d,e){this.src=b;this.width=d;this.height=e}mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;
function mxDivResizer(b,d){if(b.nodeName.toLowerCase()=="div"){if(d==null)d=window;this.div=b;b=mxUtils.getCurrentStyle(b);if(b!=null){this.resizeWidth=b.width=="auto";this.resizeHeight=b.height=="auto"}mxEvent.addListener(d,"resize",mxUtils.bind(this,function(){if(!this.handlingResize){this.handlingResize=true;this.resize();this.handlingResize=false}}));this.resize()}}a=mxDivResizer.prototype;a.resizeWidth=true;a.resizeHeight=true;a.handlingResize=false;
a.resize=function(){var b=this.getDocumentWidth(),d=this.getDocumentHeight(),e=parseInt(this.div.style.left),f=parseInt(this.div.style.right),g=parseInt(this.div.style.top),h=parseInt(this.div.style.bottom);if(this.resizeWidth&&!isNaN(e)&&!isNaN(f)&&e>=0&&f>=0&&b-f-e>0)this.div.style.width=b-f-e+"px";if(this.resizeHeight&&!isNaN(g)&&!isNaN(h)&&g>=0&&h>=0&&d-g-h>0)this.div.style.height=d-g-h+"px"};a.getDocumentWidth=function(){return document.body.clientWidth};a.getDocumentHeight=function(){return document.body.clientHeight};
function mxToolbar(b){this.container=b}mxToolbar.prototype=new mxEventSource;a=mxToolbar.prototype;a.constructor=mxToolbar;a.container=null;a.enabled=true;a.noReset=false;a.updateDefaultMode=true;
a.addItem=function(b,d,e,f,g,h){var j=document.createElement(d!=null?"img":"button"),k=g||(h!=null?"mxToolbarMode":"mxToolbarItem");j.className=k;j.setAttribute("src",d);if(b!=null)d!=null?j.setAttribute("title",b):mxUtils.write(j,b);this.container.appendChild(j);e!=null&&mxEvent.addListener(j,"click",e);mxEvent.addListener(j,"mousedown",mxUtils.bind(this,function(l){if(f!=null)j.setAttribute("src",f);else j.style.backgroundColor="gray";if(h!=null){if(this.menu==null){this.menu=new mxPopupMenu;this.menu.init()}var m=
this.currentImg;this.menu.isMenuShowing()&&this.menu.hideMenu();if(m!=j){this.currentImg=j;this.menu.factoryMethod=h;m=new mxPoint(j.offsetLeft,j.offsetTop+j.offsetHeight);this.menu.popup(m.x,m.y,null,l);if(this.menu.isMenuShowing()){j.className=k+"Selected";this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);j.className=k;this.currentImg=null}}}}}));b=mxUtils.bind(this,function(){if(f!=null)j.setAttribute("src",d);else j.style.backgroundColor=""});mxEvent.addListener(j,"mouseup",
b);mxEvent.addListener(j,"mouseout",b);return j};a.addCombo=function(b){var d=document.createElement("div");d.style.display="inline";d.className="mxToolbarComboContainer";var e=document.createElement("select");e.className=b||"mxToolbarCombo";d.appendChild(e);this.container.appendChild(d);return e};
a.addActionCombo=function(b,d){var e=document.createElement("select");e.className=d||"mxToolbarCombo";this.addOption(e,b,null);mxEvent.addListener(e,"change",function(f){var g=e.options[e.selectedIndex];e.selectedIndex=0;g.funct!=null&&g.funct(f)});this.container.appendChild(e);return e};a.addOption=function(b,d,e){var f=document.createElement("option");mxUtils.writeln(f,d);if(typeof e=="function")f.funct=e;else f.setAttribute("value",e);b.appendChild(f);return f};
a.addSwitchMode=function(b,d,e,f,g){var h=document.createElement("img");h.initialClassName=g||"mxToolbarMode";h.className=h.initialClassName;h.setAttribute("src",d);h.altIcon=f;b!=null&&h.setAttribute("title",b);mxEvent.addListener(h,"click",mxUtils.bind(this,function(){var j=this.selectedMode.altIcon;if(j!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",j)}else this.selectedMode.className=this.selectedMode.initialClassName;if(this.updateDefaultMode)this.defaultMode=
h;this.selectedMode=h;j=h.altIcon;if(j!=null){h.altIcon=h.getAttribute("src");h.setAttribute("src",j)}else h.className=h.initialClassName+"Selected";this.fireEvent(new mxEventObject(mxEvent.SELECT));e()}));this.container.appendChild(h);if(this.defaultMode==null){this.selectedMode=this.defaultMode=h;b=h.altIcon;if(b!=null){h.altIcon=h.getAttribute("src");h.setAttribute("src",b)}else h.className=h.initialClassName+"Selected";e()}return h};
a.addMode=function(b,d,e,f,g){var h=document.createElement(d!=null?"img":"button");h.initialClassName=g||"mxToolbarMode";h.className=h.initialClassName;h.setAttribute("src",d);h.altIcon=f;b!=null&&h.setAttribute("title",b);if(this.enabled){mxEvent.addListener(h,"click",mxUtils.bind(this,function(){this.selectMode(h,e);this.noReset=false}));mxEvent.addListener(h,"dblclick",mxUtils.bind(this,function(){this.selectMode(h,e);this.noReset=true}));if(this.defaultMode==null){this.selectedMode=this.defaultMode=
h;b=h.altIcon;if(b!=null){h.altIcon=h.getAttribute("src");h.setAttribute("src",b)}else h.className=h.initialClassName+"Selected"}}this.container.appendChild(h);return h};
a.selectMode=function(b,d){if(this.selectedMode!=b){var e=this.selectedMode.altIcon;if(e!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",e)}else this.selectedMode.className=this.selectedMode.initialClassName;this.selectedMode=b;e=this.selectedMode.altIcon;if(e!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",e)}else this.selectedMode.className=this.selectedMode.initialClassName+"Selected";
this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",d))}};a.resetMode=function(b){if((b||!this.noReset)&&this.selectedMode!=this.defaultMode)this.selectMode(this.defaultMode,null)};a.addSeparator=function(b){return this.addItem(null,b,null)};a.addBreak=function(){mxUtils.br(this.container)};a.addLine=function(){var b=document.createElement("hr");b.style.marginRight="6px";b.setAttribute("size","1");this.container.appendChild(b)};
a.destroy=function(){mxEvent.release(this.container);this.selectedMode=this.defaultMode=this.container=null;this.menu!=null&&this.menu.destroy()};
function mxSession(b,d,e,f){this.model=b;this.urlInit=d;this.urlPoll=e;this.urlNotify=f;if(b!=null){this.codec=new mxCodec;this.codec.lookup=function(g){return b.getCell(g)}}b.addListener(mxEvent.NOTIFY,mxUtils.bind(this,function(g,h){g=h.getProperty("changes");if(g!=null&&this.debug||this.connected&&!this.suspended)this.notify(this.encodeChanges(g))}))}mxSession.prototype=new mxEventSource;a=mxSession.prototype;a.constructor=mxSession;a.model=null;a.urlInit=null;a.urlPoll=null;a.urlNotify=null;
a.codec=null;a.linefeed="&#xa;";a.escapePostData=true;a.significantRemoteChanges=true;a.sent=0;a.received=0;a.debug=false;a.connected=false;a.suspended=false;a.polling=false;a.start=function(){if(this.debug){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT))}else this.connected||this.get(this.urlInit,mxUtils.bind(this,function(){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));this.poll()}))};
a.suspend=function(){if(this.connected&&!this.suspended){this.suspended=true;this.fireEvent(new mxEventObject(mxEvent.SUSPEND))}};a.resume=function(){if(this.connected&&this.suspended){this.suspended=false;this.fireEvent(new mxEventObject(mxEvent.RESUME));this.polling||this.poll()}};a.stop=function(b){if(this.connected)this.connected=false;this.fireEvent(new mxEventObject(mxEvent.DISCONNECT,"reason",b))};
a.poll=function(){if(this.connected&&!this.suspended&&this.urlPoll!=null){this.polling=true;this.get(this.urlPoll,mxUtils.bind(this,function(){this.poll()}))}else this.polling=false};
a.notify=function(b,d,e){if(b!=null&&b.length>0){if(this.urlNotify!=null)if(this.debug){mxLog.show();mxLog.debug("mxSession.notify: "+this.urlNotify+" xml="+b)}else{if(this.escapePostData)b=encodeURIComponent(b);mxUtils.post(this.urlNotify,"xml="+b,d,e)}this.sent+=b.length;this.fireEvent(new mxEventObject(mxEvent.NOTIFY,"url",this.urlNotify,"xml",b))}};
a.get=function(b,d,e){if(typeof mxUtils!="undefined"){var f=mxUtils.bind(this,function(g){e!=null?e(g):this.stop(g)});mxUtils.get(b,mxUtils.bind(this,function(g){if(typeof mxUtils!="undefined")try{if(g.isReady()&&g.getStatus()!=404){this.received+=g.getText().length;this.fireEvent(new mxEventObject(mxEvent.GET,"url",b,"request",g));if(this.isValidResponse(g)){if(g.getText().length>0){var h=g.getDocumentElement();h==null?f("Invalid response: "+g.getText()):this.receive(h)}d!=null&&d(g)}}else f("Response not ready")}catch(j){f(j);
throw j;}}),function(){f("Transmission error")})}};a.isValidResponse=function(b){return b.getText().indexOf("<?php")<0};a.encodeChanges=function(b){for(var d="",e=0;e<b.length;e++){var f=this.codec.encode(b[e]);d+=mxUtils.getXml(f,this.linefeed)}return d};
a.receive=function(b){if(b!=null&&b.nodeType==mxConstants.NODETYPE_ELEMENT){var d=b.nodeName.toLowerCase();if(d=="state"){for(d=b.firstChild;d!=null;){this.receive(d);d=d.nextSibling}this.model.prefix=b.getAttribute("namespace")+"-"}else if(d=="delta"){d=this.decodeChanges(b);if(d.length>0){var e=this.createUndoableEdit(d);this.model.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",e));this.model.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",d));this.fireEvent(new mxEventObject(mxEvent.FIRED,
"changes",d))}}this.fireEvent(new mxEventObject(mxEvent.RECEIVE,"node",b))}};a.createUndoableEdit=function(b){var d=new mxUndoableEdit(this.model,this.significantRemoteChanges);d.changes=b;d.notify=function(){d.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",d.changes));d.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"changes",d.changes))};return d};
a.decodeChanges=function(b){this.codec.document=b.ownerDocument;var d=[];for(b=b.firstChild;b!=null;){if(b.nodeType==mxConstants.NODETYPE_ELEMENT){var e=null;e=b.nodeName=="mxRootChange"?(new mxCodec(b.ownerDocument)).decode(b):this.codec.decode(b);if(e!=null){e.model=this.model;e.execute();d.push(e)}}b=b.nextSibling}return d};function mxUndoableEdit(b,d){this.source=b;this.changes=[];this.significant=d!=null?d:true}a=mxUndoableEdit.prototype;a.source=null;a.changes=null;a.significant=null;
a.undone=false;a.redone=false;a.isEmpty=function(){return this.changes.length==0};a.isSignificant=function(){return this.significant};a.add=function(b){this.changes.push(b)};a.notify=function(){};a.die=function(){};a.undo=function(){if(!this.undone){for(var b=this.changes.length-1;b>=0;b--){var d=this.changes[b];if(d.execute!=null)d.execute();else d.undo!=null&&d.undo()}this.undone=true;this.redone=false}this.notify()};
a.redo=function(){if(!this.redone){for(var b=this.changes.length,d=0;d<b;d++){var e=this.changes[d];if(e.execute!=null)e.execute();else e.redo!=null&&e.redo()}this.undone=false;this.redone=true}this.notify()};function mxUndoManager(b){this.size=b||100;this.clear()}mxUndoManager.prototype=new mxEventSource;a=mxUndoManager.prototype;a.constructor=mxUndoManager;a.size=null;a.history=null;a.indexOfNextAdd=0;a.isEmpty=function(){return this.history.length==0};
a.clear=function(){this.history=[];this.indexOfNextAdd=0;this.fireEvent(new mxEventObject(mxEvent.CLEAR))};a.canUndo=function(){return this.indexOfNextAdd>0};a.undo=function(){for(;this.indexOfNextAdd>0;){var b=this.history[--this.indexOfNextAdd];b.undo();if(b.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",b));break}}};a.canRedo=function(){return this.indexOfNextAdd<this.history.length};
a.redo=function(){for(var b=this.history.length;this.indexOfNextAdd<b;){var d=this.history[this.indexOfNextAdd++];d.redo();if(d.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,"edit",d));break}}};a.undoableEditHappened=function(b){this.trim();this.size>0&&this.size==this.history.length&&this.history.shift();this.history.push(b);this.indexOfNextAdd=this.history.length;this.fireEvent(new mxEventObject(mxEvent.ADD,"edit",b))};
a.trim=function(){if(this.history.length>this.indexOfNextAdd)for(var b=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd),d=0;d<b.length;d++)b[d].die()};function mxPath(b){this.format=b;this.path=[];this.translate=new mxPoint(0,0)}a=mxPath.prototype;a.format=null;a.translate=null;a.path=null;a.isVml=function(){return this.format=="vml"};a.getPath=function(){return this.path.join("")};a.setTranslate=function(b,d){this.translate=new mxPoint(b,d)};
a.moveTo=function(b,d){this.isVml()?this.path.push("m ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," "):this.path.push("M ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," ")};a.lineTo=function(b,d){this.isVml()?this.path.push("l ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," "):this.path.push("L ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," ")};
a.quadTo=function(b,d,e,f){this.isVml()?this.path.push("qb ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," ",Math.floor(this.translate.x+e)," ",Math.floor(this.translate.y+f)," l ",Math.floor(this.translate.x+e)," ",Math.floor(this.translate.y+f)," "):this.path.push("Q ",this.translate.x+b," ",this.translate.y+d," ",this.translate.x+e," ",this.translate.y+f," ")};
a.curveTo=function(b,d,e,f,g,h){this.isVml()?this.path.push("c ",Math.floor(this.translate.x+b)," ",Math.floor(this.translate.y+d)," ",Math.floor(this.translate.x+e)," ",Math.floor(this.translate.y+f)," ",Math.floor(this.translate.x+g)," ",Math.floor(this.translate.y+h)," "):this.path.push("C ",this.translate.x+b," ",this.translate.y+d," ",this.translate.x+e," ",this.translate.y+f," ",this.translate.x+g," ",this.translate.y+h," ")};a.write=function(b){this.path.push(b," ")};
a.end=function(){this.format=="vml"&&this.path.push("e")};a.close=function(){this.format=="vml"?this.path.push("x e"):this.path.push("Z")};function mxPopupMenu(b){this.factoryMethod=b}a=mxPopupMenu.prototype;a.submenuImage=mxClient.imageBasePath+"/submenu.gif";a.zIndex=10006;a.factoryMethod=true;a.useLeftButtonForPopup=false;a.enabled=true;a.itemCount=0;
a.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);if(!mxClient.IS_IE&&mxClient.MENU_SHADOWS){this.shadow=document.createElement("div");this.shadow.className="mxPopupMenuShadow";this.shadow.style.zIndex=this.zIndex-
1;mxUtils.setOpacity(this.shadow,70)}else if(mxClient.IS_IE&&!mxClient.MENU_SHADOWS)this.div.style.filter="";mxEvent.disableContextMenu(this.div)};a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isPopupTrigger=function(b){return b.isPopupTrigger()||this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(b.getEvent())};
a.addItem=function(b,d,e,f){f=f||this;this.itemCount++;var g=document.createElement("tr");g.className="mxPopupMenuItem";var h=document.createElement("td");h.className="mxPopupMenuIcon";if(d!=null){var j=document.createElement("img");if(!mxClient.IS_IE){if(this.loading==null)this.loading=0;this.loading++;var k=mxUtils.bind(this,function(){mxEvent.removeListener(j,"load",k);this.loading--;this.loading==0&&this.showShadow()});mxEvent.addListener(j,"load",k)}j.src=d;h.appendChild(j)}g.appendChild(h);
d=document.createElement("td");d.className="mxPopupMenuItem";mxUtils.write(d,b);d.align="left";g.appendChild(d);b=document.createElement("td");b.style.width="10px";b.style.paddingRight="6px";g.appendChild(b);f.div==null&&this.createSubmenu(f);f.tbody.appendChild(g);b=mxClient.IS_TOUCH?"touchmove":"mousemove";d=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(g,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(l){this.eventReceiver=g;if(f.activeRow!=g&&f.activeRow!=f){f.activeRow!=
null&&f.activeRow.div.parentNode!=null&&this.hideSubmenu(f);if(g.div!=null){this.showSubmenu(f,g);f.activeRow=g}}mxEvent.consume(l)}));mxEvent.addListener(g,b,mxUtils.bind(this,function(){f.activeRow!=g&&f.activeRow!=f&&f.activeRow!=null&&f.activeRow.div.parentNode!=null&&this.hideSubmenu(f);if(mxClient.IS_IE){g.style.backgroundColor="#000066";g.style.color="white"}}));mxEvent.addListener(g,d,mxUtils.bind(this,function(l){if(this.eventReceiver==g){f.activeRow!=g&&this.hideMenu();e!=null&&e(l)}this.eventReceiver=
null;mxEvent.consume(l)}));mxClient.IS_IE&&mxEvent.addListener(g,"mouseout",mxUtils.bind(this,function(){g.style.backgroundColor="";g.style.color=""}));return g};
a.createSubmenu=function(b){b.table=document.createElement("table");b.table.className="mxPopupMenu";b.tbody=document.createElement("tbody");b.table.appendChild(b.tbody);b.div=document.createElement("div");b.div.className="mxPopupMenu";b.div.style.position="absolute";b.div.style.display="inline";b.div.appendChild(b.table);var d=document.createElement("img");d.setAttribute("src",this.submenuImage);td=b.firstChild.nextSibling.nextSibling;td.appendChild(d)};
a.showSubmenu=function(b,d){if(d.div!=null){d.div.style.left=b.div.offsetLeft+d.offsetLeft+d.offsetWidth-1+"px";d.div.style.top=b.div.offsetTop+d.offsetTop+"px";document.body.appendChild(d.div);var e=parseInt(d.div.offsetLeft),f=parseInt(d.div.offsetWidth),g=document.body,h=document.documentElement;if(e+f>(g.scrollLeft||h.scrollLeft)+(g.clientWidth||h.clientWidth))d.div.style.left=b.div.offsetLeft-f+(mxClient.IS_IE?6:-6)+"px";mxUtils.fit(d.div)}};
a.addSeparator=function(b){b=b||this;var d=document.createElement("tr"),e=document.createElement("td");e.className="mxPopupMenuIcon";e.style.padding="0 0 0 0px";d.appendChild(e);e=document.createElement("td");e.style.padding="0 0 0 0px";e.setAttribute("colSpan","2");var f=document.createElement("hr");f.setAttribute("size","1");e.appendChild(f);d.appendChild(e);b.tbody.appendChild(d)};
a.popup=function(b,d,e,f){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){this.div.style.left=b+"px";for(this.div.style.top=d+"px";this.tbody.firstChild!=null;){mxEvent.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild)}this.itemCount=0;this.factoryMethod(this,e,f);this.itemCount>0&&this.showMenu()}};a.isMenuShowing=function(){return this.div!=null&&this.div.parentNode==document.body};
a.showMenu=function(){document.body.appendChild(this.div);mxUtils.fit(this.div);if(this.shadow!=null)this.loading||this.showShadow()};a.showShadow=function(){if(this.shadow!=null&&this.div.parentNode==document.body){this.shadow.style.left=parseInt(this.div.style.left)+3+"px";this.shadow.style.top=parseInt(this.div.style.top)+3+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";document.body.appendChild(this.shadow)}};
a.hideMenu=function(){if(this.div!=null){this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div);this.shadow!=null&&this.shadow.parentNode!=null&&this.shadow.parentNode.removeChild(this.shadow);this.hideSubmenu(this)}};a.hideSubmenu=function(b){if(b.activeRow!=null){this.hideSubmenu(b.activeRow);b.activeRow.div.parentNode!=null&&b.activeRow.div.parentNode.removeChild(b.activeRow.div);b.activeRow=null}};
a.destroy=function(){if(this.div!=null){mxEvent.release(this.div);this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div);this.div=null}if(this.shadow!=null){mxEvent.release(this.shadow);this.shadow.parentNode!=null&&this.shadow.parentNode.removeChild(this.shadow);this.shadow=null}};function mxAutoSaveManager(b){this.changeHandler=mxUtils.bind(this,function(d,e){this.isEnabled()&&this.graphModelChanged(e.getProperty("changes"))});this.setGraph(b)}mxAutoSaveManager.prototype=new mxEventSource;
a=mxAutoSaveManager.prototype;a.constructor=mxAutoSaveManager;a.graph=null;a.autoSaveDelay=10;a.autoSaveThrottle=2;a.autoSaveThreshold=5;a.ignoredChanges=0;a.lastSnapshot=0;a.enabled=true;a.changeHandler=null;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.setGraph=function(b){this.graph!=null&&this.graph.getModel().removeListener(this.changeHandler);this.graph=b;this.graph!=null&&this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)};a.save=function(){};
a.graphModelChanged=function(){var b=((new Date).getTime()-this.lastSnapshot)/1E3;if(b>this.autoSaveDelay||this.ignoredChanges>=this.autoSaveThreshold&&b>this.autoSaveThrottle){this.save();this.reset()}else this.ignoredChanges++};a.reset=function(){this.lastSnapshot=(new Date).getTime();this.ignoredChanges=0};a.destroy=function(){this.setGraph(null)};function mxAnimation(b){this.delay=b!=null?b:20}mxAnimation.prototype=new mxEventSource;a=mxAnimation.prototype;a.constructor=mxAnimation;a.delay=null;
a.thread=null;a.startAnimation=function(){if(this.thread==null)this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay)};a.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE))};a.stopAnimation=function(){if(this.thread!=null){window.clearInterval(this.thread);this.thread=null;this.fireEvent(new mxEventObject(mxEvent.DONE))}};function mxMorphing(b,d,e,f){mxAnimation.call(this,f);this.graph=b;this.steps=d!=null?d:6;this.ease=e!=null?e:1.5}
mxMorphing.prototype=new mxAnimation;a=mxMorphing.prototype;a.constructor=mxMorphing;a.graph=null;a.steps=null;a.step=0;a.ease=null;a.cells=null;a.updateAnimation=function(){var b=new mxCellStatePreview(this.graph);if(this.cells!=null)for(var d=0;d<this.cells.length;d++)this.animateCell(cells[d],b,false);else this.animateCell(this.graph.getModel().getRoot(),b,true);this.show(b);if(b.isEmpty()||this.step++>=this.steps)this.stopAnimation()};a.show=function(b){b.show()};
a.animateCell=function(b,d,e){var f=this.graph.getView().getState(b),g=null;if(f!=null){g=this.getDelta(f);if(this.graph.getModel().isVertex(b)&&(g.x!=0||g.y!=0)){var h=this.graph.view.getTranslate(),j=this.graph.view.getScale();g.x+=h.x*j;g.y+=h.y*j;d.moveState(f,-g.x/this.ease,-g.y/this.ease)}}if(e&&!this.stopRecursion(f,g)){f=this.graph.getModel().getChildCount(b);for(g=0;g<f;g++)this.animateCell(this.graph.getModel().getChildAt(b,g),d,e)}};
a.stopRecursion=function(b,d){return d!=null&&(d.x!=0||d.y!=0)};a.getDelta=function(b){var d=this.getOriginForCell(b.cell),e=this.graph.getView().getTranslate(),f=this.graph.getView().getScale();b=new mxPoint(b.x/f-e.x,b.y/f-e.y);return new mxPoint((d.x-b.x)*f,(d.y-b.y)*f)};
a.getOriginForCell=function(b){var d=null;if(b!=null){d=this.getOriginForCell(this.graph.getModel().getParent(b));b=this.graph.getCellGeometry(b);if(b!=null){d.x+=b.x;d.y+=b.y}}if(d==null){d=this.graph.view.getTranslate();d=new mxPoint(-d.x,-d.y)}return d};function mxShape(){}a=mxShape.prototype;a.SVG_STROKE_TOLERANCE=8;a.scale=1;a.dialect=null;a.crisp=false;a.mixedModeHtml=true;a.preferModeHtml=true;a.bounds=null;a.points=null;a.node=null;a.label=null;a.innerNode=null;a.style=null;
a.startOffset=null;a.endOffset=null;a.init=function(b){if(this.node==null){this.node=this.create(b);b!=null&&b.appendChild(this.node)}this.redraw();if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null}};
a.insertGradient=function(b){if(b!=null){for(var d=0,e=b.getAttribute("id"),f=document.getElementById(e);f!=null&&f.ownerSVGElement!=this.node.ownerSVGElement;){d++;e=b.getAttribute("id")+"-"+d;f=document.getElementById(e)}if(f==null){b.setAttribute("id",e);this.node.ownerSVGElement.appendChild(b);f=b}if(f!=null){b="url(#"+e+")";d=this.innerNode!=null?this.innerNode:this.node;d!=null&&d.getAttribute("fill")!=b&&d.setAttribute("fill",b)}}};
a.isMixedModeHtml=function(){return this.mixedModeHtml&&!this.isRounded&&!this.isShadow&&this.gradient==null};a.create=function(){var b=null;return b=this.dialect==mxConstants.DIALECT_SVG?this.createSvg():this.dialect==mxConstants.DIALECT_STRICTHTML||this.preferModeHtml&&this.dialect==mxConstants.DIALECT_PREFERHTML||this.isMixedModeHtml()&&this.dialect==mxConstants.DIALECT_MIXEDHTML?this.createHtml():this.createVml()};
a.createHtml=function(){var b=document.createElement("DIV");this.configureHtmlShape(b);return b};a.destroy=function(){if(this.node!=null){mxEvent.release(this.node);this.node.parentNode!=null&&this.node.parentNode.removeChild(this.node);this.node=null}};
a.apply=function(b){this.style=b=b.style;if(b!=null){this.fill=mxUtils.getValue(b,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(b,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(b,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(b,mxConstants.STYLE_OPACITY,this.opacity);this.stroke=mxUtils.getValue(b,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getValue(b,mxConstants.STYLE_STROKEWIDTH,
this.strokewidth);this.isShadow=mxUtils.getValue(b,mxConstants.STYLE_SHADOW,this.isShadow);this.isDashed=mxUtils.getValue(b,mxConstants.STYLE_DASHED,this.isDashed);this.spacing=mxUtils.getValue(b,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getValue(b,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getValue(b,mxConstants.STYLE_ENDSIZE,this.endSize);this.isRounded=mxUtils.getValue(b,mxConstants.STYLE_ROUNDED,this.isRounded);this.startArrow=mxUtils.getValue(b,mxConstants.STYLE_STARTARROW,
this.startArrow);this.endArrow=mxUtils.getValue(b,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(b,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(b,mxConstants.STYLE_DIRECTION,this.direction)}};
a.createSvgGroup=function(b){var d=document.createElementNS(mxConstants.NS_SVG,"g");this.innerNode=document.createElementNS(mxConstants.NS_SVG,b);this.configureSvgShape(this.innerNode);b=="rect"&&this.strokewidth*this.scale>=1&&!this.isRounded&&this.innerNode.setAttribute("shape-rendering","optimizeSpeed");this.shadowNode=this.createSvgShadow(this.innerNode);this.shadowNode!=null&&d.appendChild(this.shadowNode);d.appendChild(this.innerNode);return d};
a.createSvgShadow=function(b){if(this.isShadow&&this.fill!=null){b=b.cloneNode(true);b.setAttribute("stroke",mxConstants.SHADOWCOLOR);b.setAttribute("fill",mxConstants.SHADOWCOLOR);b.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM);return b}return null};
a.configureHtmlShape=function(b){if(mxUtils.isVml(b))this.configureVmlShape(b);else{b.style.position="absolute";b.style.overflow="hidden";var d=this.stroke;if(d!=null&&d!=mxConstants.NONE){b.style.borderColor=d;if(this.isDashed)b.style.borderStyle="dashed";else if(this.strokewidth>0)b.style.borderStyle="solid";b.style.borderWidth=this.strokewidth+"px"}else b.style.borderWidth="0px";d=this.fill;b.style.background="";if(d!=null&&d!=mxConstants.NONE)b.style.backgroundColor=d;else this.points==null&&
this.configureTransparentBackground(b);this.opacity!=null&&mxUtils.setOpacity(b,this.opacity)}};
a.configureVmlShape=function(b){b.style.position="absolute";var d=this.stroke;if(d!=null&&d!=mxConstants.NONE){b.setAttribute("stroked","true");b.setAttribute("strokecolor",d)}else b.setAttribute("stroked","false");d=this.fill;b.style.background="";if(d!=null&&d!=mxConstants.NONE){b.setAttribute("filled","true");b.setAttribute("fillcolor",d);if(b.fillNode==null){b.fillNode=document.createElement("v:fill");b.appendChild(b.fillNode)}b.fillNode.setAttribute("color",d);if(this.gradient!=null){b.fillNode.setAttribute("type",
"gradient");b.fillNode.setAttribute("color2",this.gradient);d="180";if(this.gradientDirection==mxConstants.DIRECTION_EAST)d="270";else if(this.gradientDirection==mxConstants.DIRECTION_WEST)d="90";else if(this.gradientDirection==mxConstants.DIRECTION_NORTH)d="0";b.fillNode.setAttribute("angle",d)}if(this.opacity!=null){b.fillNode.setAttribute("opacity",this.opacity+"%");this.gradient!=null&&b.fillNode.setAttribute("o:opacity2",this.opacity+"%")}}else{b.setAttribute("filled","false");this.points==null&&
this.configureTransparentBackground(b);if(b.fillNode!=null){mxEvent.release(b.fillNode);b.removeChild(b.fillNode);b.fillNode=null}}if((this.isDashed||this.opacity!=null)&&this.strokeNode==null){this.strokeNode=document.createElement("v:stroke");b.appendChild(this.strokeNode)}if(this.strokeNode!=null){this.isDashed?this.strokeNode.setAttribute("dashstyle","2 2"):this.strokeNode.setAttribute("dashstyle","solid");this.opacity!=null&&this.strokeNode.setAttribute("opacity",this.opacity+"%")}if(this.isShadow&&
this.fill!=null)if(this.shadowNode==null){this.shadowNode=document.createElement("v:shadow");this.shadowNode.setAttribute("on","true");this.shadowNode.setAttribute("color",mxConstants.SHADOWCOLOR);b.appendChild(this.shadowNode)}if(b.nodeName=="roundrect")try{b.setAttribute("arcsize",String(mxConstants.RECTANGLE_ROUNDING_FACTOR*100)+"%")}catch(e){}};a.configureTransparentBackground=function(b){b.style.background="url('"+mxClient.imageBasePath+"/transparent.gif')"};
a.configureSvgShape=function(b){var d=this.stroke;d!=null&&d!=mxConstants.NONE?b.setAttribute("stroke",d):b.setAttribute("stroke","none");d=this.fill;if(d!=null&&d!=mxConstants.NONE)if(this.gradient!=null){var e=this.getGradientId(d,this.gradient,this.opacity);if(this.gradientNode!=null&&this.gradientNode.getAttribute("id")!=e){this.gradientNode=null;b.setAttribute("fill","")}if(this.gradientNode==null){this.gradientNode=this.createSvgGradient(e,d,this.gradient,this.opacity,b);b.setAttribute("fill",
"url(#"+e+")")}}else{this.gradientNode=null;b.setAttribute("fill",d)}else b.setAttribute("fill","none");this.isDashed&&b.setAttribute("stroke-dasharray","3, 3");if(this.opacity!=null){b.setAttribute("fill-opacity",this.opacity/100);b.setAttribute("stroke-opacity",this.opacity/100)}};
a.getGradientId=function(b,d,e){b=b.toLowerCase();d=d.toLowerCase();e=e!=null?e:100;var f=null;if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH)f="south";else if(this.gradientDirection==mxConstants.DIRECTION_EAST)f="east";else if(this.gradientDirection==mxConstants.DIRECTION_NORTH)f="north";else if(this.gradientDirection==mxConstants.DIRECTION_WEST)f="west";return"-mx-gradient-"+b+"-"+d+"-"+e+"-"+f};
a.createSvgGradient=function(b,d,e,f){f=f!=null?f:100;var g=this.insertGradientNode;if(g==null){g=document.createElementNS(mxConstants.NS_SVG,"linearGradient");g.setAttribute("id",b);g.setAttribute("x1","0%");g.setAttribute("y1","0%");g.setAttribute("x2","0%");g.setAttribute("y2","0%");if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH)g.setAttribute("y2","100%");else if(this.gradientDirection==mxConstants.DIRECTION_EAST)g.setAttribute("x2","100%");else if(this.gradientDirection==
mxConstants.DIRECTION_NORTH)g.setAttribute("y1","100%");else this.gradientDirection==mxConstants.DIRECTION_WEST&&g.setAttribute("x1","100%");b=document.createElementNS(mxConstants.NS_SVG,"stop");b.setAttribute("offset","0%");b.setAttribute("style","stop-color:"+d+";stop-opacity:"+f/100);g.appendChild(b);b=document.createElementNS(mxConstants.NS_SVG,"stop");b.setAttribute("offset","100%");b.setAttribute("style","stop-color:"+e+";stop-opacity:"+f/100);g.appendChild(b)}return this.insertGradientNode=
g};
a.createPoints=function(b,d,e,f){var g=f?this.bounds.x:0;f=f?this.bounds.y:0;if(isNaN(this.points[0].x)||isNaN(this.points[0].y))return null;var h=mxConstants.LINE_ARCSIZE*this.scale;b=b+" "+Math.floor(this.points[0].x-g)+" "+Math.floor(this.points[0].y-f)+" ";for(var j=1;j<this.points.length;j++){var k=this.points[j],l=this.points[j-1];if(isNaN(k.x)||isNaN(k.y))return null;if(j==1&&this.startOffset!=null){l=l.clone();l.x+=this.startOffset.x;l.y+=this.startOffset.y}else if(j==this.points.length-1&&
this.endOffset!=null){k=k.clone();k.x+=this.endOffset.x;k.y+=this.endOffset.y}var m=l.x-k.x;l=l.y-k.y;if(this.isRounded&&j<this.points.length-1&&(m!=0||l!=0)&&this.scale>0.3){var n=Math.sqrt(m*m+l*l);m=m*Math.min(h,n/2)/n;l=l*Math.min(h,n/2)/n;b+=d+" "+Math.floor(k.x+m-g)+" "+Math.floor(k.y+l-f)+" ";l=this.points[j+1];m=l.x-k.x;l=l.y-k.y;n=Math.max(1,Math.sqrt(m*m+l*l));if(n!=0){m=m*Math.min(h,n/2)/n;l=l*Math.min(h,n/2)/n;b+=e+" "+Math.floor(k.x-g)+" "+Math.floor(k.y-f)+" "+Math.floor(k.x-g)+","+
Math.floor(k.y-f)+" "+Math.floor(k.x+m-g)+" "+Math.floor(k.y+l-f)+" "}}else b+=d+" "+Math.floor(k.x-g)+" "+Math.floor(k.y-f)+" "}return b};
a.updateHtmlShape=function(b){if(b!=null){if(mxUtils.isVml(b))this.updateVmlShape(b);else{b.style.borderWidth=Math.max(1,Math.floor(this.strokewidth*this.scale))+"px";if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){b.style.left=Math.floor(Math.max(0,this.bounds.x))+"px";b.style.top=Math.floor(Math.max(0,this.bounds.y))+"px";b.style.width=Math.floor(Math.max(0,this.bounds.width))+"px";b.style.height=Math.floor(Math.max(0,this.bounds.height))+
"px"}}if(this.points!=null&&this.bounds!=null&&!mxUtils.isVml(b)){if(this.divContainer==null)this.divContainer=b;for(;this.divContainer.firstChild!=null;){mxEvent.release(this.divContainer.firstChild);this.divContainer.removeChild(this.divContainer.firstChild)}b.style.borderStyle="";b.style.background="";if(this.points.length==2){var d=this.points[0],e=this.points[1],f=e.x-d.x,g=e.y-d.y;if(f==0||g==0)b.style.borderStyle="solid";else{b.style.width=Math.floor(this.bounds.width+1)+"px";b.style.height=
Math.floor(this.bounds.height+1)+"px";e=1+Math.sqrt(f*f+g*g)/(8*this.scale);var h=f/e,j=g/e;b=d.x-this.bounds.x;d=d.y-this.bounds.y;for(f=0;f<e;f++){g=document.createElement("DIV");g.style.position="absolute";g.style.overflow="hidden";g.style.left=Math.floor(b)+"px";g.style.top=Math.floor(d)+"px";g.style.width=Math.max(1,2*this.scale)+"px";g.style.height=Math.max(1,2*this.scale)+"px";g.style.backgroundColor=this.stroke;this.divContainer.appendChild(g);b+=h;d+=j}}}else if(this.points.length==3){d=
this.points[1];f="0";g="1";e="0";h="1";if(d.x==this.bounds.x){h="0";e="1"}if(d.y==this.bounds.y){f="1";g="0"}b.style.borderStyle="solid";b.style.borderWidth=f+" "+h+" "+g+" "+e+"px"}else{b.style.width=Math.floor(this.bounds.width+1)+"px";b.style.height=Math.floor(this.bounds.height+1)+"px";j=this.points[0];for(f=1;f<this.points.length;f++){h=this.points[f];g=document.createElement("DIV");g.style.position="absolute";g.style.overflow="hidden";g.style.borderColor=this.stroke;g.style.borderStyle="solid";
g.style.borderWidth="1 0 0 1px";b=Math.min(h.x,j.x)-this.bounds.x;d=Math.min(h.y,j.y)-this.bounds.y;e=Math.max(1,Math.abs(h.x-j.x));j=Math.max(1,Math.abs(h.y-j.y));g.style.left=b+"px";g.style.top=d+"px";g.style.width=e+"px";g.style.height=j+"px";this.divContainer.appendChild(g);j=h}}}}};
a.updateVmlShape=function(b){b.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){b.style.left=Math.floor(this.bounds.x)+"px";b.style.top=Math.floor(this.bounds.y)+"px";b.style.width=Math.floor(Math.max(0,this.bounds.width))+"px";b.style.height=Math.floor(Math.max(0,this.bounds.height))+"px";if(this.points==null)if(this.rotation!=null&&this.rotation!=0)b.style.rotation=
this.rotation;else if(b.style.rotation!=null)b.style.rotation=""}if(this.points!=null)if(b.nodeName=="polyline"&&b.points!=null){for(var d="",e=0;e<this.points.length;e++)d+=this.points[e].x+","+this.points[e].y+" ";b.points.value=d;b.style.left=null;b.style.top=null;b.style.width=null;b.style.height=null}else if(this.bounds!=null){this.node.setAttribute("coordsize",Math.floor(this.bounds.width)+","+Math.floor(this.bounds.height));d=this.createPoints("m","l","c",true);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){var f=
this.points,g=f.length;if(g>3){var h=this.bounds.x,j=this.bounds.y;d="m "+Math.floor(f[0].x-h)+" "+Math.floor(f[0].y-j)+" qb";for(e=1;e<g-1;e++)d+=" "+Math.floor(f[e].x-h)+" "+Math.floor(f[e].y-j);d+=" nf l "+Math.floor(f[g-1].x-h)+" "+Math.floor(f[g-1].y-j)}}b.setAttribute("path",d+" e")}};
a.updateSvgShape=function(b){var d=Math.max(1,this.strokewidth*this.scale);b.setAttribute("stroke-width",d);this.crisp?b.setAttribute("shape-rendering","crispEdges"):b.removeAttribute("shape-rendering");if(this.points!=null&&this.points[0]!=null){d=this.createPoints("M","L","C",false);if(d!=null){b.setAttribute("d",d);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){d=this.points;var e=d.length;if(e>3){var f="M "+d[0].x+" "+d[0].y+" ";f+=" Q "+d[1].x+" "+d[1].y+"  "+d[2].x+" "+d[2].y;for(var g=
3;g<e;g++)f+=" T "+d[g].x+" "+d[g].y;b.setAttribute("d",f)}}b.removeAttribute("x");b.removeAttribute("y");b.removeAttribute("width");b.removeAttribute("height")}}else if(this.bounds!=null){b.setAttribute("x",this.bounds.x);b.setAttribute("y",this.bounds.y);d=this.bounds.width;e=this.bounds.height;b.setAttribute("width",d);b.setAttribute("height",e);if(this.isRounded){d=Math.min(d*mxConstants.RECTANGLE_ROUNDING_FACTOR,e*mxConstants.RECTANGLE_ROUNDING_FACTOR);b.setAttribute("rx",d);b.setAttribute("ry",
d)}this.updateSvgTransform(b,b==this.shadowNode)}};a.updateSvgTransform=function(b,d){if(this.rotation!=null&&this.rotation!=0){var e=this.bounds.x+this.bounds.width/2,f=this.bounds.y+this.bounds.height/2;d?b.setAttribute("transform","rotate("+this.rotation+","+e+","+f+") "+mxConstants.SVG_SHADOWTRANSFORM):b.setAttribute("transform","rotate("+this.rotation+","+e+","+f+")")}else d?b.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM):b.removeAttribute("transform")};
a.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){this.innerNode!=null?this.configureSvgShape(this.innerNode):this.configureSvgShape(this.node);if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null}}else mxUtils.isVml(this.node)?this.configureVmlShape(this.node):this.configureHtmlShape(this.node)};a.redraw=function(){if(this.dialect==mxConstants.DIALECT_SVG)this.redrawSvg();else mxUtils.isVml(this.node)?this.redrawVml():this.redrawHtml()};
a.redrawSvg=function(){if(this.innerNode!=null){this.updateSvgShape(this.innerNode);this.shadowNode!=null&&this.updateSvgShape(this.shadowNode)}else this.updateSvgShape(this.node)};a.redrawVml=function(){this.updateVmlShape(this.node)};a.redrawHtml=function(){this.updateHtmlShape(this.node)};
a.createPath=function(b){var d=this.bounds.x,e=this.bounds.y,f=this.bounds.width,g=this.bounds.height,h=null;if(this.dialect==mxConstants.DIALECT_SVG){h=new mxPath("svg");h.setTranslate(d,e)}else h=new mxPath("vml");this.redrawPath(h,d,e,f,g,b);return h.getPath()};a.redrawPath=function(){};function mxActor(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxActor.prototype=new mxShape;a=mxActor.prototype;a.constructor=mxActor;a.mixedModeHtml=false;a.preferModeHtml=false;
a.createVml=function(){var b=document.createElement("v:shape");this.configureVmlShape(b);return b};a.redrawVml=function(){this.updateVmlShape(this.node);var b=Math.floor(this.bounds.width),d=Math.floor(this.bounds.height),e=this.strokewidth*this.scale;this.node.setAttribute("coordsize",b+","+d);this.node.setAttribute("strokeweight",e);this.node.setAttribute("path",this.createPath())};a.createSvg=function(){return this.createSvgGroup("path")};
a.redrawSvg=function(){var b=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",b);var d=this.createPath();if(d.length>0){this.innerNode.setAttribute("d",d);this.updateSvgTransform(this.innerNode,false);if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",b);this.shadowNode.setAttribute("d",d);this.updateSvgTransform(this.shadowNode,true)}}else{this.innerNode.removeAttribute("d");this.shadowNode!=null&&this.shadowNode.removeAttribute("d")}};
a.redrawPath=function(b,d,e,f,g){d=f/3;b.moveTo(0,g);b.curveTo(0,3*g/5,0,2*g/5,f/2,2*g/5);b.curveTo(f/2-d,2*g/5,f/2-d,0,f/2,0);b.curveTo(f/2+d,0,f/2+d,2*g/5,f/2,2*g/5);b.curveTo(f,2*g/5,f,3*g/5,f,g);b.close()};function mxCloud(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxCloud.prototype=new mxActor;mxCloud.prototype.constructor=mxActor;
mxCloud.prototype.redrawPath=function(b,d,e,f,g){b.moveTo(0.25*f,0.25*g);b.curveTo(0.05*f,0.25*g,0,0.5*g,0.16*f,0.55*g);b.curveTo(0,0.66*g,0.18*f,0.9*g,0.31*f,0.8*g);b.curveTo(0.4*f,g,0.7*f,g,0.8*f,0.8*g);b.curveTo(f,0.8*g,f,0.6*g,0.875*f,0.5*g);b.curveTo(f,0.3*g,0.8*f,0.1*g,0.625*f,0.2*g);b.curveTo(0.5*f,0.05*g,0.3*f,0.05*g,0.25*f,0.25*g);b.close()};function mxRectangleShape(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxRectangleShape.prototype=new mxShape;a=mxRectangleShape.prototype;
a.constructor=mxRectangleShape;a.createHtml=function(){var b=document.createElement("DIV");this.configureHtmlShape(b);return b};a.createVml=function(){var b=document.createElement(this.isRounded?"v:roundrect":"v:rect");this.configureVmlShape(b);return b};a.createSvg=function(){return this.createSvgGroup("rect")};a.redrawSvg=function(){this.crisp=!this.isRounded;mxShape.prototype.redrawSvg.apply(this,arguments)};
function mxEllipse(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxEllipse.prototype=new mxShape;a=mxEllipse.prototype;a.constructor=mxEllipse;a.mixedModeHtml=false;a.preferModeHtml=false;a.createVml=function(){var b=document.createElement("v:arc");b.setAttribute("startangle","0");b.setAttribute("endangle","360");this.configureVmlShape(b);return b};a.createSvg=function(){return this.createSvgGroup("ellipse")};a.redrawSvg=function(){this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode)};
a.updateSvgNode=function(b){if(b!=null){var d=Math.max(1,this.strokewidth*this.scale);b.setAttribute("stroke-width",d);b.setAttribute("cx",this.bounds.x+this.bounds.width/2);b.setAttribute("cy",this.bounds.y+this.bounds.height/2);b.setAttribute("rx",this.bounds.width/2);b.setAttribute("ry",this.bounds.height/2)}};function mxDoubleEllipse(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxDoubleEllipse.prototype=new mxShape;a=mxDoubleEllipse.prototype;a.constructor=mxDoubleEllipse;
a.mixedModeHtml=false;a.preferModeHtml=false;
a.createVml=function(){var b=document.createElement("v:group");this.background=document.createElement("v:arc");this.background.setAttribute("startangle","0");this.background.setAttribute("endangle","360");this.configureVmlShape(this.background);b.appendChild(this.background);this.label=this.background;this.isShadow=false;this.fill=null;this.foreground=document.createElement("v:oval");this.configureVmlShape(this.foreground);b.appendChild(this.foreground);this.stroke=null;this.configureVmlShape(b);
return b};
a.redrawVml=function(){Math.floor(this.bounds.x);Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width),d=Math.floor(this.bounds.height),e=this.strokewidth*this.scale;this.updateVmlShape(this.node);this.node.setAttribute("coordsize",b+","+d);this.updateVmlShape(this.background);this.background.setAttribute("strokeweight",e);this.background.style.top="0px";this.background.style.left="0px";this.updateVmlShape(this.foreground);this.foreground.setAttribute("strokeweight",e);e=3+e;this.foreground.style.top=e+
"px";this.foreground.style.left=e+"px";this.foreground.style.width=Math.max(0,b-2*e)+"px";this.foreground.style.height=Math.max(0,d-2*e)+"px"};a.createSvg=function(){var b=this.createSvgGroup("ellipse");this.foreground=document.createElementNS(mxConstants.NS_SVG,"ellipse");this.stroke!=null?this.foreground.setAttribute("stroke",this.stroke):this.foreground.setAttribute("stroke","none");this.foreground.setAttribute("fill","none");b.appendChild(this.foreground);return b};
a.redrawSvg=function(){var b=this.strokewidth*this.scale;this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);this.updateSvgNode(this.foreground,3*this.scale+b)};
a.updateSvgNode=function(b,d){d=d!=null?d:0;if(b!=null){var e=Math.max(1,this.strokewidth*this.scale);b.setAttribute("stroke-width",e);b.setAttribute("cx",this.bounds.x+this.bounds.width/2);b.setAttribute("cy",this.bounds.y+this.bounds.height/2);b.setAttribute("rx",Math.max(0,this.bounds.width/2-d));b.setAttribute("ry",Math.max(0,this.bounds.height/2-d))}};function mxRhombus(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxRhombus.prototype=new mxShape;a=mxRhombus.prototype;
a.constructor=mxRhombus;a.mixedModeHtml=false;a.preferModeHtml=false;a.createHtml=function(){var b=document.createElement("DIV");this.configureHtmlShape(b);return b};a.createVml=function(){var b=document.createElement("v:shape");this.configureVmlShape(b);return b};a.createSvg=function(){return this.createSvgGroup("path")};
a.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);this.updateVmlShape(this.node);var b=Math.floor(this.bounds.width),d=Math.floor(this.bounds.height);this.node.setAttribute("coordsize",b+","+d);this.node.setAttribute("path","m "+Math.floor(0+b/2)+" 0 l "+(0+b)+" "+Math.floor(0+d/2)+" l "+Math.floor(0+b/2)+" "+(0+d)+" l 0 "+Math.floor(0+d/2)+" x e")};a.redrawHtml=function(){this.updateHtmlShape(this.node)};
a.redrawSvg=function(){this.updateSvgNode(this.innerNode);this.shadowNode!=null&&this.updateSvgNode(this.shadowNode)};a.updateSvgNode=function(b){var d=Math.max(1,this.strokewidth*this.scale);b.setAttribute("stroke-width",d);d=this.bounds.x;var e=this.bounds.y,f=this.bounds.width,g=this.bounds.height;b.setAttribute("d","M "+(d+f/2)+" "+e+" L "+(d+f)+" "+(e+g/2)+" L "+(d+f/2)+" "+(e+g)+" L "+d+" "+(e+g/2)+" Z ");this.updateSvgTransform(b,b==this.shadowNode)};
function mxPolyline(b,d,e){this.points=b;this.stroke=d||"black";this.strokewidth=e||1}mxPolyline.prototype=new mxShape;a=mxPolyline.prototype;a.constructor=mxPolyline;
a.create=function(){var b=null;if(this.dialect==mxConstants.DIALECT_SVG)b=this.createSvg();else if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML&&this.points!=null&&this.points.length>0){b=document.createElement("DIV");this.configureHtmlShape(b);b.style.borderStyle="";b.style.background=""}else{b=document.createElement("v:shape");this.configureVmlShape(b);var d=document.createElement("v:stroke");this.opacity!=null&&d.setAttribute("opacity",this.opacity+
"%");b.appendChild(d)}return b};a.redrawVml=function(){if(this.points!=null&&this.points.length>0&&this.points[0]!=null){this.bounds=new mxRectangle(this.points[0].x,this.points[0].y,0,0);for(var b=1;b<this.points.length;b++)this.bounds.add(new mxRectangle(this.points[b].x,this.points[b].y,0,0))}mxShape.prototype.redrawVml.apply(this,arguments)};
a.createSvg=function(){var b=this.createSvgGroup("path"),d=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",d);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};
a.redrawSvg=function(){this.updateSvgShape(this.innerNode);var b=this.innerNode.getAttribute("d");if(b!=null){this.pipe.setAttribute("d",b);this.pipe.setAttribute("stroke-width",this.strokewidth*this.scale+mxShape.prototype.SVG_STROKE_TOLERANCE)}};function mxArrow(b,d,e,f,g,h,j){this.points=b;this.fill=d;this.stroke=e;this.strokewidth=f||1;this.arrowWidth=g||mxConstants.ARROW_WIDTH;this.spacing=h||mxConstants.ARROW_SPACING;this.endSize=j||mxConstants.ARROW_SIZE}mxArrow.prototype=new mxShape;a=mxArrow.prototype;
a.constructor=mxArrow;a.mixedModeHtml=false;a.preferModeHtml=false;a.DEG_PER_RAD=57.2957795;a.createVml=function(){var b=document.createElement("v:shape");this.configureVmlShape(b);return b};
a.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.points!=null){this.updateVmlShape(this.node);var b=this.spacing*this.scale,d=this.arrowWidth*this.scale,e=this.endSize*this.scale,f=this.points[0],g=this.points[this.points.length-1],h=g.x-f.x,j=g.y-f.y,k=Math.sqrt(h*h+j*j),l=k-2*b-e;h=h/k;j=j/k;k=d*j/3;d=-d*h/3;e=f.x-k/2+b*h;f=f.y-d/2+b*j;var m=e+k,n=f+d,o=m+l*h;l=n+l*j;var p=o+k,q=l+d,r=p-3*k,s=q-3*d;b="m"+Math.round(e)+","+Math.round(f)+" l"+Math.round(m)+
","+Math.round(n)+","+Math.round(o)+","+Math.round(l)+","+Math.round(p)+","+Math.round(q)+","+Math.round(g.x-b*h)+","+Math.round(g.y-b*j)+","+Math.round(r)+","+Math.round(s)+","+Math.round(r+k)+","+Math.round(s+d)+","+Math.round(e)+","+Math.round(f)+" xe";this.node.style.left=null;this.node.style.top=null;this.node.setAttribute("path",b)}};a.createSvg=function(){var b=document.createElementNS(mxConstants.NS_SVG,"polygon");this.configureSvgShape(b);return b};
a.redrawSvg=function(){if(this.points!=null){this.node.setAttribute("stroke-width",Math.max(1,this.strokewidth*this.scale));var b=this.points[0],d=this.points[this.points.length-1],e=d.x-b.x,f=d.y-b.y,g=Math.sqrt(e*e+f*f),h=this.spacing*this.scale;f=Math.min(25,Math.max(20,g/5))*this.scale;var j=b.x+h,k=b.y-f/2;e=f;var l=f*0.3;g=j+(g-2*h);h=k+f;this.node.setAttribute("points",j+","+(k+l)+" "+(g-e)+","+(k+l)+" "+(g-e)+","+k+" "+g+","+(k+f/2)+" "+(g-e)+","+h+" "+(g-e)+","+(h-l)+" "+j+","+(h-l));e=d.x-
b.x;l=d.y-b.y;d=Math.atan(l/e)*this.DEG_PER_RAD;if(e<0)d-=180;this.node.setAttribute("transform","rotate("+d+","+b.x+","+b.y+")")}};
function mxText(b,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,u,v,w){this.value=b;this.bounds=d;this.color=g||"black";this.align=e||"";this.valign=f||"";this.family=h||mxConstants.DEFAULT_FONTFAMILY;this.size=j||mxConstants.DEFAULT_FONTSIZE;this.fontStyle=k||0;this.spacing=parseInt(l||2);this.spacingTop=this.spacing+parseInt(m||0);this.spacingRight=this.spacing+parseInt(n||0);this.spacingBottom=this.spacing+parseInt(o||0);this.spacingLeft=this.spacing+parseInt(p||0);this.horizontal=q!=null?q:true;this.background=
r;this.border=s;this.wrap=u!=null?u:false;this.clipped=v!=null?v:false;this.overflow=w!=null?w:"visible"}mxText.prototype=new mxShape;a=mxText.prototype;a.constructor=mxText;a.isStyleSet=function(b){return(this.fontStyle&b)==b};
a.create=function(b){var d=null;return d=this.dialect==mxConstants.DIALECT_SVG?this.createSvg():this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML||!mxUtils.isVml(b)?mxClient.IS_NS&&!mxClient.NO_FO?this.createForeignObject():this.createHtml():this.createVml()};
a.createForeignObject=function(){var b=document.createElementNS(mxConstants.NS_SVG,"g"),d=document.createElementNS(mxConstants.NS_SVG,"foreignObject");d.setAttribute("pointer-events","fill");var e=document.createElementNS(mxConstants.NS_XHTML,"body");e.setAttribute("xmlns","http://www.w3.org/1999/xhtml");e.style.margin="0px";e.style.height="100%";d.appendChild(e);b.appendChild(d);return b};a.createHtml=function(){var b=this.createHtmlTable();b.style.position="absolute";return b};a.createVml=function(){return document.createElement("v:textbox")};
a.redrawHtml=function(){this.redrawVml()};
a.getOffset=function(b,d,e,f,g){var h=(g=g!=null?g:this.horizontal)?this.align:this.valign,j=g?this.valign:this.align,k=e-b,l=f-d;if(h==mxConstants.ALIGN_CENTER||h==mxConstants.ALIGN_MIDDLE)k=Math.floor(k/2);else if(h==mxConstants.ALIGN_LEFT||h===mxConstants.ALIGN_TOP)k=g?0:(e-f)/2;else g||(k=(e+f)/2-b);if(j==mxConstants.ALIGN_MIDDLE||j==mxConstants.ALIGN_CENTER)l=Math.floor(l/2);else if(j==mxConstants.ALIGN_TOP||j==mxConstants.ALIGN_LEFT)l=g?0:(f+e)/2-d;else g||(l=(f-e)/2);return new mxPoint(k,l)};
a.getSpacing=function(b){b=b!=null?b:this.horizontal;var d=this.spacingLeft,e=this.spacingTop;if(this.align==mxConstants.ALIGN_CENTER)d-=this.spacingRight;else if(this.align==mxConstants.ALIGN_RIGHT)d=-this.spacingRight;if(this.valign==mxConstants.ALIGN_MIDDLE)e-=this.spacingBottom;else if(this.valign==mxConstants.ALIGN_BOTTOM)e=-this.spacingBottom;return b?new mxPoint(d,e):new mxPoint(e,d)};
a.createHtmlTable=function(){var b=document.createElement("table");b.style.borderCollapse="collapse";var d=document.createElement("tbody"),e=document.createElement("tr"),f=document.createElement("td");e.appendChild(f);d.appendChild(e);b.appendChild(d);return b};
a.updateHtmlTable=function(b,d){d=d!=null?d:1;var e=b.firstChild.firstChild.firstChild;if(mxUtils.isNode(this.value))e.appendChild(this.value);else if(this.lastValue!=this.value){e.innerHTML=this.value.replace(/\n/g,"<br/>");this.lastValue=this.value}d=Math.round(this.size*d);b.style.visibility=d<=0?"hidden":"";b.style.fontSize=d+"px";b.style.color=this.color;b.style.fontFamily=this.family;b.style.fontWeight=this.isStyleSet(mxConstants.FONT_BOLD)?"bold":"normal";b.style.fontStyle=this.isStyleSet(mxConstants.FONT_ITALIC)?
"italic":"";b.style.textDecoration=this.isStyleSet(mxConstants.FONT_UNDERLINE)?"underline":"";this.opacity!=null&&mxUtils.setOpacity(b,this.opacity);if(mxClient.IS_IE)if(this.isStyleSet(mxConstants.FONT_SHADOW))e.style.filter="Shadow(Color=#666666,Direction=135,Strength=%)";else e.style.removeAttribute("filter");if(this.wrap&&this.bounds.width>0&&this.dialect!=mxConstants.DIALECT_SVG){d=(this.horizontal||mxUtils.isVml(this.node)?this.bounds.width:this.bounds.height)/this.scale;b.style.width=d+"px";
e.style.whiteSpace=""}else{b.style.width="";e.style.whiteSpace="nowrap"}e.style.textAlign=this.align==mxConstants.ALIGN_RIGHT?"right":this.align==mxConstants.ALIGN_CENTER?"center":"left";e.style.verticalAlign=this.valign==mxConstants.ALIGN_BOTTOM?"bottom":this.valign==mxConstants.ALIGN_MIDDLE?"middle":"top";e.style.background=this.value.length>0&&this.background!=null?this.background:"";if(this.value.length>0&&this.border!=null){b.style.borderColor=this.border;b.style.borderWidth="1px";b.style.borderStyle=
"solid"}else b.style.borderStyle="none"};a.redrawVml=function(){if(this.node.nodeName=="g")this.redrawForeignObject();else mxUtils.isVml(this.node)?this.redrawTextbox():this.redrawHtmlTable()};
a.redrawTextbox=function(){var b=this.node;b.firstChild==null&&b.appendChild(this.createHtmlTable());var d=b.firstChild;this.updateHtmlTable(d);d.style.filter="";b.inset="0px,0px,0px,0px";if(this.overflow!="fill"){var e=d.offsetWidth*this.scale,f=d.offsetHeight*this.scale,g=this.getOffset(this.bounds.width,this.bounds.height,e,f);if(!this.horizontal)d.style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";var h=this.getSpacing();d=this.bounds.x-g.x+h.x*this.scale;g=this.bounds.y-
g.y+h.y*this.scale;var j=this.bounds.x;h=this.bounds.y;var k=this.bounds.width,l=this.bounds.height;if(this.horizontal){var m=Math.round(d-j),n=Math.round(g-h),o=Math.min(0,Math.round(j+k-d-e-1)),p=Math.min(0,Math.round(h+l-g-f-1));b.inset=m+"px,"+n+"px,"+o+"px,"+p+"px"}else{p=o=n=m=0;if(this.align==mxConstants.ALIGN_CENTER)p=m=(l-e)/2;else if(this.align==mxConstants.ALIGN_LEFT)m=l-e;else p=l-e;if(this.valign==mxConstants.ALIGN_MIDDLE)o=n=(k-f)/2;else if(this.valign==mxConstants.ALIGN_BOTTOM)n=k-
f;else o=k-f;n+=hs*this.scale;m+=vs*this.scale;o+=hs*this.scale;p+=vs*this.scale;b.inset=n+"px,"+m+"px,"+o+"px,"+p+"px"}b.style.zoom=this.scale;if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();e=Math.round(j-d);f=Math.round(h-g);b.style.clip="rect("+f/this.scale+" "+(e+this.bounds.width)/this.scale+" "+(f+this.bounds.height)/this.scale+" "+e/this.scale+")"}else this.boundingBox=new mxRectangle(d,g,e,f)}else this.boundingBox=this.bounds.clone()};
a.redrawHtmlTable=function(){if(!(isNaN(this.bounds.x)||isNaN(this.bounds.y)||isNaN(this.bounds.width)||isNaN(this.bounds.height))){var b=this.node,d=b.firstChild.firstChild.firstChild,e=false,f=1;if(mxClient.IS_IE)b.style.removeAttribute("filter");else if(mxClient.IS_NS){b.style.MozTransform="";d.style.MozTransform=""}else{if(mxClient.IS_OT)b.style.OTransform="";f=this.scale;e=true}this.updateHtmlTable(b,f);if(this.overflow!="fill"){b.style.left="";b.style.top="";b.style.height="";var g=parseFloat(d.style.zoom)||
1;f=b.offsetWidth/g;g=b.offsetHeight/g;var h=this.getOffset(this.bounds.width/this.scale,this.bounds.height/this.scale,f,g,e||this.horizontal),j=this.getSpacing(e||this.horizontal),k=this.bounds.x/this.scale-h.x+j.x,l=this.bounds.y/this.scale-h.y+j.y,m=this.scale;j=1;var n=0,o=0;if(!this.horizontal)if(mxClient.IS_IE){b.style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";n=f/2-g/2;o=-n}else if(mxClient.IS_GC)b.style.WebkitTransform="rotate(-90deg)";else if(mxClient.IS_OT)b.style.OTransform=
"rotate(-90deg)";else if(mxClient.IS_SVG){b.style.MozTransform="rotate(-90deg)";d.style.MozTransform="rotate(0deg)";j=1/this.scale;m=1}if(mxClient.IS_SVG||e){if(mxClient.IS_SVG){b.style.MozTransform+=" scale("+this.scale+")";j=1/this.scale}n=(this.scale-1)*f/(2*this.scale);o=(this.scale-1)*g/(2*this.scale);m=1}else if(!e)d.style.zoom=this.scale;b.style.left=Math.round((k+n)*this.scale)+"px";b.style.top=Math.round((l+o)*this.scale)+"px";b.style.width=Math.round(f*m)+"px";b.style.height=Math.round(g*
m)+"px";if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();if(this.horizontal||e&&!mxClient.IS_OT){d=Math.max(0,h.x*m);e=Math.max(0,h.y*m);b.style.clip="rect("+e+" "+(d+this.bounds.width*j)+" "+(e+this.bounds.height*j)+" "+d+")"}else if(mxClient.IS_IE){h=this.bounds.width;j=this.bounds.height;e=d=0;if(this.align==mxConstants.ALIGN_LEFT)d=Math.max(0,f-j/this.scale)*this.scale;else if(this.align==mxConstants.ALIGN_CENTER)d=Math.max(0,f-j/this.scale)*this.scale/
2;if(this.valign==mxConstants.ALIGN_BOTTOM)e=Math.max(0,g-h/this.scale)*this.scale;else if(this.valign==mxConstants.ALIGN_MIDDLE)e=Math.max(0,g-h/this.scale)*this.scale/2;b.style.clip="rect("+d+" "+(e+h-1)+" "+(d+j-1)+" "+e+")"}else{h=this.bounds.width/this.scale;j=this.bounds.height/this.scale;if(mxClient.IS_OT){h=this.bounds.width;j=this.bounds.height}e=d=0;if(this.align==mxConstants.ALIGN_RIGHT)d=Math.max(0,f-j);else if(this.align==mxConstants.ALIGN_CENTER)d=Math.max(0,f-j)/2;if(this.valign==mxConstants.ALIGN_BOTTOM)e=
Math.max(0,g-h);else if(this.valign==mxConstants.ALIGN_MIDDLE)e=Math.max(0,g-h)/2;if(mxClient.IS_GC){d*=this.scale;e*=this.scale;h*=this.scale;j*=this.scale}b.style.clip="rect("+e+" "+(d+j)+" "+(e+h)+" "+d+")"}}else this.boundingBox=new mxRectangle(b.offsetLeft,b.offsetTop,b.offsetWidth,b.offsetHeight)}else{this.boundingBox=this.bounds.clone();b.style.left=Math.round(this.bounds.x)+"px";b.style.top=Math.round(this.bounds.y)+"px";b.style.width=Math.round(this.bounds.width)+"px";b.style.height=Math.round(this.bounds.height)+
"px"}}};
a.redrawForeignObject=function(){for(var b=this.node,d=b.firstChild;d==this.backgroundNode;)d=d.nextSibling;var e=d.firstChild;e.firstChild==null&&e.appendChild(this.createHtmlTable());var f=e.firstChild;this.updateHtmlTable(f);if(mxClient.IS_GC){f.style.borderStyle="none";f.firstChild.firstChild.firstChild.style.background="";if(this.backgroundNode==null&&(this.background!=null||this.border!=null)){this.backgroundNode=document.createElementNS(mxConstants.NS_SVG,"rect");b.insertBefore(this.backgroundNode,b.firstChild)}else if(this.backgroundNode!=
null&&this.background==null&&this.border==null){this.backgroundNode.parentNode.removeChild(this.backgroundNode);this.backgroundNode=null}if(this.backgroundNode!=null){this.background!=null?this.backgroundNode.setAttribute("fill",this.background):this.backgroundNode.setAttribute("fill","none");this.border!=null?this.backgroundNode.setAttribute("stroke",this.border):this.backgroundNode.setAttribute("stroke","none")}}if(this.overflow!="fill"){d.removeAttribute("x");d.removeAttribute("y");d.removeAttribute("width");
d.removeAttribute("height");d.style.width="";d.style.height="";d.style.clip="";mxClient.IS_GC||document.body.appendChild(f);var g=f.offsetWidth,h=f.offsetHeight;f.parentNode!=e&&e.appendChild(f);var j=this.getSpacing(),k=this.bounds.x/this.scale+j.x;j=this.bounds.y/this.scale+j.y;e=this.bounds.width/this.scale;f=this.bounds.height/this.scale;var l=this.getOffset(e,f,g,h);if(this.horizontal){k-=l.x;j-=l.y;b.setAttribute("transform","scale("+this.scale+")")}else{b.setAttribute("transform","scale("+
this.scale+") rotate(270 "+(k+g/2)+" "+(j+h/2)+")");k+=l.y;j-=l.x}if(this.backgroundNode!=null){this.backgroundNode.setAttribute("x",k);this.backgroundNode.setAttribute("y",j);this.backgroundNode.setAttribute("width",g);this.backgroundNode.setAttribute("height",h)}d.setAttribute("x",k);d.setAttribute("y",j);d.setAttribute("width",g);d.setAttribute("height",h);if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();k=Math.max(0,l.x);b=Math.max(0,l.y);if(this.horizontal)d.style.clip=
"rect("+b+" "+(k+e)+" "+(b+f)+" "+k+")";else{b=k=0;if(this.align==mxConstants.ALIGN_RIGHT)k=Math.max(0,g-f);else if(this.align==mxConstants.ALIGN_CENTER)k=Math.max(0,g-f)/2;if(this.valign==mxConstants.ALIGN_BOTTOM)b=Math.max(0,h-e);else if(this.valign==mxConstants.ALIGN_MIDDLE)b=Math.max(0,h-e)/2;d.style.clip="rect("+b+" "+(k+f)+" "+(b+e)+" "+k+")"}if(this.backgroundNode!=null){k=this.bounds.x/this.scale;j=this.bounds.y/this.scale;if(!this.horizontal){k+=(h+g)/2-f;j+=(h-g)/2;d=e;e=f;f=d}d=this.getSvgClip(this.node.ownerSVGElement,
k,j,e,f);if(d!=this.clip){this.releaseSvgClip();this.clip=d;d.refCount++}this.backgroundNode.setAttribute("clip-path","url(#"+d.getAttribute("id")+")")}}else{this.releaseSvgClip();this.backgroundNode!=null&&this.backgroundNode.removeAttribute("clip-path");this.boundingBox=this.horizontal?new mxRectangle(k*this.scale,j*this.scale,g*this.scale,h*this.scale):new mxRectangle(k*this.scale,j*this.scale,h*this.scale,g*this.scale)}}else{d.setAttribute("x",this.bounds.x);d.setAttribute("y",this.bounds.y);
d.setAttribute("width",this.bounds.width);d.setAttribute("height",this.bounds.height);if(this.backgroundNode!=null){this.backgroundNode.setAttribute("x",k);this.backgroundNode.setAttribute("y",j);this.backgroundNode.setAttribute("width",this.bounds.width);this.backgroundNode.setAttribute("height",this.bounds.height)}f.style.width="100%";f.style.height="100%"}};
a.createSvg=function(){var b=document.createElementNS(mxConstants.NS_SVG,"g"),d=this.isStyleSet(mxConstants.FONT_UNDERLINE)?"underline":"none",e=this.isStyleSet(mxConstants.FONT_BOLD)?"bold":"normal",f=this.isStyleSet(mxConstants.FONT_ITALIC)?"italic":null,g=this.align==mxConstants.ALIGN_RIGHT?"end":this.align==mxConstants.ALIGN_CENTER?"middle":"start";b.setAttribute("text-decoration",d);b.setAttribute("text-anchor",g);b.setAttribute("font-family",this.family);b.setAttribute("font-weight",e);b.setAttribute("font-size",
Math.floor(this.size*this.scale)+"px");b.setAttribute("fill",this.color);f!=null&&b.setAttribute("font-style",f);if(this.background!=null||this.border!=null){this.backgroundNode=document.createElementNS(mxConstants.NS_SVG,"rect");this.backgroundNode.setAttribute("shape-rendering","crispEdges");this.background!=null?this.backgroundNode.setAttribute("fill",this.background):this.backgroundNode.setAttribute("fill","none");this.border!=null?this.backgroundNode.setAttribute("stroke",this.border):this.backgroundNode.setAttribute("stroke",
"none")}this.updateSvgValue(b);return b};a.updateSvgValue=function(b){if(this.currentValue!=this.value){for(;b.firstChild!=null;)b.removeChild(b.firstChild);if(this.value!=null){var d=this.value.split("\n");this.textNodes=new Array(d.length);for(var e=0;e<d.length;e++)if(this.isEmptyString(d[e]))this.textNodes[e]=null;else{var f=this.createSvgSpan(d[e]);b.appendChild(f);this.textNodes[e]=f;f.setAttribute("text-decoration","inherit")}}this.currentValue=this.value}};
a.redrawSvg=function(){if(this.node.nodeName=="foreignObject")this.redrawHtml();else{var b=Math.round(this.size*this.scale);b<=0?this.node.setAttribute("visibility","hidden"):this.node.removeAttribute("visibility");this.updateSvgValue(this.node);this.node.setAttribute("font-size",b+"px");if(this.opacity!=null){this.node.setAttribute("fill-opacity",this.opacity/100);this.node.setAttribute("stroke-opacity",this.opacity/100)}b=this.size*1.3*this.scale;var d=this.node.childNodes.length,e=this.textNodes!=
null?this.textNodes.length:0;this.backgroundNode!=null&&d--;d=this.bounds.x;var f=this.bounds.y;d+=this.align==mxConstants.ALIGN_RIGHT?(this.horizontal?this.bounds.width:this.bounds.height)-this.spacingRight*this.scale:this.align==mxConstants.ALIGN_CENTER?this.spacingLeft+((this.horizontal?this.bounds.width:this.bounds.height)-this.spacingLeft-this.spacingRight)/2:this.spacingLeft*this.scale;f+=this.valign==mxConstants.ALIGN_BOTTOM?(this.horizontal?this.bounds.height:this.bounds.width)-(e-1)*b-this.spacingBottom*
this.scale-3:this.valign==mxConstants.ALIGN_MIDDLE?(this.spacingTop*this.scale+(this.horizontal?this.bounds.height:this.bounds.width)-this.spacingBottom*this.scale-(e-1.5)*b)/2+1:this.spacingTop*this.scale+b-2;this.horizontal||this.node.setAttribute("transform","rotate(-90 "+(this.bounds.x+this.bounds.width/2)+" "+(this.bounds.y+this.bounds.height/2)+") translate("+-((this.bounds.height-this.bounds.width)/2)+" "+-((this.bounds.width-this.bounds.height)/2)+")");if(this.textNodes!=null)for(var g=f,
h=0;h<e;h++){var j=this.textNodes[h];if(j!=null){j.setAttribute("x",d);j.setAttribute("y",g);j.setAttribute("style","pointer-events: all")}g+=b}if(this.overflow!="fill"){h=this.value;j=this.createHtmlTable();this.lastValue=null;this.value=mxUtils.htmlEntities(this.value,false);this.updateHtmlTable(j);document.body.appendChild(j);e=j.offsetWidth*this.scale;g=j.offsetHeight*this.scale;j.parentNode.removeChild(j);this.value=h;h=2*this.scale;if(this.align==mxConstants.ALIGN_CENTER)h+=e/2;else if(this.align==
mxConstants.ALIGN_RIGHT)h+=e;this.boundingBox=new mxRectangle(d-h,f-b,e+4*this.scale,g+1*this.scale)}else this.boundingBox=this.bounds.clone();if(this.value.length>0&&this.backgroundNode!=null&&this.node.firstChild!=null){this.node.firstChild!=this.backgroundNode&&this.node.insertBefore(this.backgroundNode,this.node.firstChild);this.backgroundNode.setAttribute("x",this.boundingBox.x+2*this.scale);this.backgroundNode.setAttribute("y",this.boundingBox.y+2*this.scale);this.backgroundNode.setAttribute("width",
this.boundingBox.width);this.backgroundNode.setAttribute("height",this.boundingBox.height);this.backgroundNode.setAttribute("stroke-width",Math.round(Math.max(1,this.scale)))}if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();if(!this.horizontal){this.boundingBox.width=this.bounds.height;this.boundingBox.height=this.bounds.width}d=this.bounds.x;f=this.bounds.y;if(this.horizontal){e=this.bounds.width;g=this.bounds.height}else{e=this.bounds.height;g=this.bounds.width}b=
this.getSvgClip(this.node.ownerSVGElement,d,f,e,g);if(b!=this.clip){this.releaseSvgClip();this.clip=b;b.refCount++}this.node.setAttribute("clip-path","url(#"+b.getAttribute("id")+")")}else{this.releaseSvgClip();this.node.removeAttribute("clip-path")}}};a.releaseSvgClip=function(){if(this.clip!=null){this.clip.refCount--;this.clip.refCount==0&&this.clip.parentNode.removeChild(this.clip);this.clip=null}};
a.getSvgClip=function(b,d,e,f,g){d=Math.round(d);e=Math.round(e);f=Math.round(f);g=Math.round(g);var h="-mx-clip+"+d+"+"+e+"+"+f+"+"+g;if(this.clip!=null&&this.clip.ident==h)return this.clip;var j=0,k=h+"-"+j;for(k=document.getElementById(k);k!=null;){if(k.ownerSVGElement==b)return k;j++;k=h+"-"+j;k=document.getElementById(k)[0]}if(k!=null){k=k.cloneNode(true);j++}else{k=document.createElementNS(mxConstants.NS_SVG,"clipPath");var l=document.createElementNS(mxConstants.NS_SVG,"rect");l.setAttribute("x",
d);l.setAttribute("y",e);l.setAttribute("width",f);l.setAttribute("height",g);k.appendChild(l)}k.setAttribute("id",h+"-"+j);k.ident=h;b.appendChild(k);k.refCount=0;return k};a.isEmptyString=function(b){return b.replace(/ /g,"").length==0};a.createSvgSpan=function(b){var d=document.createElementNS(mxConstants.NS_SVG,"text");mxUtils.write(d,b);return d};a.destroy=function(){this.releaseSvgClip();mxShape.prototype.destroy.apply(this,arguments)};function mxTriangle(){}mxTriangle.prototype=new mxActor;
mxTriangle.prototype.constructor=mxTriangle;mxTriangle.prototype.redrawPath=function(b,d,e,f,g){if(this.direction==mxConstants.DIRECTION_NORTH){b.moveTo(0,g);b.lineTo(0.5*f,0);b.lineTo(f,g)}else if(this.direction==mxConstants.DIRECTION_SOUTH){b.moveTo(0,0);b.lineTo(0.5*f,g);b.lineTo(f,0)}else if(this.direction==mxConstants.DIRECTION_WEST){b.moveTo(f,0);b.lineTo(0,0.5*g);b.lineTo(f,g)}else{b.moveTo(0,0);b.lineTo(f,0.5*g);b.lineTo(0,g)}b.close()};function mxHexagon(){}mxHexagon.prototype=new mxActor;
mxHexagon.prototype.constructor=mxHexagon;mxHexagon.prototype.redrawPath=function(b,d,e,f,g){if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){b.moveTo(0.5*f,0);b.lineTo(f,0.25*g);b.lineTo(f,0.75*g);b.lineTo(0.5*f,g);b.lineTo(0,0.75*g);b.lineTo(0,0.25*g)}else{b.moveTo(0.25*f,0);b.lineTo(0.75*f,0);b.lineTo(f,0.5*g);b.lineTo(0.75*f,g);b.lineTo(0.25*f,g);b.lineTo(0,0.5*g)}b.close()};
function mxLine(b,d,e){this.bounds=b;this.stroke=d||"black";this.strokewidth=e||1}mxLine.prototype=new mxShape;a=mxLine.prototype;a.constructor=mxLine;a.mixedModeHtml=false;a.preferModeHtml=false;a.clone=function(){var b=new mxLine(this.bounds,this.stroke,this.strokewidth);b.isDashed=this.isDashed;return b};
a.createVml=function(){var b=document.createElement("v:group");b.setAttribute("coordorigin","0,0");b.style.position="absolute";b.style.overflow="visible";this.label=document.createElement("v:rect");this.configureVmlShape(this.label);this.label.setAttribute("stroked","false");this.label.setAttribute("filled","false");b.appendChild(this.label);this.innerNode=document.createElement("v:shape");this.configureVmlShape(this.innerNode);b.appendChild(this.innerNode);return b};
a.redrawVml=function(){var b=Math.round(this.bounds.x),d=Math.round(this.bounds.y),e=Math.round(this.bounds.width),f=Math.round(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",e+","+f);this.updateVmlShape(this.label);this.label.style.left="0px";this.label.style.top="0px";this.innerNode.setAttribute("coordsize",e+","+f);this.innerNode.style.left=b+"px";this.innerNode.style.top=d+"px";this.innerNode.style.width=e+"px";this.innerNode.style.height=f+"px";this.innerNode.setAttribute("strokeweight",
this.strokewidth*this.scale);this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH?this.innerNode.setAttribute("path","m "+(e/2-b)+" "+-d+" l "+(e/2-b)+" "+(f-d)+" e"):this.innerNode.setAttribute("path","m "+-b+" "+(f/2-d)+" l "+(e-b)+" "+(f/2-d)+" e")};
a.createSvg=function(){var b=this.createSvgGroup("path"),d=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",d);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};
a.redrawSvg=function(){this.innerNode.setAttribute("stroke-width",Math.max(1,this.strokewidth*this.scale));if(this.bounds!=null){var b=this.bounds.x,d=this.bounds.y,e=this.bounds.width,f=this.bounds.height,g=null;g=this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH?"M "+(b+e/2)+" "+d+" L "+(b+e/2)+" "+(d+f):"M "+b+" "+(d+f/2)+" L "+(b+e)+" "+(d+f/2);this.innerNode.setAttribute("d",g);this.pipe.setAttribute("d",g);this.pipe.setAttribute("stroke-width",this.strokewidth*
this.scale+mxShape.prototype.SVG_STROKE_TOLERANCE);this.updateSvgTransform(this.innerNode,false);this.updateSvgTransform(this.pipe,false)}};function mxImageShape(b,d,e,f,g){this.bounds=b;this.image=d;this.fill=e;this.stroke=f;this.strokewidth=g||1;this.isShadow=false}mxImageShape.prototype=new mxShape;a=mxImageShape.prototype;a.constructor=mxImageShape;
a.apply=function(){mxShape.prototype.apply.apply(this,arguments);this.stroke=this.fill=null;if(this.style!=null){this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND);this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER)}};
a.create=function(){var b=null;if(this.dialect==mxConstants.DIALECT_SVG){b=this.createSvgGroup("rect");this.innerNode.setAttribute("fill",this.fill);this.innerNode.setAttribute("visibility","hidden");this.innerNode.setAttribute("pointer-events","fill");this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",this.image);this.imageNode.setAttribute("style","pointer-events:none");this.configureSvgShape(this.imageNode);this.imageNode.removeAttribute("stroke");
this.imageNode.removeAttribute("fill");b.insertBefore(this.imageNode,this.innerNode);if(this.fill!=null&&this.fill!=mxConstants.NONE||this.stroke!=null&&this.stroke!=mxConstants.NONE){this.bg=document.createElementNS(mxConstants.NS_SVG,"rect");this.bg.setAttribute("fill",this.fill||"none");this.bg.setAttribute("stroke",this.stroke||"none");b.insertBefore(this.bg,b.firstChild)}}else if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML){b=document.createElement("DIV");
this.configureHtmlShape(b);var d=this.image.toUpperCase();if(d.substring(d.length-3,d.length)=="PNG"&&mxClient.IS_IE6)b.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+this.image+"', sizingMethod='scale')";else{d=document.createElement("img");d.setAttribute("src",this.image);d.style.width="100%";d.style.height="100%";d.setAttribute("border","0");b.appendChild(d)}}else{b=document.createElement("v:image");b.setAttribute("src",this.image);this.configureVmlShape(b)}return b};
a.configureTransparentBackground=function(){};a.redrawSvg=function(){this.updateSvgShape(this.innerNode);this.updateSvgShape(this.imageNode);if(this.bg!=null){this.updateSvgShape(this.bg);this.bg.setAttribute("fill",this.innerNode.getAttribute("fill"));this.bg.setAttribute("stroke",this.innerNode.getAttribute("stroke"));this.bg.setAttribute("shape-rendering","crispEdges")}};function mxLabel(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxLabel.prototype=new mxShape;a=mxLabel.prototype;
a.constructor=mxLabel;a.imageSize=mxConstants.DEFAULT_IMAGESIZE;a.spacing=2;a.indicatorSize=10;a.indicatorSpacing=2;
a.init=function(){mxShape.prototype.init.apply(this,arguments);if(this.indicatorColor!=null&&this.indicatorShape!=null){this.indicator=new this.indicatorShape;this.indicator.dialect=this.dialect;this.indicator.bounds=this.bounds;this.indicator.fill=this.indicatorColor;this.indicator.stroke=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.direction=this.indicatorDirection;this.indicator.init(this.node);this.indicatorShape=null}};
a.reconfigure=function(){mxShape.prototype.reconfigure.apply(this);if(this.indicator!=null){this.indicator.fill=this.indicatorColor;this.indicator.stroke=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.direction=this.indicatorDirection;this.indicator.reconfigure()}};
a.createHtml=function(){var b=document.createElement("DIV");this.configureHtmlShape(b);if(this.indicatorImage!=null){this.indicatorImageNode=mxUtils.createImage(this.indicatorImage);this.indicatorImageNode.style.position="absolute";b.appendChild(this.indicatorImageNode)}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.stroke=null;this.configureHtmlShape(this.imageNode);b.appendChild(this.imageNode)}return b};
a.createVml=function(){var b=document.createElement("v:group");this.rectNode=document.createElement(this.isRounded?"v:roundrect":"v:rect");this.configureVmlShape(this.rectNode);this.isShadow=false;this.configureVmlShape(b);b.setAttribute("coordorigin","0,0");b.appendChild(this.rectNode);if(this.indicatorImage!=null){this.indicatorImageNode=document.createElement("v:image");this.indicatorImageNode.setAttribute("src",this.indicatorImage);b.appendChild(this.indicatorImageNode)}if(this.image!=null){this.imageNode=
document.createElement("v:image");this.imageNode.setAttribute("src",this.image);this.configureVmlShape(this.imageNode);b.appendChild(this.imageNode)}this.label=document.createElement("v:rect");this.label.style.top="0px";this.label.style.left="0px";this.label.setAttribute("filled","false");this.label.setAttribute("stroked","false");b.appendChild(this.label);return b};
a.createSvg=function(){var b=this.createSvgGroup("rect");if(this.indicatorImage!=null){this.indicatorImageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.indicatorImageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.indicatorImage);b.appendChild(this.indicatorImageNode)}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.imageNode.setAttribute("style","pointer-events:none");
this.configureSvgShape(this.imageNode);b.appendChild(this.imageNode)}return b};
a.redraw=function(){var b=this.dialect==mxConstants.DIALECT_SVG,d=mxUtils.isVml(this.node);if(b){this.updateSvgShape(this.innerNode);this.shadowNode!=null&&this.updateSvgShape(this.shadowNode)}else if(d){this.updateVmlShape(this.node);this.node.setAttribute("coordsize",this.bounds.width+","+this.bounds.height);this.updateVmlShape(this.rectNode);this.rectNode.style.top="0px";this.rectNode.style.left="0px";this.label.style.width=this.bounds.width+"px";this.label.style.height=this.bounds.height+"px"}else this.updateHtmlShape(this.node);
var e=d=0;if(this.imageNode!=null){d=(this.style[mxConstants.STYLE_IMAGE_WIDTH]||this.imageSize)*this.scale;e=(this.style[mxConstants.STYLE_IMAGE_HEIGHT]||this.imageSize)*this.scale}var f=0,g=0,h=0;if(this.indicator!=null||this.indicatorImageNode!=null){f=(this.style[mxConstants.STYLE_INDICATOR_SPACING]||this.indicatorSpacing)*this.scale;g=(this.style[mxConstants.STYLE_INDICATOR_WIDTH]||this.indicatorSize)*this.scale;h=(this.style[mxConstants.STYLE_INDICATOR_HEIGHT]||this.indicatorSize)*this.scale}var j=
this.style[mxConstants.STYLE_IMAGE_ALIGN],k=this.style[mxConstants.STYLE_IMAGE_VERTICAL_ALIGN],l=this.spacing*this.scale,m=Math.max(d,g),n=e+f+h,o=b?this.bounds.x:0;o+=j==mxConstants.ALIGN_RIGHT?this.bounds.width-m-l:j==mxConstants.ALIGN_CENTER?(this.bounds.width-m)/2:l;j=b?this.bounds.y:0;j+=k==mxConstants.ALIGN_BOTTOM?this.bounds.height-n-l:k==mxConstants.ALIGN_TOP?l:(this.bounds.height-n)/2;if(this.imageNode!=null)if(b){this.imageNode.setAttribute("x",o+(m-d)/2+"px");this.imageNode.setAttribute("y",
j+"px");this.imageNode.setAttribute("width",d+"px");this.imageNode.setAttribute("height",e+"px")}else{this.imageNode.style.left=o+m-d+"px";this.imageNode.style.top=j+"px";this.imageNode.style.width=d+"px";this.imageNode.style.height=e+"px"}if(this.indicator!=null){this.indicator.bounds=new mxRectangle(o+(m-g)/2,j+e+f,g,h);this.indicator.redraw()}else if(this.indicatorImageNode!=null)if(b){this.indicatorImageNode.setAttribute("x",o+(m-g)/2+"px");this.indicatorImageNode.setAttribute("y",j+e+f+"px");
this.indicatorImageNode.setAttribute("width",g+"px");this.indicatorImageNode.setAttribute("height",h+"px")}else{this.indicatorImageNode.style.left=o+(m-g)/2+"px";this.indicatorImageNode.style.top=j+e+f+"px";this.indicatorImageNode.style.width=g+"px";this.indicatorImageNode.style.height=h+"px"}};a.updateSvgShape=function(){this.crisp=!this.isRounded;mxShape.prototype.updateSvgShape.apply(this,arguments)};function mxCylinder(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}
mxCylinder.prototype=new mxShape;a=mxCylinder.prototype;a.constructor=mxCylinder;a.mixedModeHtml=false;a.preferModeHtml=false;a.maxHeight=40;a.create=function(){if(this.stroke==null)this.stroke=this.fill;return mxShape.prototype.create.apply(this,arguments)};a.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){this.configureSvgShape(this.foreground);this.foreground.setAttribute("fill","none")}else if(mxUtils.isVml(this.node)){this.configureVmlShape(this.background);this.configureVmlShape(this.foreground)}mxShape.prototype.reconfigure.apply(this)};
a.createVml=function(){var b=document.createElement("v:group");this.label=this.background=document.createElement("v:shape");this.configureVmlShape(this.background);b.appendChild(this.background);this.fill=null;this.isShadow=false;this.configureVmlShape(b);this.foreground=document.createElement("v:shape");this.configureVmlShape(this.foreground);b.appendChild(this.foreground);return b};
a.redrawVml=function(){Math.floor(this.bounds.x);Math.floor(this.bounds.y);var b=Math.floor(this.bounds.width),d=Math.floor(this.bounds.height),e=this.strokewidth*this.scale;this.node.setAttribute("coordsize",b+","+d);this.background.setAttribute("coordsize",b+","+d);this.foreground.setAttribute("coordsize",b+","+d);this.updateVmlShape(this.node);this.updateVmlShape(this.background);this.background.style.top="0px";this.background.style.left="0px";this.background.style.rotation=null;this.updateVmlShape(this.foreground);
this.foreground.style.top="0px";this.foreground.style.left="0px";this.foreground.style.rotation=null;this.background.setAttribute("strokeweight",e);this.foreground.setAttribute("strokeweight",e);b=this.createPath(false);this.background.setAttribute("path",b);b=this.createPath(true);this.foreground.setAttribute("path",b)};
a.createSvg=function(){var b=this.createSvgGroup("path");this.foreground=document.createElementNS(mxConstants.NS_SVG,"path");this.stroke!=null&&this.stroke!=mxConstants.NONE?this.foreground.setAttribute("stroke",this.stroke):this.foreground.setAttribute("stroke","none");this.foreground.setAttribute("fill","none");b.appendChild(this.foreground);return b};
a.redrawSvg=function(){var b=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",b);var d=this.createPath(false);if(d.length>0){this.innerNode.setAttribute("d",d);this.updateSvgTransform(this.innerNode,false)}else this.innerNode.removeAttribute("d");if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",b);this.shadowNode.setAttribute("d",d);this.updateSvgTransform(this.shadowNode,true)}d=this.createPath(true);if(d.length>0){this.foreground.setAttribute("stroke-width",
b);this.foreground.setAttribute("d",d);this.updateSvgTransform(this.foreground,false)}else this.foreground.removeAttribute("d")};a.redrawPath=function(b,d,e,f,g,h){d=Math.min(this.maxHeight,Math.floor(g/5));if(h){b.moveTo(0,d);b.curveTo(0,2*d,f,2*d,f,d)}else{b.moveTo(0,d);b.curveTo(0,-d/3,f,-d/3,f,d);b.lineTo(f,g-d);b.curveTo(f,g+d/3,0,g+d/3,0,g-d);b.close()}};function mxConnector(b,d,e){this.points=b;this.stroke=d||"black";this.strokewidth=e||1}mxConnector.prototype=new mxShape;a=mxConnector.prototype;
a.constructor=mxConnector;a.mixedModeHtml=false;a.preferModeHtml=false;a.configureHtmlShape=function(b){mxShape.prototype.configureHtmlShape.apply(this,arguments);b.style.borderStyle="";b.style.background=""};
a.createVml=function(){var b=document.createElement("v:shape");this.strokeNode=document.createElement("v:stroke");this.configureVmlShape(b);this.strokeNode.setAttribute("endarrow",this.endArrow);this.strokeNode.setAttribute("startarrow",this.startArrow);this.opacity!=null&&this.strokeNode.setAttribute("opacity",this.opacity+"%");b.appendChild(this.strokeNode);return b};
a.redrawVml=function(){if(this.node!=null&&this.strokeNode!=null){var b=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale,d=mxUtils.getValue(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale,e="medium",f="medium",g="medium",h="medium";if(b<6){e="narrow";f="short"}else if(b>10){e="wide";f="long"}if(d<6){g="narrow";h="short"}else if(d>10){g="wide";h="long"}this.strokeNode.setAttribute("startarrowwidth",e);this.strokeNode.setAttribute("startarrowlength",
f);this.strokeNode.setAttribute("endarrowwidth",g);this.strokeNode.setAttribute("endarrowlength",h);this.updateVmlShape(this.node)}};
a.createSvg=function(){var b=this.createSvgGroup("path"),d=this.innerNode.getAttribute("stroke");this.shadowNode!=null&&this.shadowNode.setAttribute("fill","none");if(this.startArrow!=null){this.start=document.createElementNS(mxConstants.NS_SVG,"path");b.appendChild(this.start)}if(this.endArrow!=null){this.end=document.createElementNS(mxConstants.NS_SVG,"path");b.appendChild(this.end)}this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",d);this.pipe.setAttribute("visibility",
"hidden");this.pipe.setAttribute("pointer-events","stroke");b.appendChild(this.pipe);return b};
a.redrawSvg=function(){mxShape.prototype.redrawSvg.apply(this,arguments);var b=this.strokewidth*this.scale,d=this.innerNode.getAttribute("stroke");if(this.points!=null&&this.points[0]!=null){if(this.start!=null){var e=this.points[1],f=this.points[0],g=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE);this.startOffset=this.redrawSvgMarker(this.start,this.startArrow,e,f,d,g)}if(this.end!=null){f=this.points.length;e=this.points[f-2];f=this.points[f-1];g=mxUtils.getValue(this.style,
mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);this.endOffset=this.redrawSvgMarker(this.end,this.endArrow,e,f,d,g)}}this.updateSvgShape(this.innerNode);if(this.innerNode.getAttribute("d")!=null){this.pipe.setAttribute("d",this.innerNode.getAttribute("d"));this.pipe.setAttribute("stroke-width",b+mxShape.prototype.SVG_STROKE_TOLERANCE)}this.innerNode.setAttribute("fill","none")};
a.redrawSvgMarker=function(b,d,e,f,g,h){var j=null,k=f.x-e.x,l=f.y-e.y;if(!(isNaN(k)||isNaN(l))){var m=Math.max(1,Math.sqrt(k*k+l*l));e=h*this.scale;k=k*e/m;l=l*e/m;f=f.clone();f.x-=k*this.strokewidth/(2*h);f.y-=l*this.strokewidth/(2*h);k*=0.5+this.strokewidth/2;l*=0.5+this.strokewidth/2;if(d=="classic"||d=="block"){f="M "+f.x+" "+f.y+" L "+(f.x-k-l/2)+" "+(f.y-l+k/2)+(d!="classic"?"":" L "+(f.x-k*3/4)+" "+(f.y-l*3/4))+" L "+(f.x+l/2-k)+" "+(f.y-l-k/2)+" z";b.setAttribute("d",f);j=new mxPoint(-k*
3/4,-l*3/4)}else if(d=="open"){k*=1.2;l*=1.2;f="M "+(f.x-k-l/2)+" "+(f.y-l+k/2)+" L "+(f.x-k/6)+" "+(f.y-l/6)+" L "+(f.x+l/2-k)+" "+(f.y-l-k/2)+" M "+f.x+" "+f.y;b.setAttribute("d",f);b.setAttribute("fill","none");b.setAttribute("stroke-width",this.scale*this.strokewidth);j=new mxPoint(-k/4,-l/4)}else if(d=="oval"){k*=1.2;l*=1.2;e*=1.2;f="M "+(f.x-l/2)+" "+(f.y+k/2)+" a "+e/2+" "+e/2+" 0  1,1 "+k/8+" "+l/8+" z";b.setAttribute("d",f)}else if(d=="diamond"){f="M "+(f.x+k/2)+" "+(f.y+l/2)+" L "+(f.x-
l/2)+" "+(f.y+k/2)+" L "+(f.x-k/2)+" "+(f.y-l/2)+" L "+(f.x+l/2)+" "+(f.y-k/2)+" z";b.setAttribute("d",f)}b.setAttribute("stroke",g);d!="open"?b.setAttribute("fill",g):b.setAttribute("stroke-linecap","round");if(this.opacity!=null){b.setAttribute("fill-opacity",this.opacity/100);b.setAttribute("stroke-opacity",this.opacity/100)}return j}};function mxSwimlane(b,d,e,f){this.bounds=b;this.fill=d;this.stroke=e;this.strokewidth=f||1}mxSwimlane.prototype=new mxShape;mxSwimlane.prototype.constructor=mxSwimlane;
mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;a=mxSwimlane.prototype;
a.createHtml=function(){var b=document.createElement("DIV");this.configureHtmlShape(b);b.style.background="";b.style.backgroundColor="";b.style.borderStyle="none";this.label=document.createElement("DIV");this.configureHtmlShape(this.label);b.appendChild(this.label);this.content=document.createElement("DIV");this.configureHtmlShape(this.content);this.content.style.backgroundColor="";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true))this.content.style.borderTopStyle="none";else this.content.style.borderLeftStyle=
"none";this.content.style.cursor="default";b.appendChild(this.content);var d=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(d!=null){this.separator=document.createElement("DIV");this.separator.style.borderColor=d;this.separator.style.borderLeftStyle="dashed";b.appendChild(this.separator)}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.configureHtmlShape(this.imageNode);this.imageNode.style.borderStyle="none";b.appendChild(this.imageNode)}return b};
a.reconfigure=function(){mxShape.prototype.reconfigure.apply(this,arguments);if(this.dialect==mxConstants.DIALECT_SVG){if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)?this.shadowNode.setAttribute("height",this.startSize*this.scale):this.shadowNode.setAttribute("width",this.startSize*this.scale)}}else if(!mxUtils.isVml(this.node)){this.node.style.background="";this.node.style.backgroundColor=""}};
a.redrawHtml=function(){this.updateHtmlShape(this.node);this.node.style.background="";this.node.style.backgroundColor="";this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));this.updateHtmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.startSize=Math.min(this.startSize,this.bounds.height);this.label.style.height=this.startSize*this.scale+"px";
this.updateHtmlShape(this.content);this.content.style.background="";this.content.style.backgroundColor="";var b=this.startSize*this.scale;this.content.style.top=b+"px";this.content.style.left="0px";this.content.style.height=Math.max(1,this.bounds.height-b)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.bounds.width)+"px";this.separator.style.top=Math.floor(this.startSize*this.scale)+"px";this.separator.style.width="1px";this.separator.style.height=Math.floor(this.bounds.height)+
"px";this.separator.style.borderWidth=Math.floor(this.scale)+"px"}if(this.imageNode!=null){this.imageNode.style.left=this.bounds.width-this.imageSize-4+"px";this.imageNode.style.top="0px";this.imageNode.style.width=Math.floor(this.imageSize*this.scale)+"px";this.imageNode.style.height=Math.floor(this.imageSize*this.scale)+"px"}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.label.style.width=this.startSize*this.scale+"px";this.updateHtmlShape(this.content);this.content.style.background=
"";this.content.style.backgroundColor="";b=this.startSize*this.scale;this.content.style.top="0px";this.content.style.left=b+"px";this.content.style.width=Math.max(0,this.bounds.width-b)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.startSize*this.scale)+"px";this.separator.style.top=Math.floor(this.bounds.height)+"px";this.separator.style.width=Math.floor(this.bounds.width)+"px";this.separator.style.height="1px"}if(this.imageNode!=null){this.imageNode.style.left=this.bounds.width-
this.imageSize-4+"px";this.imageNode.style.top="0px";this.imageNode.style.width=this.imageSize*this.scale+"px";this.imageNode.style.height=this.imageSize*this.scale+"px"}}};
a.createVml=function(){var b=document.createElement("v:group"),d=this.isRounded?"v:roundrect":"v:rect";this.label=document.createElement(d);this.configureVmlShape(this.label);this.isRounded&&this.label.setAttribute("arcsize","20%");this.isShadow=false;this.configureVmlShape(b);b.setAttribute("coordorigin","0,0");b.appendChild(this.label);this.content=document.createElement(d);d=this.fill;this.fill=null;this.configureVmlShape(this.content);b.style.background="";this.isRounded&&this.content.setAttribute("arcsize",
"4%");this.fill=d;this.content.style.borderBottom="0px";b.appendChild(this.content);d=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(d!=null){this.separator=document.createElement("v:shape");this.separator.setAttribute("strokecolor",d);this.separator.style.position="absolute";d=document.createElement("v:stroke");d.setAttribute("dashstyle","2 2");this.separator.appendChild(d);b.appendChild(this.separator)}if(this.image!=null){this.imageNode=document.createElement("v:image");this.imageNode.setAttribute("src",
this.image);this.configureVmlShape(this.imageNode);b.appendChild(this.imageNode)}return b};
a.redrawVml=function(){var b=Math.round(this.bounds.x),d=Math.round(this.bounds.y),e=Math.round(this.bounds.width),f=Math.round(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",e+","+f);this.updateVmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";this.label.style.rotation=null;this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));var g=Math.floor(this.startSize*this.scale);if(this.separator!=
null){this.separator.setAttribute("coordsize",e+","+f);this.separator.style.left=b+"px";this.separator.style.top=d+"px";this.separator.style.width=e+"px";this.separator.style.height=f+"px"}if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){g=Math.min(g,this.bounds.height);this.label.style.height=g+"px";this.updateVmlShape(this.content);this.content.style.background="";this.content.style.top=g+"px";this.content.style.left="0px";this.content.style.height=Math.max(0,f-g)+"px";if(this.separator!=
null){b="m "+(e-b)+" "+(g-d)+" l "+(e-b)+" "+(f-d)+" e";this.separator.setAttribute("path",b)}if(this.imageNode!=null){b=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=e-b-4+"px";this.imageNode.style.top="0px";this.imageNode.style.width=b+"px";this.imageNode.style.height=b+"px"}}else{g=Math.min(g,this.bounds.width);this.label.style.width=g+"px";this.updateVmlShape(this.content);this.content.style.background="";this.content.style.top="0px";this.content.style.left=g+"px";this.content.style.width=
Math.max(0,e-g)+"px";if(this.separator!=null){b="m "+(g-b)+" "+(f-d)+" l "+(e-b)+" "+(f-d)+" e";this.separator.setAttribute("path",b)}if(this.imageNode!=null){b=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=e-b-4+"px";this.imageNode.style.top="0px";this.imageNode.style.width=b+"px";this.imageNode.style.height=b+"px"}}this.content.style.rotation=null};
a.createSvg=function(){var b=this.createSvgGroup("rect");if(this.isRounded){this.innerNode.setAttribute("rx",10);this.innerNode.setAttribute("ry",10)}this.content=document.createElementNS(mxConstants.NS_SVG,"path");this.configureSvgShape(this.content);this.content.setAttribute("fill","none");if(this.isRounded){this.content.setAttribute("rx",10);this.content.setAttribute("ry",10)}b.appendChild(this.content);var d=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(d!=null){this.separator=document.createElementNS(mxConstants.NS_SVG,
"line");this.separator.setAttribute("stroke",d);this.separator.setAttribute("fill","none");this.separator.setAttribute("stroke-dasharray","2, 2");b.appendChild(this.separator)}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.configureSvgShape(this.imageNode);b.appendChild(this.imageNode)}return b};
a.redrawSvg=function(){this.crisp=!this.isRounded;var b=this.isRounded;this.isRounded=false;this.updateSvgShape(this.innerNode);this.updateSvgShape(this.content);var d=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);d?this.shadowNode.setAttribute("height",this.startSize*this.scale):this.shadowNode.setAttribute("width",this.startSize*this.scale)}this.isRounded=b;this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,
mxConstants.DEFAULT_STARTSIZE));if(d){this.startSize=Math.min(this.startSize,this.bounds.height);this.innerNode.setAttribute("height",this.startSize*this.scale);b=this.startSize*this.scale;b="M "+this.bounds.x+" "+(this.bounds.y+b)+" l 0 "+(this.bounds.height-b)+" l "+this.bounds.width+" 0 l 0 "+(-this.bounds.height+b);this.content.setAttribute("d",b);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=
null){this.separator.setAttribute("x1",this.bounds.x+this.bounds.width);this.separator.setAttribute("y1",this.bounds.y+this.startSize*this.scale);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",this.bounds.y+this.bounds.height)}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.innerNode.setAttribute("width",this.startSize*this.scale);b=this.startSize*this.scale;b="M "+(this.bounds.x+b)+" "+this.bounds.y+" l "+(this.bounds.width-
b)+" 0 l 0 "+this.bounds.height+" l "+(-this.bounds.width+b)+" 0";this.content.setAttribute("d",b);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=null){this.separator.setAttribute("x1",this.bounds.x+this.startSize*this.scale);this.separator.setAttribute("y1",this.bounds.y+this.bounds.height);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",
this.bounds.y+this.bounds.height)}}if(this.imageNode!=null){this.imageNode.setAttribute("x",this.bounds.x+this.bounds.width-this.imageSize-4);this.imageNode.setAttribute("y",this.bounds.y);this.imageNode.setAttribute("width",this.imageSize*this.scale+"px");this.imageNode.setAttribute("height",this.imageSize*this.scale+"px")}};function mxGraphLayout(b){this.graph=b}a=mxGraphLayout.prototype;a.graph=null;a.useBoundingBox=true;a.moveCell=function(){};a.execute=function(){};a.getGraph=function(){return this.graph};
a.getConstraint=function(b,d){var e=this.graph.view.getState(d);d=e!=null?e.style:this.graph.getCellStyle(d);return d!=null?d[b]:null};a.isVertexMovable=function(b){return this.graph.isCellMovable(b)};a.isVertexIgnored=function(b){return!this.graph.getModel().isVertex(b)||!this.graph.isCellVisible(b)};a.isEdgeIgnored=function(b){var d=this.graph.getModel();return!d.isEdge(b)||!this.graph.isCellVisible(b)||d.getTerminal(b,true)==null||d.getTerminal(b,false)==null};
a.setEdgeStyleEnabled=function(b,d){this.graph.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,d?"0":"1",[b])};a.setEdgePoints=function(b,d){if(b!=null){var e=this.graph.model,f=e.getGeometry(b);if(f==null){f=new mxGeometry;f.setRelative(true)}else f=f.clone();f.points=d;e.setGeometry(b,f)}};
a.setVertexLocation=function(b,d,e){var f=this.graph.getModel(),g=f.getGeometry(b),h=null;if(g!=null){h=new mxRectangle(d,e,g.width,g.height);if(this.useBoundingBox){var j=this.graph.getView().getState(b);if(j!=null&&j.text!=null&&j.text.boundingBox!=null){var k=this.graph.getView().scale,l=j.text.boundingBox;if(j.text.boundingBox.x<j.x){d+=(j.x-l.x)/k;h.width=l.width}if(j.text.boundingBox.y<j.y){e+=(j.y-l.y)/k;h.height=l.height}}}if(g.x!=d||g.y!=e){g=g.clone();g.x=d;g.y=e;f.setGeometry(b,g)}}return h};
a.getVertexBounds=function(b){var d=this.graph.getModel().getGeometry(b);if(this.useBoundingBox){var e=this.graph.getView().getState(b);if(e!=null&&e.text!=null&&e.text.boundingBox!=null){var f=this.graph.getView().scale,g=e.text.boundingBox;b=Math.max(e.x-g.x,0)/f;var h=Math.max(e.y-g.y,0)/f,j=Math.max(g.x+g.width-(e.x+e.width),0)/f;e=Math.max(g.y+g.height-(e.y+e.height),0)/f;d=new mxRectangle(d.x-b,d.y-h,d.width+b+j,d.height+h+e)}}return new mxRectangle(d.x,d.y,d.width,d.height)};
function mxStackLayout(b,d,e,f,g,h){mxGraphLayout.call(this,b);this.horizontal=d!=null?d:true;this.spacing=e!=null?e:0;this.x0=f!=null?f:0;this.y0=g!=null?g:0;this.border=h!=null?h:0}mxStackLayout.prototype=new mxGraphLayout;a=mxStackLayout.prototype;a.constructor=mxStackLayout;a.horizontal=null;a.spacing=null;a.x0=null;a.y0=null;a.border=0;a.keepFirstLocation=false;a.fill=false;a.resizeParent=false;a.wrap=null;a.isHorizontal=function(){return this.horizontal};
a.moveCell=function(b,d,e){var f=this.graph.getModel(),g=f.getParent(b),h=this.isHorizontal();if(b!=null&&g!=null){var j=0,k=0,l=f.getChildCount(g);d=h?d:e;j=this.graph.getView().getState(g);if(j!=null)d-=h?j.x:j.y;for(j=0;j<l;j++){e=f.getChildAt(g,j);if(e!=b){e=f.getGeometry(e);if(e!=null){e=h?e.x+e.width/2:e.y+e.height/2;if(k<d&&e>d)break;k=e}}}h=g.getIndex(b);h=Math.max(0,j-(j>h?1:0));f.add(g,b,h)}};
a.getParentSize=function(b){var d=this.graph.getModel(),e=d.getGeometry(b);if(this.graph.container!=null&&(e==null&&d.isLayer(b)||b==this.graph.getView().currentRoot))e=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1);return e};
a.execute=function(b){if(b!=null){var d=this.isHorizontal(),e=this.graph.getModel(),f=this.getParentSize(b),g=0;if(f!=null)g=d?f.height:f.width;g-=2*this.spacing+2*this.border;var h=this.graph.isSwimlane(b)?this.graph.getStartSize(b):new mxRectangle;g-=d?h.height:h.width;var j=this.x0+h.width+this.border;h=this.y0+h.height+this.border;e.beginUpdate();try{for(var k=0,l=null,m=e.getChildCount(b),n=0;n<m;n++){var o=e.getChildAt(b,n);if(!this.isVertexIgnored(o)&&this.isVertexMovable(o)){var p=e.getGeometry(o);
if(p!=null){p=p.clone();if(this.wrap!=null&&l!=null)if(d&&l.x+l.width+p.width+2*this.spacing>this.wrap||!d&&l.y+l.height+p.height+2*this.spacing>this.wrap){l=null;if(d)h+=k+this.spacing;else j+=k+this.spacing;k=0}k=Math.max(k,d?p.height:p.width);if(l!=null)if(d)p.x=l.x+l.width+this.spacing;else p.y=l.y+l.height+this.spacing;else if(!this.keepFirstLocation)if(d)p.x=j;else p.y=h;if(d)p.y=h;else p.x=j;if(this.fill&&g>0)if(d)p.height=g;else p.width=g;e.setGeometry(o,p);l=p}}}if(this.resizeParent&&f!=
null&&l!=null&&!this.graph.isCellCollapsed(b)){f=f.clone();if(d)f.width=l.x+l.width+this.spacing;else f.height=l.y+l.height+this.spacing;e.setGeometry(b,f)}}finally{e.endUpdate()}}};function mxPartitionLayout(b,d,e,f){mxGraphLayout.call(this,b);this.horizontal=d!=null?d:true;this.spacing=e||0;this.border=f||0}mxPartitionLayout.prototype=new mxGraphLayout;a=mxPartitionLayout.prototype;a.constructor=mxPartitionLayout;a.horizontal=null;a.spacing=null;a.border=null;a.resizeVertices=true;
a.isHorizontal=function(){return this.horizontal};a.moveCell=function(b,d){var e=this.graph.getModel(),f=e.getParent(b);if(b!=null&&f!=null){var g=0,h=0,j=e.getChildCount(f);for(g=0;g<j;g++){var k=this.getVertexBounds(e.getChildAt(f,g));if(k!=null){k=k.x+k.width/2;if(h<d&&k>d)break;h=k}}d=f.getIndex(b);d=Math.max(0,g-(g>d?1:0));e.add(f,b,d)}};
a.execute=function(b){var d=this.isHorizontal(),e=this.graph.getModel(),f=e.getGeometry(b);if(this.graph.container!=null&&(f==null&&e.isLayer(b)||b==this.graph.getView().currentRoot))f=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1);if(f!=null){for(var g=[],h=e.getChildCount(b),j=0;j<h;j++){var k=e.getChildAt(b,j);!this.isVertexIgnored(k)&&this.isVertexMovable(k)&&g.push(k)}h=g.length;if(h>0){var l=this.border,m=this.border,n=d?f.height:f.width;n-=2*this.border;
b=this.graph.isSwimlane(b)?this.graph.getStartSize(b):new mxRectangle;n-=d?b.height:b.width;l+=b.width;m+=b.height;b=this.border+(h-1)*this.spacing;f=d?(f.width-l-b)/h:(f.height-m-b)/h;if(f>0){e.beginUpdate();try{for(j=0;j<h;j++){k=g[j];var o=e.getGeometry(k);if(o!=null){o=o.clone();o.x=l;o.y=m;if(d){if(this.resizeVertices){o.width=f;o.height=n}l+=f+this.spacing}else{if(this.resizeVertices){o.height=f;o.width=n}m+=f+this.spacing}e.setGeometry(k,o)}}}finally{e.endUpdate()}}}}};
function mxCompactTreeLayout(b,d,e){mxGraphLayout.call(this,b);this.horizontal=d!=null?d:true;this.invert=e!=null?e:false}mxCompactTreeLayout.prototype=new mxGraphLayout;a=mxCompactTreeLayout.prototype;a.constructor=mxCompactTreeLayout;a.horizontal=null;a.invert=null;a.resizeParent=true;a.moveTree=true;a.levelDistance=10;a.nodeDistance=20;a.resetEdges=true;a.isVertexIgnored=function(b){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(b).length==0};
a.isHorizontal=function(){return this.horizontal};
a.execute=function(b,d){var e=this.graph.getModel();if(d==null)if(this.graph.getEdges(b,e.getParent(b),this.invert,!this.invert,false).length>0)d=b;else{b=this.graph.findTreeRoots(b,true,this.invert);if(b.length>0)for(var f=0;f<b.length;f++)if(!this.isVertexIgnored(b[f])&&this.graph.getEdges(b[f],null,this.invert,!this.invert,false).length>0){d=b[f];break}}if(d!=null){b=e.getParent(d);e.beginUpdate();try{var g=this.dfs(d,b);if(g!=null){this.layout(g);var h=this.graph.gridSize;f=h;if(!this.moveTree||
e.isLayer(b)){var j=e.getGeometry(d);if(j!=null){h=j.x;f=j.y}}d=null;d=this.isHorizontal()?this.horizontalLayout(g,h,f):this.verticalLayout(g,null,h,f);if(d!=null){var k=0,l=0;if(d.x<0)k=Math.abs(h-d.x);if(d.y<0)l=Math.abs(f-d.y);if(b!=null){var m=this.graph.isSwimlane(b)?this.graph.getStartSize(b):new mxRectangle;k+=m.width;l+=m.height;if(this.resizeParent&&!this.graph.isCellCollapsed(b)){j=e.getGeometry(b);if(j!=null){var n=d.width+m.width-d.x+2*h,o=d.height+m.height-d.y+2*f;j=j.clone();if(j.width>
n)k+=(j.width-n)/2;else j.width=n;if(j.height>o){if(this.isHorizontal())l+=(j.height-o)/2}else j.height=o;e.setGeometry(b,j)}}}this.moveNode(g,k,l)}}}finally{e.endUpdate()}}};a.moveNode=function(b,d,e){b.x+=d;b.y+=e;this.apply(b);for(b=b.child;b!=null;){this.moveNode(b,d,e);b=b.next}};
a.dfs=function(b,d,e){e=e!=null?e:[];var f=mxCellPath.create(b),g=null;if(b!=null&&e[f]==null&&!this.isVertexIgnored(b)){e[f]=b;g=this.createNode(b);f=this.graph.getModel();var h=null;b=this.graph.getEdges(b,d,this.invert,!this.invert,false);for(var j=0;j<b.length;j++){var k=b[j];if(!this.isEdgeIgnored(k)){this.resetEdges&&this.setEdgePoints(k,null);k=this.graph.getView().getVisibleTerminal(k,this.invert);var l=this.dfs(k,d,e);if(l!=null&&f.getGeometry(k)!=null){if(h==null)g.child=l;else h.next=l;
h=l}}}}return g};a.layout=function(b){if(b!=null){for(var d=b.child;d!=null;){this.layout(d);d=d.next}b.child!=null?this.attachParent(b,this.join(b)):this.layoutLeaf(b)}};a.horizontalLayout=function(b,d,e,f){b.x+=d+b.offsetX;b.y+=e+b.offsetY;f=this.apply(b,f);d=b.child;if(d!=null){f=this.horizontalLayout(d,b.x,b.y,f);e=b.y+d.offsetY;for(var g=d.next;g!=null;){f=this.horizontalLayout(g,b.x+d.offsetX,e,f);e+=g.offsetY;g=g.next}}return f};
a.verticalLayout=function(b,d,e,f,g){b.x+=e+b.offsetY;b.y+=f+b.offsetX;g=this.apply(b,g);d=b.child;if(d!=null){g=this.verticalLayout(d,b,b.x,b.y,g);e=b.x+d.offsetY;for(f=d.next;f!=null;){g=this.verticalLayout(f,b,e,b.y+d.offsetX,g);e+=f.offsetY;f=f.next}}return g};
a.attachParent=function(b,d){var e=this.nodeDistance+this.levelDistance,f=(d-b.width)/2-this.nodeDistance;d=f+b.width+2*this.nodeDistance-d;b.child.offsetX=e+b.height;b.child.offsetY=d;b.contour.upperHead=this.createLine(b.height,0,this.createLine(e,d,b.contour.upperHead));b.contour.lowerHead=this.createLine(b.height,0,this.createLine(e,f,b.contour.lowerHead))};
a.layoutLeaf=function(b){var d=2*this.nodeDistance;b.contour.upperTail=this.createLine(b.height+d,0);b.contour.upperHead=b.contour.upperTail;b.contour.lowerTail=this.createLine(0,-b.width-d);b.contour.lowerHead=this.createLine(b.height+d,0,b.contour.lowerTail)};a.join=function(b){var d=2*this.nodeDistance,e=b.child;b.contour=e.contour;var f=e.width+d,g=f;for(e=e.next;e!=null;){var h=this.merge(b.contour,e.contour);e.offsetY=h+f;e.offsetX=0;f=e.width+d;g+=h+f;e=e.next}return g};
a.merge=function(b,d){for(var e=0,f=0,g=0,h=b.lowerHead,j=d.upperHead;j!=null&&h!=null;){var k=this.offset(e,f,j.dx,j.dy,h.dx,h.dy);f+=k;g+=k;if(e+j.dx<=h.dx){e+=j.dx;f+=j.dy;j=j.next}else{e-=h.dx;f-=h.dy;h=h.next}}if(j!=null){e=this.bridge(b.upperTail,0,0,j,e,f);b.upperTail=e.next!=null?d.upperTail:e;b.lowerTail=d.lowerTail}else{e=this.bridge(d.lowerTail,e,f,h,0,0);if(e.next==null)b.lowerTail=e}b.lowerHead=d.lowerHead;return g};
a.offset=function(b,d,e,f,g,h){var j=0;if(g<=b||b+e<=0)return 0;if(g*f-e*h>0)if(b<0){b=b*f;j=b/e-d}else if(b>0){b=b*h;j=b/g-d}else j=-d;else if(g<b+e){b=(g-b)*f;j=h-(d+b/e)}else if(g>b+e){b=(e+b)*h;j=b/g-(d+f)}else j=h-(d+f);return j>0?j:0};a.bridge=function(b,d,e,f,g,h){d=g+f.dx-d;g=g=0;if(f.dx==0)g=f.dy;else{g=d*f.dy;g=g/f.dx}d=this.createLine(d,g,f.next);b.next=this.createLine(0,h+f.dy-g-e,d);return d};
a.createNode=function(b){var d={};d.cell=b;d.x=0;d.y=0;d.width=0;d.height=0;b=this.getVertexBounds(b);if(b!=null)if(this.isHorizontal()){d.width=b.height;d.height=b.width}else{d.width=b.width;d.height=b.height}d.offsetX=0;d.offsetY=0;d.contour={};return d};
a.apply=function(b,d){var e=this.graph.getModel().getGeometry(b.cell);if(b.cell!=null&&e!=null){if(this.isVertexMovable(b.cell))e=this.setVertexLocation(b.cell,b.x,b.y);d=d==null?new mxRectangle(e.x,e.y,e.width,e.height):new mxRectangle(Math.min(d.x,e.x),Math.min(d.y,e.y),Math.max(d.x+d.width,e.x+e.width),Math.max(d.y+d.height,e.y+e.height))}return d};a.createLine=function(b,d,e){var f={};f.dx=b;f.dy=d;f.next=e;return f};function mxFastOrganicLayout(b){mxGraphLayout.call(this,b)}
mxFastOrganicLayout.prototype=new mxGraphLayout;a=mxFastOrganicLayout.prototype;a.constructor=mxFastOrganicLayout;a.useInputOrigin=true;a.resetEdges=true;a.disableEdgeStyle=true;a.forceConstant=50;a.forceConstantSquared=0;a.minDistanceLimit=2;a.minDistanceLimitSquared=4;a.initialTemp=200;a.temperature=0;a.maxIterations=0;a.iteration=0;a.allowedToRun=true;a.isVertexIgnored=function(b){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(b).length==0};
a.execute=function(b){var d=this.graph.getModel();this.vertexArray=[];for(var e=this.graph.getChildVertices(b),f=0;f<e.length;f++)this.isVertexIgnored(e[f])||this.vertexArray.push(e[f]);var g=this.useInputOrigin?this.graph.view.getBounds(this.vertexArray):null,h=this.vertexArray.length;this.indices=[];this.dispX=[];this.dispY=[];this.cellLocation=[];this.isMoveable=[];this.neighbours=[];this.radius=[];this.radiusSquared=[];if(this.forceConstant<0.0010)this.forceConstant=0.0010;this.forceConstantSquared=
this.forceConstant*this.forceConstant;for(f=0;f<this.vertexArray.length;f++){var j=this.vertexArray[f];this.cellLocation[f]=[];var k=mxCellPath.create(j);this.indices[k]=f;var l=this.getVertexBounds(j),m=l.width,n=l.height,o=l.x,p=l.y;this.cellLocation[f][0]=o+m/2;this.cellLocation[f][1]=p+n/2;this.radius[f]=Math.min(m,n);this.radiusSquared[f]=this.radius[f]*this.radius[f]}d.beginUpdate();try{for(f=0;f<h;f++){this.dispX[f]=0;this.dispY[f]=0;this.isMoveable[f]=this.isVertexMovable(this.vertexArray[f]);
var q=this.graph.getConnections(this.vertexArray[f],b);e=this.graph.getOpposites(q,this.vertexArray[f]);this.neighbours[f]=[];for(m=0;m<e.length;m++){this.resetEdges&&this.graph.resetEdge(q[m]);this.disableEdgeStyle&&this.setEdgeStyleEnabled(q[m],false);k=mxCellPath.create(e[m]);var r=this.indices[k];this.neighbours[f][m]=r!=null?r:f}}this.temperature=this.initialTemp;if(this.maxIterations==0)this.maxIterations=20*Math.sqrt(h);for(this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun)return;
this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature()}b=e=null;for(f=0;f<this.vertexArray.length;f++){j=this.vertexArray[f];if(this.isVertexMovable(j)){l=this.getVertexBounds(j);if(l!=null){this.cellLocation[f][0]-=l.width/2;this.cellLocation[f][1]-=l.height/2;o=this.graph.snap(this.cellLocation[f][0]);p=this.graph.snap(this.cellLocation[f][1]);this.setVertexLocation(j,o,p);e=e==null?o:Math.min(e,o);b=b==null?p:Math.min(b,p)}}}f=-(e||0)+1;j=-(b||0)+1;if(g!=null){f+=
g.x;j+=g.y}this.graph.moveCells(this.vertexArray,f,j)}finally{d.endUpdate()}};a.calcPositions=function(){for(var b=0;b<this.vertexArray.length;b++)if(this.isMoveable[b]){var d=Math.sqrt(this.dispX[b]*this.dispX[b]+this.dispY[b]*this.dispY[b]);if(d<0.0010)d=0.0010;var e=this.dispX[b]/d*Math.min(d,this.temperature);d=this.dispY[b]/d*Math.min(d,this.temperature);this.dispX[b]=0;this.dispY[b]=0;this.cellLocation[b][0]+=e;this.cellLocation[b][1]+=d}};
a.calcAttraction=function(){for(var b=0;b<this.vertexArray.length;b++)for(var d=0;d<this.neighbours[b].length;d++){var e=this.neighbours[b][d];if(b!=e&&this.isMoveable[b]&&this.isMoveable[e]){var f=this.cellLocation[b][0]-this.cellLocation[e][0],g=this.cellLocation[b][1]-this.cellLocation[e][1],h=f*f+g*g-this.radiusSquared[b]-this.radiusSquared[e];if(h<this.minDistanceLimitSquared)h=this.minDistanceLimitSquared;var j=Math.sqrt(h);h=h/this.forceConstant;f=f/j*h;g=g/j*h;this.dispX[b]-=f;this.dispY[b]-=
g;this.dispX[e]+=f;this.dispY[e]+=g}}};
a.calcRepulsion=function(){for(var b=this.vertexArray.length,d=0;d<b;d++)for(var e=d;e<b;e++){if(!this.allowedToRun)return;if(e!=d&&this.isMoveable[d]&&this.isMoveable[e]){var f=this.cellLocation[d][0]-this.cellLocation[e][0],g=this.cellLocation[d][1]-this.cellLocation[e][1];if(f==0)f=0.01+Math.random();if(g==0)g=0.01+Math.random();var h=Math.sqrt(f*f+g*g),j=h-this.radius[d]-this.radius[e];if(j<this.minDistanceLimit)j=this.minDistanceLimit;j=this.forceConstantSquared/j;f=f/h*j;g=g/h*j;this.dispX[d]+=
f;this.dispY[d]+=g;this.dispX[e]-=f;this.dispY[e]-=g}}};a.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)};function mxCircleLayout(b,d){mxGraphLayout.call(this,b);this.radius=d!=null?d:100}mxCircleLayout.prototype=new mxGraphLayout;a=mxCircleLayout.prototype;a.constructor=mxCircleLayout;a.radius=null;a.moveCircle=false;a.x0=0;a.y0=0;a.resetEdges=true;a.disableEdgeStyle=true;
a.execute=function(b){var d=this.graph.getModel();d.beginUpdate();try{for(var e=0,f=null,g=null,h=[],j=d.getChildCount(b),k=0;k<j;k++){var l=d.getChildAt(b,k);if(this.isVertexIgnored(l)){if(!this.isEdgeIgnored(l)){this.resetEdges&&this.graph.resetEdge(l);this.disableEdgeStyle&&this.setEdgeStyleEnabled(l,false)}}else{h.push(l);var m=this.getVertexBounds(l);f=f==null?m.y:Math.min(f,m.y);g=g==null?m.x:Math.min(g,m.x);e=Math.max(e,Math.max(m.width,m.height))}}var n=Math.max(h.length*e/Math.PI,this.radius);
if(this.moveCircle){f=this.x0;g=this.y0}this.circle(h,n,g,f)}finally{d.endUpdate()}};a.circle=function(b,d,e,f){for(var g=b.length,h=2*Math.PI/g,j=0;j<g;j++)this.isVertexMovable(b[j])&&this.setVertexLocation(b[j],e+d+d*Math.sin(j*h),f+d+d*Math.cos(j*h))};function mxParallelEdgeLayout(b){mxGraphLayout.call(this,b)}mxParallelEdgeLayout.prototype=new mxGraphLayout;a=mxParallelEdgeLayout.prototype;a.constructor=mxParallelEdgeLayout;a.spacing=20;
a.execute=function(b){b=this.findParallels(b);this.graph.model.beginUpdate();try{for(var d in b){var e=b[d];e.length>1&&this.layout(e)}}finally{this.graph.model.endUpdate()}};a.findParallels=function(b){this.graph.getView();for(var d=this.graph.getModel(),e=[],f=d.getChildCount(b),g=0;g<f;g++){var h=d.getChildAt(b,g);if(!this.isEdgeIgnored(h)){var j=this.getEdgeId(h);if(j!=null){if(e[j]==null)e[j]=[];e[j].push(h)}}}return e};
a.getEdgeId=function(b){var d=this.graph.getView(),e=d.getVisibleTerminal(b,true);b=d.getVisibleTerminal(b,false);if(e!=null&&b!=null){e=mxCellPath.create(e);b=mxCellPath.create(b);return e>b?b+"-"+e:e+"-"+b}return null};
a.layout=function(b){var d=b[0];this.graph.getView();var e=this.graph.getModel(),f=e.getGeometry(e.getTerminal(d,true)),g=e.getGeometry(e.getTerminal(d,false));if(f==g){d=f.x+f.width+this.spacing;e=f.y+f.height/2;for(f=0;f<b.length;f++){this.route(b[f],d,e);d+=this.spacing}}else if(f!=null&&g!=null){d=f.x+f.width/2;e=f.y+f.height/2;f=g.x+g.width/2-d;var h=g.y+g.height/2-e;g=Math.sqrt(f*f+h*h);d=d+f/2;e=e+h/2;h=h*this.spacing/g;g=f*this.spacing/g;d+=h*(b.length-1)/2;e-=g*(b.length-1)/2;for(f=0;f<b.length;f++){this.route(b[f],
d,e);d-=h;e+=g}}};a.route=function(b,d,e){this.graph.isCellMovable(b)&&this.setEdgePoints(b,[new mxPoint(d,e)])};function mxCompositeLayout(b,d,e){mxGraphLayout.call(this,b);this.layouts=d;this.master=e}mxCompositeLayout.prototype=new mxGraphLayout;a=mxCompositeLayout.prototype;a.constructor=mxCompositeLayout;a.layouts=null;a.master=null;a.moveCell=function(){this.master!=null?this.master.move.apply(this.master,arguments):this.layouts[0].move.apply(this.layouts[0],arguments)};
a.execute=function(){var b=this.graph.getModel();b.beginUpdate();try{for(var d=0;d<this.layouts.length;d++)this.layouts[d].execute.apply(this.layouts[d],arguments)}finally{b.endUpdate()}};function mxEdgeLabelLayout(b){mxGraphLayout.call(this,b)}mxEdgeLabelLayout.prototype=new mxGraphLayout;mxEdgeLabelLayout.prototype.constructor=mxEdgeLabelLayout;
mxEdgeLabelLayout.prototype.execute=function(b){for(var d=this.graph.view,e=this.graph.getModel(),f=[],g=[],h=e.getChildCount(b),j=0;j<h;j++){var k=e.getChildAt(b,j),l=d.getState(k);if(l!=null)if(this.isVertexIgnored(k))this.isEdgeIgnored(k)||f.push(l);else g.push(l)}this.placeLabels(g,f)};
mxEdgeLabelLayout.prototype.placeLabels=function(b,d){var e=this.graph.getModel();e.beginUpdate();try{for(var f=0;f<d.length;f++){var g=d[f];if(g!=null&&g.text!=null&&g.text.boundingBox!=null)for(var h=0;h<b.length;h++){var j=b[h];j!=null&&this.avoid(g,j)}}}finally{e.endUpdate()}};
mxEdgeLabelLayout.prototype.avoid=function(b,d){var e=this.graph.getModel(),f=b.text.boundingBox;if(mxUtils.intersects(f,d)){var g=-f.y-f.height+d.y,h=-f.y+d.y+d.height;g=Math.abs(g)<Math.abs(h)?g:h;h=-f.x-f.width+d.x;d=-f.x+d.x+d.width;d=Math.abs(h)<Math.abs(d)?h:d;if(Math.abs(d)<Math.abs(g))g=0;else d=0;f=e.getGeometry(b.cell);if(f!=null){f=f.clone();if(f.offset!=null){f.offset.x+=d;f.offset.y+=g}else f.offset=new mxPoint(d,g);e.setGeometry(b.cell,f)}}};
function mxGraphAbstractHierarchyCell(){this.x=[];this.y=[];this.temp=[]}a=mxGraphAbstractHierarchyCell.prototype;a.maxRank=-1;a.minRank=-1;a.x=null;a.y=null;a.width=0;a.height=0;a.nextLayerConnectedCells=null;a.previousLayerConnectedCells=null;a.temp=null;a.getNextLayerConnectedCells=function(){return null};a.getPreviousLayerConnectedCells=function(){return null};a.isEdge=function(){return false};a.isVertex=function(){return false};a.getGeneralPurposeVariable=function(){return null};
a.setGeneralPurposeVariable=function(){return null};a.setX=function(b,d){if(this.isVertex())this.x[0]=d;else if(this.isEdge())this.x[b-this.minRank-1]=d};a.getX=function(b){if(this.isVertex())return this.x[0];else if(this.isEdge())return this.x[b-this.minRank-1];return 0};a.setY=function(b,d){if(this.isVertex())this.y[0]=d;else if(this.isEdge())this.y[b-this.minRank-1]=d};function mxGraphHierarchyNode(b){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=b}
mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell;a=mxGraphHierarchyNode.prototype;a.constructor=mxGraphHierarchyNode;a.cell=null;a.connectsAsTarget=[];a.connectsAsSource=[];a.hashCode=false;a.getRankValue=function(){return this.maxRank};
a.getNextLayerConnectedCells=function(b){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];this.nextLayerConnectedCells[0]=[];for(var d=0;d<this.connectsAsTarget.length;d++){var e=this.connectsAsTarget[d];e.maxRank==-1||e.maxRank==b+1?this.nextLayerConnectedCells[0].push(e.source):this.nextLayerConnectedCells[0].push(e)}}return this.nextLayerConnectedCells[0]};
a.getPreviousLayerConnectedCells=function(b){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];this.previousLayerConnectedCells[0]=[];for(var d=0;d<this.connectsAsSource.length;d++){var e=this.connectsAsSource[d];e.minRank==-1||e.minRank==b-1?this.previousLayerConnectedCells[0].push(e.target):this.previousLayerConnectedCells[0].push(e)}}return this.previousLayerConnectedCells[0]};a.isVertex=function(){return true};a.getGeneralPurposeVariable=function(){return this.temp[0]};
a.setGeneralPurposeVariable=function(b,d){this.temp[0]=d};a.isAncestor=function(b){if(b!=null&&this.hashCode!=null&&b.hashCode!=null&&this.hashCode.length<b.hashCode.length){if(this.hashCode==b.hashCode)return true;if(this.hashCode==null||this.hashCode==null)return false;for(var d=0;d<this.hashCode.length;d++)if(this.hashCode[d]!=b.hashCode[d])return false;return true}return false};function mxGraphHierarchyEdge(b){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=b}
mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell;a=mxGraphHierarchyEdge.prototype;a.constructor=mxGraphHierarchyEdge;a.edges=null;a.source=null;a.target=null;a.isReversed=false;a.invert=function(){var b=this.source;this.source=this.target;this.target=b;this.isReversed=!this.isReversed};
a.getNextLayerConnectedCells=function(b){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];for(var d=0;d<this.temp.length;d++){this.nextLayerConnectedCells[d]=[];d==this.nextLayerConnectedCells.length-1?this.nextLayerConnectedCells[d].push(this.source):this.nextLayerConnectedCells[d].push(this)}}return this.nextLayerConnectedCells[b-this.minRank-1]};
a.getPreviousLayerConnectedCells=function(b){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];for(var d=0;d<this.temp.length;d++){this.previousLayerConnectedCells[d]=[];d==0?this.previousLayerConnectedCells[d].push(this.target):this.previousLayerConnectedCells[d].push(this)}}return this.previousLayerConnectedCells[b-this.minRank-1]};a.isEdge=function(){return true};a.getGeneralPurposeVariable=function(b){return this.temp[b-this.minRank-1]};
a.setGeneralPurposeVariable=function(b,d){this.temp[b-this.minRank-1]=d};
function mxGraphHierarchyModel(b,d,e,f,g,h,j,k){var l=b.getGraph();this.deterministic=h;this.tightenToSource=j;this.scanRanksFromSinks=k;this.roots=e;this.parent=f;this.vertexMapper={};this.edgeMapper={};this.maxRank=0;e=[];if(d==null)d=this.graph.getChildVertices(f);if(g)this.formOrderedHierarchy(b,d,f);else{this.maxRank=this.scanRanksFromSinks?0:this.SOURCESCANSTARTRANK;this.createInternalCells(b,d,e);for(b=0;b<d.length;b++){f=e[b].connectsAsSource;for(g=0;g<f.length;g++){h=f[g];j=h.edges;for(k=
0;k<j.length;k++){var m=j[k];m=l.getView().getVisibleTerminal(m,false);m=this.vertexMapper[mxCellPath.create(m)];if(m!=null&&e[b]!=m){h.target=m;if(m.connectsAsTarget.length==0)m.connectsAsTarget=[];mxUtils.indexOf(m.connectsAsTarget,h)<0&&m.connectsAsTarget.push(h)}}}e[b].temp[0]=1}}}a=mxGraphHierarchyModel.prototype;a.scanRanksFromSinks=true;a.maxRank=null;a.vertexMapper=null;a.edgeMapper=null;a.ranks=null;a.roots=null;a.parent=null;a.dfsCount=0;a.SOURCESCANSTARTRANK=1E8;a.tightenToSource=false;
a.formOrderedHierarchy=function(b,d){b.getGraph();this.createInternalCells(b,d,internalVertices);b=[];for(var e=0;e<d.length;e++){for(var f=internalVertices[e].connectsAsSource,g=0;g<f.length;g++)for(var h=f[g],j=h.edges,k=0;k<j.length;k++){var l=j[k];l=this.graph.getView().getVisibleTerminal(l,false);l=mxCellPath.create(l);l=vertexMapper[l];if(l!=null&&internalVertices[e]!=l){h.target=l;if(l.connectsAsTarget.length==0)l.connectsAsTarget=[];if(l.temp[0]==1){h.invert();l.connectsAsSource.push(h);b.push(h);
mxUtils.indexOf(internalVertices[e].connectsAsTarget,h)<0&&internalVertices[e].connectsAsTarget.push(h)}else mxUtils.indexOf(l.connectsAsTarget,h)<0&&l.connectsAsTarget.push(h)}}for(g=0;g<b.length;g++)mxUtils.remove(b[g],internalVertices[e].connectsAsSource);b=[];internalVertices[e].temp[0]=1}};
a.createInternalCells=function(b,d,e){for(var f=b.getGraph(),g=0;g<d.length;g++){e[g]=new mxGraphHierarchyNode(d[g]);this.vertexMapper[mxCellPath.create(d[g])]=e[g];var h=f.getConnections(d[g],this.parent);h=f.getOpposites(h,d[g]);e[g].connectsAsSource=[];for(var j=0;j<h.length;j++){var k=h[j];if(k!=d[g]&&!b.isVertexIgnored(k)){k=f.getEdgesBetween(d[g],k,true);if(k!=null&&k.length>0){for(var l=new mxGraphHierarchyEdge(k),m=0;m<k.length;m++){var n=k[m];this.edgeMapper[mxCellPath.create(n)]=l;f.resetEdge(n);
b.disableEdgeStyle&&b.setEdgeStyleEnabled(n,false)}l.source=e[g];mxUtils.indexOf(e[g].connectsAsSource,l)<0&&e[g].connectsAsSource.push(l)}}}e[g].temp[0]=0}};
a.initialRank=function(){var b=[];if(!this.scanRanksFromSinks&&this.roots!=null)for(var d=0;d<this.roots.length;d++){var e=this.vertexMapper[mxCellPath.create(this.roots[d])];e!=null&&b.push(e)}if(this.scanRanksFromSinks)for(var f in this.vertexMapper){e=this.vertexMapper[f];if(e.connectsAsSource==null||e.connectsAsSource.length==0)b.push(e)}if(b.length==0)for(f in this.vertexMapper){e=this.vertexMapper[f];if(e.connectsAsTarget==null||e.connectsAsTarget.length==0){b.push(e);this.scanRanksFromSinks=
false;this.maxRank=this.SOURCESCANSTARTRANK}}for(f in this.vertexMapper){e=this.vertexMapper[f];e.temp[0]=-1}for(var g=b.slice();b.length>0;){e=b[0];var h,j;if(this.scanRanksFromSinks){h=e.connectsAsSource;j=e.connectsAsTarget}else{h=e.connectsAsTarget;j=e.connectsAsSource}var k=true,l=0;if(!this.scanRanksFromSinks)l=this.SOURCESCANSTARTRANK;for(d=0;d<h.length;d++){var m=h[d];if(m.temp[0]==5270620){m=this.scanRanksFromSinks?m.target:m.source;l=this.scanRanksFromSinks?Math.max(l,m.temp[0]+1):Math.min(l,
m.temp[0]-1)}else{k=false;break}}if(k){e.temp[0]=l;this.maxRank=this.scanRanksFromSinks?Math.max(this.maxRank,l):Math.min(this.maxRank,l);if(j!=null)for(d=0;d<j.length;d++){m=j[d];m.temp[0]=5270620;m=this.scanRanksFromSinks?m.source:m.target;if(m.temp[0]==-1){b.push(m);m.temp[0]=-2}}b.shift()}else{d=b.shift();b.push(e);if(d==e&&b.length==1)break}}if(this.scanRanksFromSinks){if(this.tightenToSource)for(d=0;d<g.length;d++){e=g[d];b=1E6;for(f=0;f<e.connectsAsTarget.length;f++){m=e.connectsAsTarget[f];
m=m.source;e.temp[0]=Math.min(b,m.temp[0]-1);b=e.temp[0]}}}else{for(f in this.vertexMapper){e=this.vertexMapper[f];e.temp[0]-=this.maxRank}this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank}};
a.fixRanks=function(){var b=[];this.ranks=[];for(var d=0;d<this.maxRank+1;d++){b[d]=[];this.ranks[d]=b[d]}var e=null;if(this.roots!=null){var f=this.roots;e=[];for(d=0;d<f.length;d++){var g=this.vertexMapper[mxCellPath.create(f[d])];e[d]=g}}this.visit(function(h,j,k,l,m){if(m==0&&j.maxRank<0&&j.minRank<0){b[j.temp[0]].push(j);j.maxRank=j.temp[0];j.minRank=j.temp[0];j.temp[0]=b[j.maxRank].length-1}if(h!=null&&k!=null)if(h.maxRank-j.maxRank>1){k.maxRank=h.maxRank;k.minRank=j.maxRank;k.temp=[];k.x=[];
k.y=[];for(h=k.minRank+1;h<k.maxRank;h++){b[h].push(k);k.setGeneralPurposeVariable(h,b[h].length-1)}}},e,false,null)};a.visit=function(b,d,e,f){if(d!=null){for(var g=0;g<d.length;g++){var h=d[g];if(h!=null){if(f==null)f={};if(e){h.hashCode=[];h.hashCode[0]=this.dfsCount;h.hashCode[1]=g;this.extendedDfs(null,h,null,b,f,h.hashCode,g,0)}else this.dfs(null,h,null,b,f,0)}}this.dfsCount++}};
a.dfs=function(b,d,e,f,g,h){if(d!=null){var j=mxCellPath.create(d.cell);if(g[j]==null){g[j]=d;f(b,d,e,h,0);b=d.connectsAsSource.slice();for(e=0;e<b.length;e++){j=b[e];this.dfs(d,j.target,j,f,g,h+1)}}else f(b,d,e,h,1)}};
a.extendedDfs=function(b,d,e,f,g,h,j,k){if(d!=null){if(b!=null)if(d.hashCode==null||d.hashCode[0]!=b.hashCode[0]){h=b.hashCode.length+1;d.hashCode=b.hashCode.slice();d.hashCode[h-1]=j}j=mxCellPath.create(d.cell);if(g[j]==null){g[j]=d;f(b,d,e,k,0);b=d.connectsAsSource.slice();for(e=0;e<b.length;e++){j=b[e];this.extendedDfs(d,j.target,j,f,g,d.hashCode,e,k+1)}}else f(b,d,e,k,1)}};function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(){};
function mxMedianHybridCrossingReduction(b){this.layout=b}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage;a=mxMedianHybridCrossingReduction.prototype;a.constructor=mxMedianHybridCrossingReduction;a.layout=null;a.maxIterations=24;a.nestedBestRanks=null;a.currentBestCrossings=0;a.iterationsWithoutImprovement=0;a.maxNoImprovementIterations=2;
a.execute=function(){var b=this.layout.getModel();this.nestedBestRanks=[];for(var d=0;d<b.ranks.length;d++)this.nestedBestRanks[d]=b.ranks[d].slice();var e=0,f=this.calculateCrossings(b);for(d=0;d<this.maxIterations&&e<this.maxNoImprovementIterations;d++){this.weightedMedian(d,b);this.transpose(d,b);var g=this.calculateCrossings(b);if(g<f){f=g;for(g=e=0;g<this.nestedBestRanks.length;g++)for(var h=b.ranks[g],j=0;j<h.length;j++){var k=h[j];this.nestedBestRanks[g][k.getGeneralPurposeVariable(g)]=k}}else{e++;
for(g=0;g<this.nestedBestRanks.length;g++){h=b.ranks[g];for(j=0;j<h.length;j++){k=h[j];k.setGeneralPurposeVariable(g,j)}}}if(f==0)break}e=[];f=[];for(d=0;d<b.maxRank+1;d++){f[d]=[];e[d]=f[d]}for(d=0;d<this.nestedBestRanks.length;d++)for(g=0;g<this.nestedBestRanks[d].length;g++)f[d].push(this.nestedBestRanks[d][g]);b.ranks=e};a.calculateCrossings=function(b){for(var d=b.ranks.length,e=0,f=1;f<d;f++)e+=this.calculateRankCrossing(f,b);return e};
a.calculateRankCrossing=function(b,d){var e=0,f=d.ranks[b],g=f.length;d=d.ranks[b-1].length;for(var h=[],j=0;j<g;j++)h[j]=[];for(j=0;j<f.length;j++){var k=f[j],l=k.getGeneralPurposeVariable(b),m=k.getPreviousLayerConnectedCells(b);for(k=0;k<m.length;k++){var n=m[k].getGeneralPurposeVariable(b-1);h[l][n]=201207}}for(j=0;j<g;j++)for(k=0;k<d;k++)if(h[j][k]==201207){for(b=j+1;b<g;b++)for(f=0;f<k;f++)h[b][f]==201207&&e++;for(b=0;b<j;b++)for(f=k+1;f<d;f++)h[b][f]==201207&&e++}return e/2};
a.transpose=function(b,d){for(var e=true,f=0;e&&f++<10;){var g=b%2==1&&f%2==1;e=false;for(var h=0;h<d.ranks.length;h++){for(var j=d.ranks[h],k=[],l=0;l<j.length;l++){var m=j[l],n=m.getGeneralPurposeVariable(h);if(n<0)n=l;k[n]=m}var o=n=m=null,p=null,q=null,r=null,s=null,u=null,v=null,w=null;for(l=0;l<j.length-1;l++){if(l==0){v=k[l];m=v.getNextLayerConnectedCells(h);n=v.getPreviousLayerConnectedCells(h);q=[];r=[];for(var t=0;t<q.length;t++)q[t]=m[t].getGeneralPurposeVariable(h+1);for(t=0;t<r.length;t++)r[t]=
n[t].getGeneralPurposeVariable(h-1)}else{m=o;n=p;q=s;r=u;v=w}w=k[l+1];o=w.getNextLayerConnectedCells(h);p=w.getPreviousLayerConnectedCells(h);s=[];u=[];for(t=0;t<s.length;t++)s[t]=o[t].getGeneralPurposeVariable(h+1);for(t=0;t<u.length;t++)u[t]=p[t].getGeneralPurposeVariable(h-1);var z=0,C=0;for(t=0;t<q.length;t++)for(var y=0;y<s.length;y++){q[t]>s[y]&&z++;q[t]<s[y]&&C++}for(t=0;t<r.length;t++)for(y=0;y<u.length;y++){r[t]>u[y]&&z++;r[t]<u[y]&&C++}if(C<z||C==z&&g){o=v.getGeneralPurposeVariable(h);v.setGeneralPurposeVariable(h,
w.getGeneralPurposeVariable(h));w.setGeneralPurposeVariable(h,o);o=m;p=n;s=q;u=r;w=v;g||(e=true)}}}}};a.weightedMedian=function(b,d){if(b=b%2==0)for(var e=d.maxRank-1;e>=0;e--)this.medianRank(e,b);else for(e=1;e<d.maxRank;e++)this.medianRank(e,b)};
a.medianRank=function(b,d){for(var e=this.nestedBestRanks[b].length,f=[],g=0;g<e;g++){var h=this.nestedBestRanks[b][g];f[g]=new MedianCellSorter;f[g].cell=h;f[g].nudge=!d;h=d?h.getNextLayerConnectedCells(b):h.getPreviousLayerConnectedCells(b);var j;j=d?b+1:b-1;f[g].medianValue=h!=null&&h.length!=0?this.medianValue(h,j):-1}f.sort(MedianCellSorter.prototype.compare);for(g=0;g<e;g++)f[g].cell.setGeneralPurposeVariable(b,g)};
a.medianValue=function(b,d){for(var e=[],f=0,g=0;g<b.length;g++){var h=b[g];e[f++]=h.getGeneralPurposeVariable(d)}e.sort(MedianCellSorter.prototype.compare);if(f%2==1)return e[f/2];else if(f==2)return(e[0]+e[1])/2;else{b=f/2;d=e[b-1]-e[0];f=e[f-1]-e[b];return(e[b-1]*f+e[b]*d)/(d+f)}};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.nudge=false;MedianCellSorter.prototype.cell=false;
MedianCellSorter.prototype.compare=function(b,d){return b!=null&&d!=null?d.medianValue>b.medianValue?-1:d.medianValue<b.medianValue?1:d.nudge?-1:1:0};function mxMinimumCycleRemover(b){this.layout=b}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage;mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;
mxMinimumCycleRemover.prototype.execute=function(){var b=this.layout.getModel(),d={},e=mxUtils.clone(b.vertexMapper,null,true),f=null;if(b.roots!=null){var g=b.roots;f=[];for(var h=0;h<g.length;h++){var j=mxCellPath.create(g[h]);f[h]=b.vertexMapper[j]}}b.visit(function(k,l,m){if(l.isAncestor(k)){m.invert();mxUtils.remove(m,k.connectsAsSource);k.connectsAsTarget.push(m);mxUtils.remove(m,l.connectsAsTarget);l.connectsAsSource.push(m)}k=mxCellPath.create(l.cell);d[k]=l;delete e[k]},f,true,null);f=null;
if(e.lenth>0)f=mxUtils.clone(e,null,true);h=mxUtils.clone(d,null,true);b.visit(function(k,l,m){if(l.isAncestor(k)){m.invert();mxUtils.remove(m,k.connectsAsSource);l.connectsAsSource.push(m);k.connectsAsTarget.push(m);mxUtils.remove(m,l.connectsAsTarget)}k=mxCellPath.create(l.cell);d[k]=l;delete e[k]},e,true,h);g=this.layout.getGraph();if(f!=null&&f.length>0){b=b.roots;for(h=0;h<f.length;h++){j=f[h].cell;g.getIncomingEdges(j).length==0&&b.push(j)}}};
function mxCoordinateAssignment(b,d,e,f,g,h){this.layout=b;this.intraCellSpacing=d;this.interRankCellSpacing=e;this.orientation=f;this.initialX=g;this.parallelEdgeSpacing=h}mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage;a=mxCoordinateAssignment.prototype;a.constructor=mxCoordinateAssignment;a.layout=null;a.intraCellSpacing=30;a.interRankCellSpacing=10;a.parallelEdgeSpacing=10;a.maxIterations=8;a.orientation=mxConstants.DIRECTION_NORTH;a.initialX=null;a.limitX=null;
a.currentXDelta=null;a.widestRank=null;a.widestRankValue=null;a.rankWidths=null;a.rankY=null;a.fineTuning=true;a.nextLayerConnectedCache=null;a.previousLayerConnectedCache=null;
a.execute=function(){var b=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),b);this.fineTuning&&this.minNode(b);var d=1E8;if(this.fineTuning)for(var e=0;e<this.maxIterations;e++){if(e!=0){this.medianPos(e,b);this.minNode(b)}if(this.currentXDelta<d){for(var f=0;f<b.ranks.length;f++)for(var g=b.ranks[f],h=0;h<g.length;h++){var j=g[h];j.setX(f,j.getGeneralPurposeVariable(f))}d=this.currentXDelta}else for(f=0;f<b.ranks.length;f++){g=b.ranks[f];for(h=0;h<g.length;h++){j=
g[h];j.setGeneralPurposeVariable(f,j.getX(f))}}this.currentXDelta=0}this.setCellLocations(this.layout.getGraph(),b)};
a.minNode=function(b){for(var d=[],e=[],f=[],g=0;g<=b.maxRank;g++){f[g]=b.ranks[g];for(var h=0;h<f[g].length;h++){var j=f[g][h],k=new WeightedCellSorter(j,g);k.rankIndex=h;k.visited=true;d.push(k);j=mxCellPath.create(j.cell);e[j]=k}}b=d.length*10;for(h=0;d.length>0&&h<=b;){k=d.shift();g=k.cell;var l=k.weightedValue,m=parseInt(k.rankIndex);j=g.getNextLayerConnectedCells(l);var n=g.getPreviousLayerConnectedCells(l),o=j.length,p=n.length,q=this.medianXValue(j,l+1),r=this.medianXValue(n,l-1),s=o+p,u=
g.getGeneralPurposeVariable(l),v=u;if(s>0)v=(q*o+r*p)/s;o=false;if(v<u-1)if(m==0){g.setGeneralPurposeVariable(l,v);o=true}else{m=f[l][m-1];u=m.getGeneralPurposeVariable(l);u=u+m.width/2+this.intraCellSpacing+g.width/2;if(u<v){g.setGeneralPurposeVariable(l,v);o=true}else if(u<g.getGeneralPurposeVariable(l)-1){g.setGeneralPurposeVariable(l,u);o=true}}else if(v>u+1)if(m==f[l].length-1){g.setGeneralPurposeVariable(l,v);o=true}else{m=f[l][m+1];u=m.getGeneralPurposeVariable(l);u=u-m.width/2-this.intraCellSpacing-
g.width/2;if(u>v){g.setGeneralPurposeVariable(l,v);o=true}else if(u>g.getGeneralPurposeVariable(l)+1){g.setGeneralPurposeVariable(l,u);o=true}}if(o){for(g=0;g<j.length;g++){l=j[g];l=mxCellPath.create(l.cell);l=e[l];if(l!=null)if(l.visited==false){l.visited=true;d.push(l)}}for(g=0;g<n.length;g++){l=n[g];l=mxCellPath.create(l.cell);l=e[l];if(l!=null)if(l.visited==false){l.visited=true;d.push(l)}}}k.visited=false;h++}};
a.medianPos=function(b,d){if(b%2==0)for(b=d.maxRank;b>0;b--)this.rankMedianPosition(b-1,d,b);else for(b=0;b<d.maxRank-1;b++)this.rankMedianPosition(b+1,d,b)};
a.rankMedianPosition=function(b,d,e){d=d.ranks[b];for(var f=[],g=[],h=0;h<d.length;h++){var j=d[h];f[h]=new WeightedCellSorter;f[h].cell=j;f[h].rankIndex=h;var k=mxCellPath.create(j.cell);g[k]=f[h];var l=null;l=e<b?j.getPreviousLayerConnectedCells(b):j.getNextLayerConnectedCells(b);f[h].weightedValue=this.calculatedWeightedValue(j,l)}f.sort(WeightedCellSorter.prototype.compare);for(h=0;h<f.length;h++){k=0;j=f[h].cell;k=0;l=e<b?j.getPreviousLayerConnectedCells(b).slice():j.getNextLayerConnectedCells(b).slice();
if(l!=null){k=l.length;k=k>0?this.medianXValue(l,e):j.getGeneralPurposeVariable(b)}var m=0;l=-100000000;for(var n=f[h].rankIndex-1;n>=0;){var o=mxCellPath.create(d[n].cell);o=g[o];if(o!=null){var p=o.cell;if(o.visited){l=p.getGeneralPurposeVariable(b)+p.width/2+this.intraCellSpacing+m+j.width/2;n=-1}else{m+=p.width+this.intraCellSpacing;n--}}}m=0;p=1E8;for(n=f[h].rankIndex+1;n<f.length;){o=mxCellPath.create(d[n].cell);o=g[o];if(o!=null){var q=o.cell;if(o.visited){p=q.getGeneralPurposeVariable(b)-
q.width/2-this.intraCellSpacing-m-j.width/2;n=f.length}else{m+=q.width+this.intraCellSpacing;n++}}}if(k>=l&&k<=p)j.setGeneralPurposeVariable(b,k);else if(k<l){j.setGeneralPurposeVariable(b,l);this.currentXDelta+=l-k}else if(k>p){j.setGeneralPurposeVariable(b,p);this.currentXDelta+=k-p}f[h].visited=true}};a.calculatedWeightedValue=function(b,d){for(var e=0,f=0;f<d.length;f++){var g=d[f];if(b.isVertex()&&g.isVertex())e++;else e+=b.isEdge()&&g.isEdge()?8:2}return e};
a.medianXValue=function(b,d){if(b.length==0)return 0;for(var e=[],f=0;f<b.length;f++)e[f]=b[f].getGeneralPurposeVariable(d);e.sort(MedianCellSorter.prototype.compare);if(b.length%2==1)return e[b.length/2];else{b=b.length/2;return(e[b-1]+e[b])/2}};a.initialCoords=function(b,d){this.calculateWidestRank(b,d);for(var e=this.widestRank;e>=0;e--)e<d.maxRank&&this.rankCoordinates(e,b,d);for(e=this.widestRank+1;e<=d.maxRank;e++)e>0&&this.rankCoordinates(e,b,d)};
a.rankCoordinates=function(b,d,e){d=e.ranks[b];e=0;for(var f=this.initialX+(this.widestRankValue-this.rankWidths[b])/2,g=false,h=0;h<d.length;h++){var j=d[h];if(j.isVertex()){var k=this.layout.getVertexBounds(j.cell);if(k!=null)if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){j.width=k.width;j.height=k.height}else{j.width=k.height;j.height=k.width}else g=true;e=Math.max(e,j.height)}else if(j.isEdge()){k=1;if(j.edges!=null)k=j.edges.length;else mxLog.warn("edge.edges is null");
j.width=(k-1)*this.parallelEdgeSpacing}f+=j.width/2;j.setX(b,f);j.setGeneralPurposeVariable(b,f);f+=j.width/2;f+=this.intraCellSpacing}g==true&&mxLog.warn("At least one cell has no bounds")};
a.calculateWidestRank=function(b,d){b=-this.interRankCellSpacing;var e=0;this.rankWidths=[];this.rankY=[];for(var f=d.maxRank;f>=0;f--){for(var g=0,h=d.ranks[f],j=this.initialX,k=false,l=0;l<h.length;l++){var m=h[l];if(m.isVertex()){var n=this.layout.getVertexBounds(m.cell);if(n!=null)if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){m.width=n.width;m.height=n.height}else{m.width=n.height;m.height=n.width}else k=true;g=Math.max(g,m.height)}else if(m.isEdge()){n=
1;if(m.edges!=null)n=m.edges.length;else mxLog.warn("edge.edges is null");m.width=(n-1)*this.parallelEdgeSpacing}j+=m.width/2;m.setX(f,j);m.setGeneralPurposeVariable(f,j);j+=m.width/2;j+=this.intraCellSpacing;if(j>this.widestRankValue){this.widestRankValue=j;this.widestRank=f}this.rankWidths[f]=j}k==true&&mxLog.warn("At least one cell has no bounds");this.rankY[f]=b;j=g/2+e/2+this.interRankCellSpacing;e=g;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST)b+=
j;else b-=j;for(l=0;l<h.length;l++)h[l].setY(f,b)}};
a.setCellLocations=function(b,d){for(b=0;b<d.ranks.length;b++)for(var e=d.ranks[b],f=0;f<e.length;f++){var g=e[f];if(g.isVertex()){var h=g.cell,j=g.x[0]-g.width/2,k=g.y[0]-g.height/2;this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?this.layout.setVertexLocation(h,j,k):this.layout.setVertexLocation(h,k,j);limitX=Math.max(this.limitX,j+g.width)}else if(g.isEdge()){h=0;if(g.temp[0]!=101207){for(k=0;k<g.edges.length;k++){var l=g.edges[k],m=[];if(g.isReversed){for(var n=
0;n<g.x.length;n++){j=g.x[n]+h;this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?m.push(new mxPoint(j,g.y[n])):m.push(new mxPoint(g.y[n],j));limitX=Math.max(limitX,j)}this.processReversedEdge(g,l)}else for(n=g.x.length-1;n>=0;n--){j=g.x[n]+h;this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?m.push(new mxPoint(j,g.y[n])):m.push(new mxPoint(g.y[n],j));limitX=Math.max(limitX,j)}this.layout.setEdgePoints(l,m);h=h==0?
this.parallelEdgeSpacing:h>0?-h:-h+this.parallelEdgeSpacing}g.temp[0]=101207}}}};a.processReversedEdge=function(){};function WeightedCellSorter(b,d){this.cell=b;this.weightedValue=d}a=WeightedCellSorter.prototype;a.weightedValue=0;a.nudge=false;a.visited=false;a.rankIndex=null;a.cell=null;a.compare=function(b,d){return b!=null&&d!=null?d.weightedValue>b.weightedValue?-1:d.weightedValue<b.weightedValue?1:d.nudge?-1:1:0};
function mxHierarchicalLayout(b,d,e){mxGraphLayout.call(this,b);this.orientation=d!=null?d:mxConstants.DIRECTION_NORTH;this.deterministic=e!=null?e:true}mxHierarchicalLayout.prototype=new mxGraphLayout;a=mxHierarchicalLayout.prototype;a.constructor=mxHierarchicalLayout;a.roots=null;a.resizeParent=false;a.moveParent=false;a.parentBorder=0;a.intraCellSpacing=30;a.interRankCellSpacing=50;a.interHierarchySpacing=60;a.parallelEdgeSpacing=10;a.orientation=mxConstants.DIRECTION_NORTH;a.fineTuning=true;
a.fixRoots=false;a.layoutFromSinks=true;a.tightenToSource=true;a.disableEdgeStyle=true;a.model=null;a.getModel=function(){return this.model};a.execute=function(b,d){if(d==null)d=this.graph.findTreeRoots(b);this.roots=d;if(this.roots!=null){d=this.graph.getModel();d.beginUpdate();try{this.run(b);this.resizeParent&&!this.graph.isCellCollapsed(b)&&this.graph.updateGroupBounds([b],this.parentBorder,this.moveParent)}finally{d.endUpdate()}}};
a.run=function(b){var d=[],e=null,f=null,g=null;if(this.fixRoots){e=[];f=[];g=[]}for(var h=0;h<this.roots.length;h++){for(var j=true,k=0;j&&k<d.length;k++){var l=mxCellPath.create(this.roots[h]);if(d[k][l]!=null)j=false}if(j){k=[];k.push(this.roots[h]);l=null;if(this.fixRoots){e.push(this.roots[h]);j=this.getVertexBounds(this.roots[h]).getPoint();f.push(j);l=[]}for(j={};k.length>0;){var m=k.shift(),n=mxCellPath.create(m);if(j[n]==null){j[n]=m;if(this.fixRoots){var o=this.graph.getIncomingEdges(m,
b);for(n=0;n<o.length;n++)l.push(o[n])}m=this.graph.getOpposites(this.graph.getConnections(m,b),m);for(n=0;n<m.length;n++){o=mxCellPath.create(m[n]);j[o]==null&&k.push(m[n])}}}d.push(j);this.fixRoots&&g.push(l)}}for(h=k=0;h<d.length;h++){j=d[h];o=[];for(var p in j)o.push(j[p]);this.model=new mxGraphHierarchyModel(this,o,this.roots,b,false,this.deterministic,this.tightenToSource,this.layoutFromSinks);this.cycleStage(b);this.layeringStage();this.crossingStage(b);k=this.placementStage(k,b);if(this.fixRoots){n=
f[h];m=this.getVertexBounds(e[h]).getPoint();l=n.x-m.x;n=n.y-m.y;this.graph.moveCells(j,l,n);this.graph.moveCells(g[h+1],l,n)}}};a.cycleStage=function(b){(new mxMinimumCycleRemover(this)).execute(b)};a.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};a.crossingStage=function(b){(new mxMedianHybridCrossingReduction(this)).execute(b)};
a.placementStage=function(b,d){b=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,b,this.parallelEdgeSpacing);b.fineTuning=this.fineTuning;b.execute(d);return b.limitX+this.interHierarchySpacing};function mxGraphModel(b){this.currentEdit=this.createUndoableEdit();b!=null?this.setRoot(b):this.clear()}mxGraphModel.prototype=new mxEventSource;a=mxGraphModel.prototype;a.constructor=mxGraphModel;a.root=null;a.cells=null;a.maintainEdgeParent=true;
a.createIds=true;a.prefix="";a.postfix="";a.nextId=0;a.currentEdit=null;a.updateLevel=0;a.endingUpdate=false;a.clear=function(){this.setRoot(this.createRoot())};a.isCreateIds=function(){return this.createIds};a.setCreateIds=function(b){this.createIds=b};a.createRoot=function(){var b=new mxCell;b.insert(new mxCell);return b};a.getCell=function(b){return this.cells!=null?this.cells[b]:null};a.filterCells=function(b,d){var e=null;if(b!=null){e=[];for(var f=0;f<b.length;f++)d(b[f])&&e.push(b[f])}return e};
a.getDescendants=function(b){return this.filterDescendants(null,b)};a.filterDescendants=function(b,d){var e=[];d=d||this.getRoot();if(b==null||b(d))e.push(d);for(var f=this.getChildCount(d),g=0;g<f;g++){var h=this.getChildAt(d,g);e=e.concat(this.filterDescendants(b,h))}return e};a.getRoot=function(b){var d=b||this.root;if(b!=null)for(;b!=null;){d=b;b=this.getParent(b)}return d};a.setRoot=function(b){this.execute(new mxRootChange(this,b));return b};
a.rootChanged=function(b){var d=this.root;this.root=b;this.nextId=0;this.cells=null;this.cellAdded(b);return d};a.isRoot=function(b){return b!=null&&this.root==b};a.isLayer=function(b){return this.isRoot(this.getParent(b))};a.isAncestor=function(b,d){for(;d!=null&&d!=b;)d=this.getParent(d);return d==b};a.contains=function(b){return this.isAncestor(this.root,b)};a.getParent=function(b){return b!=null?b.getParent():null};
a.add=function(b,d,e){if(d!=b&&b!=null&&d!=null){if(e==null)e=this.getChildCount(b);var f=b!=this.getParent(d);this.execute(new mxChildChange(this,b,d,e));this.maintainEdgeParent&&f&&this.updateEdgeParents(d)}return d};
a.cellAdded=function(b){if(b!=null){b.getId()==null&&this.createIds&&b.setId(this.createId(b));if(b.getId()!=null){var d=this.getCell(b.getId());if(d!=b){for(;d!=null;){b.setId(this.createId(b));d=this.getCell(b.getId())}if(this.cells==null)this.cells={};this.cells[b.getId()]=b}}if(mxUtils.isNumeric(b.getId()))this.nextId=Math.max(this.nextId,b.getId());d=this.getChildCount(b);for(var e=0;e<d;e++)this.cellAdded(this.getChildAt(b,e))}};
a.createId=function(){var b=this.nextId;this.nextId++;return this.prefix+b+this.postfix};a.updateEdgeParents=function(b,d){d=d||this.getRoot(b);for(var e=this.getChildCount(b),f=0;f<e;f++)this.updateEdgeParents(this.getChildAt(b,f),d);var g=this.getEdgeCount(b);e=[];for(f=0;f<g;f++)e.push(this.getEdgeAt(b,f));for(f=0;f<e.length;f++){b=e[f];this.isAncestor(d,b)&&this.updateEdgeParent(b,d)}};
a.updateEdgeParent=function(b,d){var e=this.getTerminal(b,true),f=this.getTerminal(b,false),g=null;if(this.isAncestor(d,e)&&this.isAncestor(d,f)){g=e==f?this.getParent(e):this.getNearestCommonAncestor(e,f);if(g!=null&&(this.getParent(g)!=this.root||this.isAncestor(g,b))&&this.getParent(b)!=g){d=this.getGeometry(b);if(d!=null){f=this.getOrigin(this.getParent(b));var h=this.getOrigin(g);e=h.x-f.x;f=h.y-f.y;d=d.clone();d.translate(-e,-f);this.setGeometry(b,d)}this.add(g,b,this.getChildCount(g))}}};
a.getOrigin=function(b){var d=null;if(b!=null){d=this.getOrigin(this.getParent(b));if(!this.isEdge(b)){b=this.getGeometry(b);if(b!=null){d.x+=b.x;d.y+=b.y}}}else d=new mxPoint;return d};a.getNearestCommonAncestor=function(b,d){if(b!=null&&d!=null){d=mxCellPath.create(d);if(d!=null&&d.length>0){b=b;for(var e=mxCellPath.create(b);b!=null;){var f=this.getParent(b);if(d.indexOf(e+mxCellPath.PATH_SEPARATOR)==0&&f!=null)return b;e=mxCellPath.getParentPath(e);b=f}}}return null};
a.remove=function(b){if(b==this.root)this.setRoot(null);else this.getParent(b)!=null&&this.execute(new mxChildChange(this,null,b));return b};a.cellRemoved=function(b){if(b!=null&&this.cells!=null){for(var d=this.getChildCount(b)-1;d>=0;d--)this.cellRemoved(this.getChildAt(b,d));this.cells!=null&&b.getId()!=null&&delete this.cells[b.getId()]}};
a.parentForCellChanged=function(b,d,e){var f=this.getParent(b);if(d!=null){if(d!=f||f.getIndex(b)!=e)d.insert(b,e)}else if(f!=null){e=f.getIndex(b);f.remove(e)}if(!this.contains(f)&&d!=null)this.cellAdded(b);else d==null&&this.cellRemoved(b);return f};a.getChildCount=function(b){return b!=null?b.getChildCount():0};a.getChildAt=function(b,d){return b!=null?b.getChildAt(d):null};a.getChildren=function(b){return b!=null?b.children:null};
a.getChildVertices=function(b){return this.getChildCells(b,true,false)};a.getChildEdges=function(b){return this.getChildCells(b,false,true)};a.getChildCells=function(b,d,e){d=d!=null?d:false;e=e!=null?e:false;for(var f=this.getChildCount(b),g=[],h=0;h<f;h++){var j=this.getChildAt(b,h);if(!e&&!d||e&&this.isEdge(j)||d&&this.isVertex(j))g.push(j)}return g};a.getTerminal=function(b,d){return b!=null?b.getTerminal(d):null};
a.setTerminal=function(b,d,e){var f=d!=this.getTerminal(b,e);this.execute(new mxTerminalChange(this,b,d,e));this.maintainEdgeParent&&f&&this.updateEdgeParent(b,this.getRoot());return d};a.setTerminals=function(b,d,e){this.beginUpdate();try{this.setTerminal(b,d,true);this.setTerminal(b,e,false)}finally{this.endUpdate()}};a.terminalForCellChanged=function(b,d,e){var f=this.getTerminal(b,e);if(d!=null)d.insertEdge(b,e);else f!=null&&f.removeEdge(b,e);return f};
a.getEdgeCount=function(b){return b!=null?b.getEdgeCount():0};a.getEdgeAt=function(b,d){return b!=null?b.getEdgeAt(d):null};a.getDirectedEdgeCount=function(b,d,e){for(var f=0,g=this.getEdgeCount(b),h=0;h<g;h++){var j=this.getEdgeAt(b,h);j!=e&&this.getTerminal(j,d)==b&&f++}return f};a.getConnections=function(b){return this.getEdges(b,true,true,false)};a.getIncomingEdges=function(b){return this.getEdges(b,true,false,false)};a.getOutgoingEdges=function(b){return this.getEdges(b,false,true,false)};
a.getEdges=function(b,d,e,f){d=d!=null?d:true;e=e!=null?e:true;f=f!=null?f:true;for(var g=this.getEdgeCount(b),h=[],j=0;j<g;j++){var k=this.getEdgeAt(b,j),l=this.getTerminal(k,true),m=this.getTerminal(k,false);if(f||l!=m&&(d&&m==b||e&&l==b))h.push(k)}return h};
a.getEdgesBetween=function(b,d,e){e=e!=null?e:false;var f=this.getEdgeCount(b),g=this.getEdgeCount(d),h=b,j=f;if(g<f){j=g;h=d}f=[];for(g=0;g<j;g++){var k=this.getEdgeAt(h,g),l=this.getTerminal(k,true),m=this.getTerminal(k,false);if((l=l==b)&&m==d||!e&&this.getTerminal(k,!l)==d)f.push(k)}return f};
a.getOpposites=function(b,d,e,f){e=e!=null?e:true;f=f!=null?f:true;var g=[];if(b!=null)for(var h=0;h<b.length;h++){var j=this.getTerminal(b[h],true),k=this.getTerminal(b[h],false);if(j==d&&k!=null&&k!=d&&f)g.push(k);else k==d&&j!=null&&j!=d&&e&&g.push(j)}return g};a.getTopmostCells=function(b){for(var d=[],e=0;e<b.length;e++){for(var f=b[e],g=true,h=this.getParent(f);h!=null;){if(mxUtils.indexOf(b,h)>=0){g=false;break}h=this.getParent(h)}g&&d.push(f)}return d};
a.isVertex=function(b){return b!=null?b.isVertex():false};a.isEdge=function(b){return b!=null?b.isEdge():false};a.isConnectable=function(b){return b!=null?b.isConnectable():false};a.getValue=function(b){return b!=null?b.getValue():null};a.setValue=function(b,d){this.execute(new mxValueChange(this,b,d));return d};a.valueForCellChanged=function(b,d){return b.valueChanged(d)};a.getGeometry=function(b){return b!=null?b.getGeometry():null};
a.setGeometry=function(b,d){d!=this.getGeometry(b)&&this.execute(new mxGeometryChange(this,b,d));return d};a.geometryForCellChanged=function(b,d){var e=this.getGeometry(b);b.setGeometry(d);return e};a.getStyle=function(b){return b!=null?b.getStyle():null};a.setStyle=function(b,d){d!=this.getStyle(b)&&this.execute(new mxStyleChange(this,b,d));return d};a.styleForCellChanged=function(b,d){var e=this.getStyle(b);b.setStyle(d);return e};a.isCollapsed=function(b){return b!=null?b.isCollapsed():false};
a.setCollapsed=function(b,d){d!=this.isCollapsed(b)&&this.execute(new mxCollapseChange(this,b,d));return d};a.collapsedStateForCellChanged=function(b,d){var e=this.isCollapsed(b);b.setCollapsed(d);return e};a.isVisible=function(b){return b!=null?b.isVisible():false};a.setVisible=function(b,d){d!=this.isVisible(b)&&this.execute(new mxVisibleChange(this,b,d));return d};a.visibleStateForCellChanged=function(b,d){var e=this.isVisible(b);b.setVisible(d);return e};
a.execute=function(b){b.execute();this.beginUpdate();this.currentEdit.add(b);this.fireEvent(new mxEventObject(mxEvent.EXECUTE,"change",b));this.endUpdate()};a.beginUpdate=function(){this.updateLevel++;this.fireEvent(new mxEventObject(mxEvent.BEGIN_UPDATE))};
a.endUpdate=function(){this.updateLevel--;if(!this.endingUpdate){this.endingUpdate=this.updateLevel==0;this.fireEvent(new mxEventObject(mxEvent.END_UPDATE,"edit",this.currentEdit));try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){this.fireEvent(new mxEventObject(mxEvent.BEFORE_UNDO,"edit",this.currentEdit));var b=this.currentEdit;this.currentEdit=this.createUndoableEdit();b.notify();this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",b))}}finally{this.endingUpdate=false}}};
a.createUndoableEdit=function(){var b=new mxUndoableEdit(this,true);b.notify=function(){b.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",b.changes));b.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"changes",b.changes))};return b};
a.mergeChildren=function(b,d,e){e=e!=null?e:true;this.beginUpdate();try{var f={};this.mergeChildrenImpl(b,d,e,f);for(var g in f){var h=f[g],j=this.getTerminal(h,true);if(j!=null){j=f[mxCellPath.create(j)];this.setTerminal(h,j,true)}j=this.getTerminal(h,false);if(j!=null){j=f[mxCellPath.create(j)];this.setTerminal(h,j,false)}}}finally{this.endUpdate()}};
a.mergeChildrenImpl=function(b,d,e,f){this.beginUpdate();try{for(var g=b.getChildCount(),h=0;h<g;h++){var j=b.getChildAt(h);if(typeof j.getId=="function"){var k=j.getId(),l=k!=null&&(!this.isEdge(j)||!e)?this.getCell(k):null;if(l==null){var m=j.clone();m.setId(k);m.setTerminal(j.getTerminal(true),true);m.setTerminal(j.getTerminal(false),false);l=d.insert(m);this.cellAdded(l)}f[mxCellPath.create(j)]=l;this.mergeChildrenImpl(j,l,e,f)}}}finally{this.endUpdate()}};
a.getParents=function(b){var d=[];if(b!=null)for(var e={},f=0;f<b.length;f++){var g=this.getParent(b[f]);if(g!=null){var h=mxCellPath.create(g);if(e[h]==null){e[h]=g;d.push(g)}}}return d};a.cloneCell=function(b){if(b!=null)return this.cloneCells([b],true)[0];return null};a.cloneCells=function(b,d){for(var e={},f=[],g=0;g<b.length;g++)b[g]!=null?f.push(this.cloneCellImpl(b[g],e,d)):f.push(null);for(g=0;g<f.length;g++)f[g]!=null&&this.restoreClone(f[g],b[g],e);return f};
a.cloneCellImpl=function(b,d,e){var f=this.cellCloned(b);d[mxObjectIdentity.get(b)]=f;if(e){e=this.getChildCount(b);for(var g=0;g<e;g++){var h=this.cloneCellImpl(this.getChildAt(b,g),d,true);f.insert(h)}}return f};a.cellCloned=function(b){return b.clone()};
a.restoreClone=function(b,d,e){var f=this.getTerminal(d,true);if(f!=null){f=e[mxObjectIdentity.get(f)];f!=null&&f.insertEdge(b,true)}f=this.getTerminal(d,false);if(f!=null){f=e[mxObjectIdentity.get(f)];f!=null&&f.insertEdge(b,false)}f=this.getChildCount(b);for(var g=0;g<f;g++)this.restoreClone(this.getChildAt(b,g),this.getChildAt(d,g),e)};function mxRootChange(b,d){this.model=b;this.previous=this.root=d}mxRootChange.prototype.execute=function(){this.root=this.previous;this.previous=this.model.rootChanged(this.previous)};
function mxChildChange(b,d,e,f){this.model=b;this.previous=this.parent=d;this.child=e;this.previousIndex=this.index=f;this.isAdded=d==null}
mxChildChange.prototype.execute=function(){var b=this.model.getParent(this.child),d=b!=null?b.getIndex(this.child):0;this.previous==null&&this.connect(this.child,false);b=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex);this.previous!=null&&this.connect(this.child,true);this.parent=this.previous;this.previous=b;this.index=this.previousIndex;this.previousIndex=d;this.isAdded=!this.isAdded};
mxChildChange.prototype.connect=function(b,d){d=d!=null?d:true;var e=b.getTerminal(true),f=b.getTerminal(false);if(e!=null)d?this.model.terminalForCellChanged(b,e,true):this.model.terminalForCellChanged(b,null,true);if(f!=null)d?this.model.terminalForCellChanged(b,f,false):this.model.terminalForCellChanged(b,null,false);b.setTerminal(e,true);b.setTerminal(f,false);e=this.model.getChildCount(b);for(f=0;f<e;f++)this.connect(this.model.getChildAt(b,f),d)};
function mxTerminalChange(b,d,e,f){this.model=b;this.cell=d;this.previous=this.terminal=e;this.isSource=f}mxTerminalChange.prototype.execute=function(){this.terminal=this.previous;this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.isSource)};function mxValueChange(b,d,e){this.model=b;this.cell=d;this.previous=this.value=e}mxValueChange.prototype.execute=function(){this.value=this.previous;this.previous=this.model.valueForCellChanged(this.cell,this.previous)};
function mxStyleChange(b,d,e){this.model=b;this.cell=d;this.previous=this.style=e}mxStyleChange.prototype.execute=function(){this.style=this.previous;this.previous=this.model.styleForCellChanged(this.cell,this.previous)};function mxGeometryChange(b,d,e){this.model=b;this.cell=d;this.previous=this.geometry=e}mxGeometryChange.prototype.execute=function(){this.geometry=this.previous;this.previous=this.model.geometryForCellChanged(this.cell,this.previous)};
function mxCollapseChange(b,d,e){this.model=b;this.cell=d;this.previous=this.collapsed=e}mxCollapseChange.prototype.execute=function(){this.collapsed=this.previous;this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous)};function mxVisibleChange(b,d,e){this.model=b;this.cell=d;this.previous=this.visible=e}mxVisibleChange.prototype.execute=function(){this.visible=this.previous;this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous)};
function mxCellAttributeChange(b,d,e){this.cell=b;this.attribute=d;this.previous=this.value=e}mxCellAttributeChange.prototype.execute=function(){var b=this.cell.getAttribute(this.attribute);this.previous==null?this.cell.value.removeAttribute(this.attribute):this.cell.setAttribute(this.attribute,this.previous);this.previous=b};function mxCell(b,d,e){this.value=b;this.setGeometry(d);this.setStyle(e);this.onInit!=null&&this.onInit()}a=mxCell.prototype;a.id=null;a.value=null;a.geometry=null;a.style=null;
a.vertex=false;a.edge=false;a.connectable=true;a.visible=true;a.collapsed=false;a.parent=null;a.source=null;a.target=null;a.children=null;a.edges=null;a.mxTransient=["id","value","parent","source","target","children","edges"];a.getId=function(){return this.id};a.setId=function(b){this.id=b};a.getValue=function(){return this.value};a.setValue=function(b){this.value=b};a.valueChanged=function(b){var d=this.getValue();this.setValue(b);return d};a.getGeometry=function(){return this.geometry};
a.setGeometry=function(b){this.geometry=b};a.getStyle=function(){return this.style};a.setStyle=function(b){this.style=b};a.isVertex=function(){return this.vertex};a.setVertex=function(b){this.vertex=b};a.isEdge=function(){return this.edge};a.setEdge=function(b){this.edge=b};a.isConnectable=function(){return this.connectable};a.setConnectable=function(b){this.connectable=b};a.isVisible=function(){return this.visible};a.setVisible=function(b){this.visible=b};a.isCollapsed=function(){return this.collapsed};
a.setCollapsed=function(b){this.collapsed=b};a.getParent=function(){return this.parent};a.setParent=function(b){this.parent=b};a.getTerminal=function(b){return b?this.source:this.target};a.setTerminal=function(b,d){if(d)this.source=b;else this.target=b;return b};a.getChildCount=function(){return this.children==null?0:this.children.length};a.getIndex=function(b){return mxUtils.indexOf(this.children,b)};a.getChildAt=function(b){return this.children==null?null:this.children[b]};
a.insert=function(b,d){if(b!=null){if(d==null){d=this.getChildCount();b.getParent()==this&&this.getIndex(b)>=0&&d--}b.removeFromParent();b.setParent(this);if(this.children==null){this.children=[];this.children.push(b)}else this.children.splice(d,0,b)}return b};a.remove=function(b){var d=null;if(this.children!=null&&b>=0){d=this.getChildAt(b);if(d!=null){this.children.splice(b,1);d.setParent(null)}}return d};a.removeFromParent=function(){this.parent!=null&&this.parent.remove(this.parent.getIndex(this))};
a.getEdgeCount=function(){return this.edges==null?0:this.edges.length};a.getEdgeIndex=function(b){return mxUtils.indexOf(this.edges,b)};a.getEdgeAt=function(b){return this.edges==null?null:this.edges[b]};a.insertEdge=function(b,d){if(b!=null){b.removeFromTerminal(d);b.setTerminal(this,d);if(this.edges==null||b.getTerminal(!d)!=this||mxUtils.indexOf(this.edges,b)<0){if(this.edges==null)this.edges=[];this.edges.push(b)}}return b};
a.removeEdge=function(b,d){if(b!=null){if(b.getTerminal(!d)!=this&&this.edges!=null){var e=this.getEdgeIndex(b);e>=0&&this.edges.splice(e,1)}b.setTerminal(null,d)}return b};a.removeFromTerminal=function(b){var d=this.getTerminal(b);d!=null&&d.removeEdge(this,b)};a.getAttribute=function(b,d){var e=this.getValue();return(e!=null&&e.nodeType==mxConstants.NODETYPE_ELEMENT?e.getAttribute(b):null)||d};
a.setAttribute=function(b,d){var e=this.getValue();e!=null&&e.nodeType==mxConstants.NODETYPE_ELEMENT&&e.setAttribute(b,d)};a.clone=function(){var b=mxUtils.clone(this,this.mxTransient);b.setValue(this.cloneValue());return b};a.cloneValue=function(){var b=this.getValue();if(b!=null)if(typeof b.clone=="function")b=b.clone();else isNaN(b.nodeType)||(b=b.cloneNode(true));return b};function mxGeometry(b,d,e,f){mxRectangle.call(this,b,d,e,f)}mxGeometry.prototype=new mxRectangle;a=mxGeometry.prototype;
a.constructor=mxGeometry;a.TRANSLATE_CONTROL_POINTS=true;a.alternateBounds=null;a.sourcePoint=null;a.targetPoint=null;a.points=null;a.offset=null;a.relative=false;a.swap=function(){if(this.alternateBounds!=null){var b=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x;this.y=this.alternateBounds.y;this.width=this.alternateBounds.width;this.height=this.alternateBounds.height;this.alternateBounds=b}};a.getTerminalPoint=function(b){return b?this.sourcePoint:this.targetPoint};
a.setTerminalPoint=function(b,d){if(d)this.sourcePoint=b;else this.targetPoint=b;return b};a.translate=function(b,d){this.clone();if(!this.relative){this.x+=b;this.y+=d}if(this.sourcePoint!=null){this.sourcePoint.x+=b;this.sourcePoint.y+=d}if(this.targetPoint!=null){this.targetPoint.x+=b;this.targetPoint.y+=d}if(this.TRANSLATE_CONTROL_POINTS&&this.points!=null)for(var e=this.points.length,f=0;f<e;f++){var g=this.points[f];if(g!=null){g.x+=b;g.y+=d}}};
var mxCellPath={PATH_SEPARATOR:".",create:function(b){var d="";if(b!=null)for(var e=b.getParent();e!=null;){d=e.getIndex(b)+mxCellPath.PATH_SEPARATOR+d;b=e;e=b.getParent()}b=d.length;if(b>1)d=d.substring(0,b-1);return d},getParentPath:function(b){if(b!=null){var d=b.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(d>=0)return b.substring(0,d);else if(b.length>0)return""}return null},resolve:function(b,d){b=b;if(d!=null){d=d.split(mxCellPath.PATH_SEPARATOR);for(var e=0;e<d.length;e++)b=b.getChildAt(parseInt(d[e]))}return b},
compare:function(b,d){for(var e=Math.min(b.length,d.length),f=0,g=0;g<e;g++)if(b[g]!=d[g]){if(b[g].length==0||d[g].length==0)f=b[g]==d[g]?0:b[g]>d[g]?1:-1;else{e=parseInt(b[g]);g=parseInt(d[g]);f=e==g?0:e>g?1:-1}break}if(f==0){e=b.length;g=d.length;if(e!=g)f=e>g?1:-1}return f}},mxPerimeter={RectanglePerimeter:function(b,d,e,f){d=b.getCenterX();var g=b.getCenterY(),h=Math.atan2(e.y-g,e.x-d),j=new mxPoint(0,0),k=Math.PI,l=Math.PI/2-h,m=Math.atan2(b.height,b.width);if(h<-k+m||h>k-m){j.x=b.x;j.y=g-b.width*
Math.tan(h)/2}else if(h<-m){j.y=b.y;j.x=d-b.height*Math.tan(l)/2}else if(h<m){j.x=b.x+b.width;j.y=g+b.width*Math.tan(h)/2}else{j.y=b.y+b.height;j.x=d+b.height*Math.tan(l)/2}if(f){if(e.x>=b.x&&e.x<=b.x+b.width)j.x=e.x;else if(e.y>=b.y&&e.y<=b.y+b.height)j.y=e.y;if(e.x<b.x)j.x=b.x;else if(e.x>b.x+b.width)j.x=b.x+b.width;if(e.y<b.y)j.y=b.y;else if(e.y>b.y+b.height)j.y=b.y+b.height}return j},EllipsePerimeter:function(b,d,e,f){var g=b.x,h=b.y,j=b.width/2,k=b.height/2,l=g+j,m=h+k;d=e.x;e=e.y;var n=parseInt(d-
l),o=parseInt(e-m);if(n==0)return new mxPoint(l,m+k*o/Math.abs(o));if(f){if(e>=h&&e<=h+b.height){b=e-m;b=Math.sqrt(j*j*(1-b*b/(k*k)))||0;if(d<=g)b=-b;return new mxPoint(l+b,e)}if(d>=g&&d<=g+b.width){b=d-l;b=Math.sqrt(k*k*(1-b*b/(j*j)))||0;if(e<=h)b=-b;return new mxPoint(d,m+b)}}g=o/n;m=m-g*l;h=j*j*g*g+k*k;b=-2*l*h;k=Math.sqrt(b*b-4*h*(j*j*g*g*l*l+k*k*l*l-j*j*k*k));j=(-b+k)/(2*h);k=(-b-k)/(2*h);l=g*j+m;m=g*k+m;g=Math.sqrt(Math.pow(j-d,2)+Math.pow(l-e,2));d=Math.sqrt(Math.pow(k-d,2)+Math.pow(m-e,2));
h=e=0;if(g<d){e=j;h=l}else{e=k;h=m}return new mxPoint(e,h)},RhombusPerimeter:function(b,d,e,f){d=b.x;var g=b.y,h=b.width;b=b.height;var j=d+h/2,k=g+b/2,l=e.x;e=e.y;if(j==l)return k>e?new mxPoint(j,g):new mxPoint(j,g+b);else if(k==e)return j>l?new mxPoint(d,k):new mxPoint(d+h,k);var m=j,n=k;if(f)if(l>=d&&l<=d+h)m=l;else if(e>=g&&e<=g+b)n=e;return l<j?e<k?mxUtils.intersection(l,e,m,n,j,g,d,k):mxUtils.intersection(l,e,m,n,j,g+b,d,k):e<k?mxUtils.intersection(l,e,m,n,j,g,d+h,k):mxUtils.intersection(l,
e,m,n,j,g+b,d+h,k)},TrianglePerimeter:function(b,d,e,f){d=d!=null?d.style[mxConstants.STYLE_DIRECTION]:null;var g=d==mxConstants.DIRECTION_NORTH||d==mxConstants.DIRECTION_SOUTH,h=b.x,j=b.y,k=b.width;b=b.height;var l=h+k/2,m=j+b/2,n=new mxPoint(h,j),o=new mxPoint(h+k,m),p=new mxPoint(h,j+b);if(d==mxConstants.DIRECTION_NORTH){n=p;o=new mxPoint(l,j);p=new mxPoint(h+k,j+b)}else if(d==mxConstants.DIRECTION_SOUTH){o=new mxPoint(l,j+b);p=new mxPoint(h+k,j)}else if(d==mxConstants.DIRECTION_WEST){n=new mxPoint(h+
k,j);o=new mxPoint(h,m);p=new mxPoint(h+k,j+b)}var q=e.x-l,r=e.y-m;q=g?Math.atan2(q,r):Math.atan2(r,q);var s=g?Math.atan2(k,b):Math.atan2(b,k);r=false;r=d==mxConstants.DIRECTION_NORTH||d==mxConstants.DIRECTION_WEST?q>-s&&q<s:q<-Math.PI+s||q>Math.PI-s;s=null;if(r)s=f&&(g&&e.x>=n.x&&e.x<=p.x||!g&&e.y>=n.y&&e.y<=p.y)?g?new mxPoint(e.x,n.y):new mxPoint(n.x,e.y):d==mxConstants.DIRECTION_NORTH?new mxPoint(h+k/2+b*Math.tan(q)/2,j+b):d==mxConstants.DIRECTION_SOUTH?new mxPoint(h+k/2-b*Math.tan(q)/2,j):d==
mxConstants.DIRECTION_WEST?new mxPoint(h+k,j+b/2+k*Math.tan(q)/2):new mxPoint(h,j+b/2-k*Math.tan(q)/2);else{if(f){f=new mxPoint(l,m);if(e.y>=j&&e.y<=j+b){f.x=g?l:d==mxConstants.DIRECTION_WEST?h+k:h;f.y=e.y}else if(e.x>=h&&e.x<=h+k){f.x=e.x;f.y=!g?m:d==mxConstants.DIRECTION_NORTH?j+b:j}l=f.x;m=f.y}s=g&&e.x<=h+k/2||!g&&e.y<=j+b/2?mxUtils.intersection(e.x,e.y,l,m,n.x,n.y,o.x,o.y):mxUtils.intersection(e.x,e.y,l,m,o.x,o.y,p.x,p.y)}if(s==null)s=new mxPoint(l,m);return s}};
function mxPrintPreview(b,d,e,f,g,h,j,k,l){this.graph=b;this.scale=d!=null?d:1/b.pageScale;this.border=f!=null?f:0;this.pageFormat=e!=null?e:b.pageFormat;this.title=k!=null?k:"Printer-friendly version";this.x0=g!=null?g:0;this.y0=h!=null?h:0;this.borderColor=j;this.pageSelector=l!=null?l:true}a=mxPrintPreview.prototype;a.graph=null;a.pageFormat=null;a.scale=null;a.border=null;a.x0=null;a.y0=null;a.autoOrigin=true;a.printOverlays=false;a.borderColor=null;a.title=null;a.pageSelector=null;a.wnd=null;
a.pageCount=null;a.getWindow=function(){return this.wnd};
a.open=function(b){var d=this.graph.cellRenderer.initializeOverlay,e=null;try{if(this.printOverlays)this.graph.cellRenderer.initializeOverlay=function(v,w){w.init(v.view.getDrawPane())};if(this.wnd==null){this.wnd=window.open();var f=this.wnd.document;f.writeln("<html>");f.writeln("<head>");this.writeHead(f,b);f.writeln("</head>");f.writeln("<body>");mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",f);if(mxClient.IS_IE){f.namespaces.add("v","urn:schemas-microsoft-com:vml");f.namespaces.add("o",
"urn:schemas-microsoft-com:office:office");mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css",f)}var g=this.graph.getGraphBounds().clone(),h=this.graph.getView().getScale(),j=h/this.scale,k=this.graph.getView().getTranslate();if(!this.autoOrigin){this.x0=-k.x*this.scale;this.y0=-k.y*this.scale;g.width+=g.x;g.height+=g.y;g.x=0;this.border=g.y=0}g.width/=j;g.height/=j;var l=this.pageFormat.width-this.border*2,m=this.pageFormat.height-this.border*2,n=Math.max(1,Math.ceil((g.width+this.y0)/
l)),o=Math.max(1,Math.ceil((g.height+this.x0)/m));this.pageCount=n*o;for(b=0;b<o;b++){var p=b*m/this.scale-this.y0/this.scale+(g.y-k.y*h)/h;for(j=0;j<n;j++){if(this.wnd==null)return null;var q=b*n+j+1;e=this.renderPage(this.pageFormat.width,this.pageFormat.height,-(j*l/this.scale-this.x0/this.scale+(g.x-k.x*h)/h),-p,this.scale,q);e.setAttribute("id","mxPage-"+q);if(this.borderColor!=null){e.style.borderColor=this.borderColor;e.style.borderStyle="solid";e.style.borderWidth="1px"}e.style.background=
"white";if(b<o-1||j<n-1)e.style.pageBreakAfter="always";if(mxClient.IS_IE){f.writeln(e.outerHTML);e.parentNode.removeChild(e)}else{e.parentNode.removeChild(e);f.body.appendChild(e)}if(b<o-1||j<n-1)f.body.appendChild(f.createElement("hr"))}}f.writeln("</body>");f.writeln("</html>");f.close();mxEvent.release(f.body);if(this.pageSelector&&(o>1||n>1)){var r=this.createPageSelector(o,n);f.body.appendChild(r);if(mxClient.IS_IE){r.style.position="absolute";var s=function(){r.style.top=f.body.scrollTop+10+
"px"};mxEvent.addListener(this.wnd,"scroll",function(){s()});mxEvent.addListener(this.wnd,"resize",function(){s()})}}}this.wnd.focus()}catch(u){e!=null&&e.parentNode!=null&&e.parentNode.removeChild(e)}finally{this.graph.cellRenderer.initializeOverlay=d}return this.wnd};
a.writeHead=function(b,d){this.title!=null&&b.writeln("<title>"+this.title+"</title>");b.writeln('<style type="text/css">');b.writeln("@media print {");b.writeln("  table.mxPageSelector { display: none; }");b.writeln("  hr { display: none; }");b.writeln("}");b.writeln("@media screen {");b.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }");b.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");
b.writeln("  body { background: gray; }");b.writeln("}");d!=null&&b.writeln(d);b.writeln("</style>")};
a.createPageSelector=function(b,d){var e=this.wnd.document,f=e.createElement("table");f.className="mxPageSelector";f.setAttribute("border","0");for(var g=e.createElement("tbody"),h=0;h<b;h++){for(var j=e.createElement("tr"),k=0;k<d;k++){var l=e.createElement("td");l.style.cursor="pointer";var m=h*d+k+1;mxUtils.write(l,m,e);this.addPageClickListener(l,m);j.appendChild(l)}g.appendChild(j)}f.appendChild(g);return f};
a.addPageClickListener=function(b,d){mxEvent.addListener(b,"click",mxUtils.bind(this,function(){var e=this.wnd.document.getElementById("mxPage-"+d);e!=null&&this.wnd.scrollTo(0,Math.max(0,e.offsetTop-8))}))};
a.renderPage=function(b,d,e,f,g){var h=document.createElement("div");try{h.style.width=b+"px";h.style.height=d+"px";h.style.overflow="hidden";h.style.pageBreakInside="avoid";var j=document.createElement("div");j.style.top=this.border+"px";j.style.left=this.border+"px";j.style.width=b-2*this.border+"px";j.style.height=d-2*this.border+"px";j.style.overflow="hidden";if(mxClient.IS_IE)j.style.position="absolute";h.appendChild(j);document.body.appendChild(h);var k=this.graph.getView(),l=this.graph.container;
this.graph.container=j;var m=k.getCanvas(),n=k.getBackgroundPane(),o=k.getDrawPane(),p=k.getOverlayPane();if(this.graph.dialect==mxConstants.DIALECT_SVG)k.createSvg();else this.graph.dialect==mxConstants.DIALECT_VML?k.createVml():k.createHtml();var q=k.isEventsEnabled();k.setEventsEnabled(false);var r=this.graph.isEnabled();this.graph.setEnabled(false);var s=k.getTranslate();k.translate=new mxPoint(e,f);b=null;try{var u=[this.graph.getModel().getRoot()];b=new mxTemporaryCellStates(k,g,u)}finally{if(mxClient.IS_IE)k.overlayPane.innerHTML=
"";else for(var v=j.firstChild;v!=null;){var w=v.nextSibling;v.nodeName.toLowerCase()!="svg"&&v.style.cursor!="default"&&v.parentNode.removeChild(v);v=w}k.overlayPane.parentNode.removeChild(k.overlayPane);this.graph.setEnabled(r);this.graph.container=l;k.canvas=m;k.backgroundPane=n;k.drawPane=o;k.overlayPane=p;k.translate=s;b.destroy();k.setEventsEnabled(q)}}catch(t){h.parentNode.removeChild(h);throw t;}return h};a.print=function(){var b=this.open();b!=null&&b.print()};
a.close=function(){if(this.wnd!=null){this.wnd.close();this.wnd=null}};function mxStylesheet(){this.styles={};this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}a=mxStylesheet.prototype;
a.createDefaultVertexStyle=function(){var b={};b[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;b[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;b[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;b[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;b[mxConstants.STYLE_FILLCOLOR]="#C3D9FF";b[mxConstants.STYLE_STROKECOLOR]="#6482B9";b[mxConstants.STYLE_FONTCOLOR]="#774400";return b};
a.createDefaultEdgeStyle=function(){var b={};b[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR;b[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC;b[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;b[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;b[mxConstants.STYLE_STROKECOLOR]="#6482B9";b[mxConstants.STYLE_FONTCOLOR]="#446299";return b};a.putDefaultVertexStyle=function(b){this.putCellStyle("defaultVertex",b)};
a.putDefaultEdgeStyle=function(b){this.putCellStyle("defaultEdge",b)};a.getDefaultVertexStyle=function(){return this.styles.defaultVertex};a.getDefaultEdgeStyle=function(){return this.styles.defaultEdge};a.putCellStyle=function(b,d){this.styles[b]=d};
a.getCellStyle=function(b,d){d=d;if(b!=null&&b.length>0){var e=b.split(";");d=d!=null&&b.charAt(0)!=";"?mxUtils.clone(d):{};for(b=0;b<e.length;b++){var f=e[b],g=f.indexOf("=");if(g>=0){var h=f.substring(0,g);f=f.substring(g+1);if(f==mxConstants.NONE)delete d[h];else d[h]=mxUtils.isNumeric(f)?parseFloat(f):f}else{f=this.styles[f];if(f!=null)for(h in f)d[h]=f[h]}}}return d};function mxCellState(b,d,e){this.view=b;this.cell=d;this.style=e;this.origin=new mxPoint;this.absoluteOffset=new mxPoint}
mxCellState.prototype=new mxRectangle;a=mxCellState.prototype;a.constructor=mxCellState;a.view=null;a.cell=null;a.style=null;a.invalid=true;a.orderChanged=null;a.origin=null;a.absolutePoints=null;a.absoluteOffset=null;a.terminalDistance=0;a.length=0;a.segments=null;a.shape=null;a.text=null;a.getPerimeterBounds=function(b){b=b||0;var d=new mxRectangle(this.x,this.y,this.width,this.height);b!=0&&d.grow(b);return d};
a.setAbsoluteTerminalPoint=function(b,d){if(d){if(this.absolutePoints==null)this.absolutePoints=[];if(this.absolutePoints.length==0)this.absolutePoints.push(b);else this.absolutePoints[0]=b}else if(this.absolutePoints==null){this.absolutePoints=[];this.absolutePoints.push(null);this.absolutePoints.push(b)}else if(this.absolutePoints.length==1)this.absolutePoints.push(b);else this.absolutePoints[this.absolutePoints.length-1]=b};
a.setCursor=function(b){if(this.shape!=null)if(this.shape.innerNode!=null&&!this.view.graph.getModel().isEdge(this.cell))this.shape.innerNode.style.cursor=b;else this.shape.node.style.cursor=b;if(this.text!=null)this.text.node.style.cursor=b};a.destroy=function(){this.view.graph.cellRenderer.destroy(this)};
a.clone=function(){var b=new mxCellState(this.view,this.cell,this.style);if(this.absolutePoints!=null){b.absolutePoints=[];for(i=0;i<this.absolutePoints.length;i++)b.absolutePoints.push(this.absolutePoints[i].clone())}if(this.origin!=null)b.origin=this.origin.clone();if(this.absoluteOffset!=null)b.absoluteOffset=this.absoluteOffset.clone();if(this.boundingBox!=null)b.boundingBox=this.boundingBox.clone();b.terminalDistance=this.terminalDistance;b.segments=this.segments;b.length=this.length;b.x=this.x;
b.y=this.y;b.width=this.width;b.height=this.height;return b};function mxGraphSelectionModel(b){this.graph=b;this.cells=[]}mxGraphSelectionModel.prototype=new mxEventSource;a=mxGraphSelectionModel.prototype;a.constructor=mxGraphSelectionModel;a.doneResource=mxClient.language!="none"?"done":"";a.updatingSelectionResource=mxClient.language!="none"?"updatingSelection":"";a.graph=null;a.singleSelection=false;a.isSingleSelection=function(){return this.singleSelection};
a.setSingleSelection=function(b){this.singleSelection=b};a.isSelected=function(b){if(b!=null)return mxUtils.indexOf(this.cells,b)>=0;return false};a.isEmpty=function(){return this.cells.length==0};a.clear=function(){this.changeSelection(null,this.cells)};a.setCell=function(b){b!=null&&this.setCells([b])};
a.setCells=function(b){if(b!=null){if(this.singleSelection)b=[this.getFirstSelectableCell(b)];for(var d=[],e=0;e<b.length;e++)this.graph.isCellSelectable(b[e])&&d.push(b[e]);this.changeSelection(d,this.cells)}};a.getFirstSelectableCell=function(b){if(b!=null)for(var d=0;d<b.length;d++)if(this.graph.isCellSelectable(b[d]))return b[d];return null};a.addCell=function(b){b!=null&&this.addCells([b])};
a.addCells=function(b){if(b!=null){var d=null;if(this.singleSelection){d=this.cells;b=[this.getFirstSelectableCell(b)]}for(var e=[],f=0;f<b.length;f++)!this.isSelected(b[f])&&this.graph.isCellSelectable(b[f])&&e.push(b[f]);this.changeSelection(e,d)}};a.removeCell=function(b){b!=null&&this.removeCells([b])};a.removeCells=function(b){if(b!=null){for(var d=[],e=0;e<b.length;e++)this.isSelected(b[e])&&d.push(b[e]);this.changeSelection(null,d)}};
a.changeSelection=function(b,d){if(b!=null&&b.length>0&&b[0]!=null||d!=null&&d.length>0&&d[0]!=null){b=new mxSelectionChange(this,b,d);b.execute();d=new mxUndoableEdit(this,false);d.add(b);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",d))}};a.cellAdded=function(b){b!=null&&!this.isSelected(b)&&this.cells.push(b)};a.cellRemoved=function(b){if(b!=null){b=mxUtils.indexOf(this.cells,b);b>=0&&this.cells.splice(b,1)}};
function mxSelectionChange(b,d,e){this.selectionModel=b;this.added=d!=null?d.slice():null;this.removed=e!=null?e.slice():null}
mxSelectionChange.prototype.execute=function(){var b=mxLog.enter("mxSelectionChange.execute");window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource;if(this.removed!=null)for(var d=0;d<this.removed.length;d++)this.selectionModel.cellRemoved(this.removed[d]);if(this.added!=null)for(d=0;d<this.added.length;d++)this.selectionModel.cellAdded(this.added[d]);d=this.added;this.added=this.removed;this.removed=d;window.status=mxResources.get(this.selectionModel.doneResource)||
this.selectionModel.doneResource;mxLog.leave("mxSelectionChange.execute",b);this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed))};
function mxCellEditor(b){this.graph=b;this.textarea=document.createElement("textarea");this.textarea.className="mxCellEditor";this.textarea.style.position="absolute";this.textarea.style.overflow="visible";this.textarea.setAttribute("cols","20");this.textarea.setAttribute("rows","4");if(mxClient.IS_GC)this.textarea.style.resize="none";this.init()}a=mxCellEditor.prototype;a.graph=null;a.textarea=null;a.editingCell=null;a.trigger=null;a.modified=false;a.emptyLabelText="";a.textNode="";
a.init=function(){mxEvent.addListener(this.textarea,"blur",mxUtils.bind(this,function(){this.stopEditing(!this.graph.isInvokesStopCellEditing())}));mxEvent.addListener(this.textarea,"keydown",mxUtils.bind(this,function(b){if(!mxEvent.isConsumed(b))if(b.keyCode==113||this.graph.isEnterStopsCellEditing()&&b.keyCode==13&&!mxEvent.isControlDown(b)&&!mxEvent.isShiftDown(b)){this.graph.stopEditing(false);mxEvent.consume(b)}else if(b.keyCode==27){this.graph.stopEditing(true);mxEvent.consume(b)}else{if(this.clearOnChange){this.clearOnChange=
false;this.textarea.value=""}this.setModified(true)}}))};a.isModified=function(){return this.modified};a.setModified=function(b){this.modified=b};
a.startEditing=function(b,d){this.stopEditing(true);var e=this.graph.getView().getState(b);if(e!=null){this.editingCell=b;this.trigger=d;this.textNode=null;if(e.text!=null&&this.isHideLabel(e)){this.textNode=e.text.node;this.textNode.style.visibility="hidden"}b=this.graph.getView().scale;b=mxUtils.getValue(e.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)*b;var f=mxUtils.getValue(e.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY),g=mxUtils.getValue(e.style,mxConstants.STYLE_TEXTCOLOR,
"black"),h=this.graph.model.isEdge(e.cell)?mxConstants.ALIGN_LEFT:mxUtils.getValue(e.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT),j=(mxUtils.getValue(e.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD;this.textarea.style.fontSize=b;this.textarea.style.fontFamily=f;this.textarea.style.textAlign=h;this.textarea.style.color=g!="white"?g:"black";this.textarea.style.fontWeight=j?"bold":"normal";b=this.getEditorBounds(e);this.textarea.style.left=b.x+"px";this.textarea.style.top=
b.y+"px";this.textarea.style.width=b.width+"px";this.textarea.style.height=b.height+"px";this.textarea.style.zIndex=5;d=this.getInitialValue(e,d);if(d==null||d.length==0){d=this.getEmptyLabelText();this.clearOnChange=true}else this.clearOnChange=false;this.setModified(false);this.textarea.value=d;this.graph.container.appendChild(this.textarea);this.textarea.focus();this.textarea.select()}};
a.stopEditing=function(b){b=b||false;if(this.editingCell!=null){if(this.textNode!=null){this.textNode.style.visibility="visible";this.textNode=null}!b&&this.isModified()&&this.graph.labelChanged(this.editingCell,this.getCurrentValue(),this.trigger);this.trigger=this.editingCell=null;this.textarea.blur();this.textarea.parentNode.removeChild(this.textarea)}};a.getInitialValue=function(b,d){return this.graph.getEditingValue(b.cell,d)};
a.getCurrentValue=function(){return this.textarea.value.replace(/\r/g,"")};a.isHideLabel=function(){return true};
a.getEditorBounds=function(b){var d=this.graph.getModel().isEdge(b.cell),e=this.graph.getView().scale,f=b.text==null?30:b.text.size*e+20,g=this.textarea.style.textAlign=="left"?120:40,h=parseInt(b.style[mxConstants.STYLE_SPACING]||2)*e,j=parseInt(b.style[mxConstants.STYLE_SPACING_TOP]||0)*e+h,k=parseInt(b.style[mxConstants.STYLE_SPACING_RIGHT]||0)*e+h,l=parseInt(b.style[mxConstants.STYLE_SPACING_BOTTOM]||0)*e+h;e=parseInt(b.style[mxConstants.STYLE_SPACING_LEFT]||0)*e+h;k=new mxRectangle(b.x,b.y,Math.max(g,
b.width-e-k),Math.max(f,b.height-j-l));if(d){k.x=b.absoluteOffset.x;k.y=b.absoluteOffset.y;if(b.text!=null&&b.text.boundingBox!=null){if(b.text.boundingBox.x>0)k.x=b.text.boundingBox.x;if(b.text.boundingBox.y>0)k.y=b.text.boundingBox.y}}else if(b.text!=null&&b.text.boundingBox!=null){k.x=Math.min(k.x,b.text.boundingBox.x);k.y=Math.min(k.y,b.text.boundingBox.y)}k.x+=e;k.y+=j;if(b.text!=null&&b.text.boundingBox!=null)if(d){k.width=Math.max(g,b.text.boundingBox.width);k.height=Math.max(f,b.text.boundingBox.height)}else{k.width=
Math.max(k.width,b.text.boundingBox.width);k.height=Math.max(k.height,b.text.boundingBox.height)}if(this.graph.getModel().isVertex(b.cell)){d=mxUtils.getValue(b.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(d==mxConstants.ALIGN_LEFT)k.x-=b.width;else if(d==mxConstants.ALIGN_RIGHT)k.x+=b.width;d=mxUtils.getValue(b.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(d==mxConstants.ALIGN_TOP)k.y-=b.height;else if(d==mxConstants.ALIGN_BOTTOM)k.y+=b.height}return k};
a.getEmptyLabelText=function(){return this.emptyLabelText};a.getEditingCell=function(){return this.editingCell};a.destroy=function(){mxEvent.release(this.textarea);this.textarea.parentNode!=null&&this.textarea.parentNode.removeChild(this.textarea);this.textarea=null};function mxCellRenderer(){this.shapes=mxUtils.clone(this.defaultShapes)}mxCellRenderer.prototype.shapes=null;mxCellRenderer.prototype.defaultEdgeShape=mxPolyline;mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape;
mxCellRenderer.prototype.defaultShapes={};mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ARROW]=mxArrow;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RECTANGLE]=mxRectangleShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ELLIPSE]=mxEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_DOUBLE_ELLIPSE]=mxDoubleEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RHOMBUS]=mxRhombus;
mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_IMAGE]=mxImageShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LINE]=mxLine;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LABEL]=mxLabel;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CYLINDER]=mxCylinder;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_SWIMLANE]=mxSwimlane;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CONNECTOR]=mxConnector;
mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ACTOR]=mxActor;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CLOUD]=mxCloud;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_TRIANGLE]=mxTriangle;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_HEXAGON]=mxHexagon;a=mxCellRenderer.prototype;a.registerShape=function(b,d){this.shapes[b]=d};
a.initialize=function(b){var d=b.view.graph.getModel();if(b.view.graph.container!=null&&b.shape==null&&b.cell!=b.view.currentRoot&&(d.isVertex(b.cell)||d.isEdge(b.cell))){this.createShape(b);if(b.shape!=null){this.initializeShape(b);if(b.view.graph.ordered)b.orderChanged=true;else if(d.isEdge(b.cell))this.orderEdge(b);else if(b.view.graph.keepEdgesInForeground&&this.firstEdge!=null)if(this.firstEdge.parentNode==b.shape.node.parentNode)this.inserState(b,this.firstEdge);else this.firstEdge=null;b.shape.scale=
b.view.scale;this.createCellOverlays(b);this.installListeners(b)}}};a.initializeShape=function(b){b.shape.init(b.view.getDrawPane())};a.getPreviousStateInContainer=function(b,d){var e=null,f=b.view.graph,g=f.getModel();b=b.cell;for(var h=g.getParent(b);h!=null&&e==null;){e=this.findPreviousStateInContainer(f,h,b,d);b=h;h=g.getParent(b)}return e};
a.findPreviousStateInContainer=function(b,d,e,f){var g=null,h=b.getModel();for(e=e!=null?d.getIndex(e)-1:h.getChildCount(d)-1;e>=0&&g==null;e--)g=this.findPreviousStateInContainer(b,h.getChildAt(d,e),null,f);if(g==null){g=b.view.getState(d);if(g!=null&&(g.shape==null||g.shape.node==null||g.shape.node.parentNode!=f))g=null}return g};
a.order=function(b){var d=b.shape.node.parentNode,e=this.getPreviousStateInContainer(b,d),f=d.firstChild;if(e!=null){f=e.shape.node;if(e.text!=null&&e.text.node!=null&&e.text.node.parentNode==d)f=e.text.node;f=f.nextSibling}this.insertState(b,f)};
a.orderEdge=function(b){var d=b.view,e=d.graph.getModel();if(d.graph.keepEdgesInForeground){var f=b.shape.node;if(this.firstEdge==null||this.firstEdge.parentNode==null||this.firstEdge.parentNode!=b.shape.node.parentNode)this.firstEdge=b.shape.node}else if(d.graph.keepEdgesInBackground){f=b.shape.node;var g=f.parentNode;e=e.getParent(b.cell);d=d.getState(e);g=d!=null&&d.shape!=null&&d.shape.node!=null?d.shape.node.nextSibling:g.firstChild;g!=null&&g!=f&&this.insertState(b,g)}};
a.insertState=function(b,d){b.shape.node.parentNode.insertBefore(b.shape.node,d);b.text!=null&&b.text.node!=null&&b.text.node.parentNode==b.shape.node.parentNode&&b.shape.node.parentNode.insertBefore(b.text.node,b.shape.node.nextSibling)};a.createShape=function(b){if(b.style!=null){var d=this.getShapeConstructor(b);b.shape=new d;b.shape.points=b.absolutePoints;b.shape.bounds=new mxRectangle(b.x,b.y,b.width,b.height);b.shape.dialect=b.view.graph.dialect;this.configureShape(b)}};
a.getShapeConstructor=function(b){var d=b.style[mxConstants.STYLE_SHAPE];d=d!=null?this.shapes[d]:null;if(d==null)d=b.view.graph.getModel().isEdge(b.cell)?this.defaultEdgeShape:this.defaultVertexShape;return d};
a.configureShape=function(b){b.shape.apply(b);var d=b.view.graph.getImage(b);if(d!=null)b.shape.image=d;d=b.view.graph.getIndicatorColor(b);var e=b.view.graph.getIndicatorShape(b);e=e!=null?this.shapes[e]:null;if(d!=null){b.shape.indicatorShape=e;b.shape.indicatorColor=d;b.shape.indicatorGradientColor=b.view.graph.getIndicatorGradientColor(b);b.shape.indicatorDirection=b.style[mxConstants.STYLE_INDICATOR_DIRECTION]}else{d=b.view.graph.getIndicatorImage(b);if(d!=null)b.shape.indicatorImage=d}this.postConfigureShape(b)};
a.postConfigureShape=function(b){if(b.shape!=null){this.resolveColor(b,"indicatorColor",mxConstants.STYLE_FILLCOLOR);this.resolveColor(b,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR);this.resolveColor(b,"fill",mxConstants.STYLE_FILLCOLOR);this.resolveColor(b,"stroke",mxConstants.STYLE_STROKECOLOR);this.resolveColor(b,"gradient",mxConstants.STYLE_GRADIENTCOLOR)}};
a.resolveColor=function(b,d,e){var f=b.shape[d],g=b.view.graph,h=null;if(f=="inherit")h=g.model.getParent(b.cell);else if(f=="swimlane"){h=g.model.getTerminal(b.cell,false)!=null?g.model.getTerminal(b.cell,false):b.cell;h=g.getSwimlane(h);e=g.swimlaneIndicatorColorAttribute}else if(f=="indicated")b.shape[d]=b.shape.indicatorColor;if(h!=null){f=g.getView().getState(h);b.shape[d]=null;if(f!=null)b.shape[d]=f.shape!=null&&d!="indicatorColor"?f.shape[d]:f.style[e]}};
a.getLabelValue=function(b){var d=b.view.graph,e=d.getLabel(b.cell);if(!d.isHtmlLabel(b.cell)&&!mxUtils.isNode(e)&&mxClient.IS_IE&&e!=null)e=mxUtils.htmlEntities(e,false);return e};
a.createLabel=function(b,d){var e=b.view.graph;e.getModel().isEdge(b.cell);if(b.style[mxConstants.STYLE_FONTSIZE]>0||b.style[mxConstants.STYLE_FONTSIZE]==null){var f=(e.isHtmlLabel(b.cell)||d!=null&&mxUtils.isNode(d))&&e.dialect==mxConstants.DIALECT_SVG;b.text=new mxText(d,new mxRectangle,b.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER,e.getVerticalAlign(b),b.style[mxConstants.STYLE_FONTCOLOR],b.style[mxConstants.STYLE_FONTFAMILY],b.style[mxConstants.STYLE_FONTSIZE],b.style[mxConstants.STYLE_FONTSTYLE],
b.style[mxConstants.STYLE_SPACING],b.style[mxConstants.STYLE_SPACING_TOP],b.style[mxConstants.STYLE_SPACING_RIGHT],b.style[mxConstants.STYLE_SPACING_BOTTOM],b.style[mxConstants.STYLE_SPACING_LEFT],b.style[mxConstants.STYLE_HORIZONTAL],b.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],b.style[mxConstants.STYLE_LABEL_BORDERCOLOR],e.isWrapping(b.cell),e.isLabelClipped(b.cell),b.style[mxConstants.STYLE_OVERFLOW]);b.text.opacity=b.style[mxConstants.STYLE_TEXT_OPACITY];b.text.dialect=f?mxConstants.DIALECT_STRICTHTML:
b.view.graph.dialect;this.initializeLabel(b);var g=function(h){var j=b;if(mxClient.IS_TOUCH){j=mxEvent.getClientX(h);h=mxEvent.getClientY(h);h=mxUtils.convertPoint(e.container,j,h);j=e.view.getState(e.getCellAt(h.x,h.y))}return j};d=mxClient.IS_TOUCH?"touchmove":"mousemove";f=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(b.text.node,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(h){this.isLabelEvent(b,h)&&e.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(h,b))}));
mxEvent.addListener(b.text.node,d,mxUtils.bind(this,function(h){this.isLabelEvent(b,h)&&e.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(h,g(h)))}));mxEvent.addListener(b.text.node,f,mxUtils.bind(this,function(h){this.isLabelEvent(b,h)&&e.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(h,g(h)))}));mxEvent.addListener(b.text.node,"dblclick",mxUtils.bind(this,function(h){if(this.isLabelEvent(b,h)){e.dblClick(h,b.cell);mxEvent.consume(h)}}))}};
a.initializeLabel=function(b){var d=b.view.graph;if(b.text.dialect!=mxConstants.DIALECT_SVG)if(mxClient.IS_NS&&mxClient.NO_FO)b.text.init(d.container);else if(mxUtils.isVml(b.view.getDrawPane()))b.shape.label!=null?b.text.init(b.shape.label):b.text.init(b.shape.node);if(b.text.node==null){b.text.init(b.view.getDrawPane());b.shape!=null&&b.text!=null&&b.shape.node.parentNode.insertBefore(b.text.node,b.shape.node.nextSibling)}};
a.createCellOverlays=function(b){var d=b.view.graph.getCellOverlays(b.cell);if(d!=null){b.overlays=[];for(var e=0;e<d.length;e++){var f=new mxImageShape(new mxRectangle,d[e].image.src);f.dialect=b.view.graph.dialect;this.initializeOverlay(b,f);f.node.style.cursor="help";this.installCellOverlayListeners(b,d[e],f);b.overlays.push(f)}}};a.initializeOverlay=function(b,d){d.init(b.view.getOverlayPane())};
a.installCellOverlayListeners=function(b,d,e){var f=b.view.graph;mxEvent.addListener(e.node,"click",function(h){d.fireEvent(new mxEventObject(mxEvent.CLICK,"event",h,"cell",b.cell))});var g=mxClient.IS_TOUCH?"touchmove":"mousemove";mxEvent.addListener(e.node,mxClient.IS_TOUCH?"touchstart":"mousedown",function(h){mxEvent.consume(h)});mxEvent.addListener(e.node,g,function(h){f.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(h,b))})};
a.createControl=function(b){var d=b.view.graph,e=d.getFoldingImage(b);if(d.foldingEnabled&&e!=null){if(b.control==null){var f=new mxRectangle(0,0,e.width,e.height);b.control=new mxImageShape(f,e.src);b.control.dialect=b.view.graph.dialect;if(d.isHtmlLabel(b.cell)&&mxClient.NO_FO&&d.dialect==mxConstants.DIALECT_SVG){b.control.dialect=mxConstants.DIALECT_PREFERHTML;b.control.init(d.container);b.control.node.style.zIndex=1}else b.control.init(b.view.getOverlayPane());e=b.control.innerNode||b.control.node;
if(d.isEnabled())e.style.cursor="pointer";mxEvent.addListener(e,"click",function(g){if(d.isEnabled()){var h=!d.isCellCollapsed(b.cell);d.foldCells(h,false,[b.cell]);mxEvent.consume(g)}});f=mxClient.IS_TOUCH?"touchmove":"mousemove";mxEvent.addListener(e,mxClient.IS_TOUCH?"touchstart":"mousedown",function(g){d.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(g,b));mxEvent.consume(g)});mxEvent.addListener(e,f,function(g){d.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(g,b))})}}else if(b.control!=
null){b.control.destroy();b.control=null}};a.isShapeEvent=function(){return true};a.isLabelEvent=function(){return true};
a.installListeners=function(b){var d=b.view.graph;if(d.dialect==mxConstants.DIALECT_SVG){var e="all";if(d.getModel().isEdge(b.cell)&&b.shape.stroke!=null&&b.shape.fill==null)e="visibleStroke";b.shape.innerNode!=null?b.shape.innerNode.setAttribute("pointer-events",e):b.shape.node.setAttribute("pointer-events",e)}var f=function(k){var l=b;if(mxClient.IS_TOUCH){l=mxEvent.getClientX(k);k=mxEvent.getClientY(k);k=mxUtils.convertPoint(d.container,l,k);l=d.view.getState(d.getCellAt(k.x,k.y))}return l},g=
false;mxEvent.addListener(b.shape.node,"gesturestart",mxUtils.bind(this,function(k){d.lastTouchTime=0;g=true;mxEvent.consume(k)}));e=mxClient.IS_TOUCH?"touchmove":"mousemove";var h=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(b.shape.node,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(k){if(this.isShapeEvent(b,k)&&!g)d.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(k,b.shape!=null&&mxEvent.getSource(k)==b.shape.content?null:b));else g&&mxEvent.consume(k)}));
mxEvent.addListener(b.shape.node,e,mxUtils.bind(this,function(k){if(this.isShapeEvent(b,k)&&!g)d.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(k,b.shape!=null&&mxEvent.getSource(k)==b.shape.content?null:f(k)));else g&&mxEvent.consume(k)}));mxEvent.addListener(b.shape.node,h,mxUtils.bind(this,function(k){if(this.isShapeEvent(b,k)&&!g)d.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(k,b.shape!=null&&mxEvent.getSource(k)==b.shape.content?null:f(k)));else g&&mxEvent.consume(k)}));var j=mxClient.IS_TOUCH?
"gestureend":"dblclick";mxEvent.addListener(b.shape.node,j,mxUtils.bind(this,function(k){g=false;if(j=="gestureend"){d.lastTouchTime=0;if(d.gestureEnabled){d.handleGesture(b,k);mxEvent.consume(k)}}else if(this.isShapeEvent(b,k)){d.dblClick(k,b.shape!=null&&mxEvent.getSource(k)==b.shape.content?null:b.cell);mxEvent.consume(k)}}))};
a.redrawLabel=function(b){var d=this.getLabelValue(b);if(b.text==null&&d!=null&&d.length>0)this.createLabel(b,d);else if(b.text!=null&&(d==null||d.length==0)){b.text.destroy();b.text=null}if(b.text!=null){var e=b.view.graph,f=e.isWrapping(b.cell);e=e.isLabelClipped(b.cell);var g=this.getLabelBounds(b);if(b.text.value!=d||b.text.isWrapping!=f||b.text.isClipping!=e||b.text.scale!=b.view.scale||!b.text.bounds.equals(g)){b.text.value=d;b.text.bounds=g;b.text.scale=b.view.scale;b.text.isWrapping=f;b.text.isClipping=
e;b.text.redraw()}}};a.getLabelBounds=function(b){var d=b.view.graph,e=d.getModel().isEdge(b.cell),f=new mxRectangle(b.absoluteOffset.x,b.absoluteOffset.y);if(!e){f.x+=b.shape.bounds.x;f.y+=b.shape.bounds.y;f.width=Math.max(1,b.shape.bounds.width);f.height=Math.max(1,b.shape.bounds.height);if(d.isSwimlane(b.cell)){e=d.view.scale;b=d.getStartSize(b.cell);if(b.width>0)f.width=b.width*e;else if(b.height>0)f.height=b.height*e}}return f};
a.redrawCellOverlays=function(b){var d=b.view.graph.getCellOverlays(b.cell),e=b.overlays!=null?b.overlays.length:0,f=d!=null?d.length:0;if(e!=f){if(e>0){for(e=0;e<b.overlays.length;e++)b.overlays[e].destroy();b.overlays=null}f>0&&this.createCellOverlays(b)}if(b.overlays!=null)for(e=0;e<d.length;e++){f=d[e].getBounds(b);if(b.overlays[e].bounds==null||b.overlays[e].scale!=b.view.scale||!b.overlays[e].bounds.equals(f)){b.overlays[e].bounds=f;b.overlays[e].scale=b.view.scale;b.overlays[e].redraw()}}};
a.redrawControl=function(b){if(b.control!=null){var d=this.getControlBounds(b),e=b.view.scale;if(b.control.scale!=e||!b.control.bounds.equals(d)){b.control.bounds=d;b.control.scale=e;b.control.redraw()}}};
a.getControlBounds=function(b){if(b.control!=null){var d=b.control.scale,e=b.control.bounds.width/d;d=b.control.bounds.height/d;var f=b.view.scale;return b.view.graph.getModel().isEdge(b.cell)?new mxRectangle(b.x+b.width/2-e/2*f,b.y+b.height/2-d/2*f,e*f,d*f):new mxRectangle(b.x+e/2*f,b.y+d/2*f,e*f,d*f)}return null};
a.redraw=function(b){if(b.shape!=null){b.view.graph.getModel().isEdge(b.cell);var d=false;this.createControl(b);if(b.shape.bounds==null||b.shape.scale!=b.view.scale||!b.shape.bounds.equals(b)||!mxUtils.equalPoints(b.shape.points,b.absolutePoints)){b.shape.points=b.absolutePoints!=null?b.absolutePoints.slice():null;b.shape.bounds=new mxRectangle(b.x,b.y,b.width,b.height);b.shape.scale=b.view.scale;b.shape.redraw()}this.redrawLabel(b);this.redrawCellOverlays(b);this.redrawControl(b);if(b.orderChanged&&
b.view.graph.ordered){this.order(b);d=true}delete b.orderChanged;if(!mxUtils.equalEntries(b.shape.style,b.style)){b.shape.apply(b);d=true}if(d){this.configureShape(b);b.shape.reconfigure()}}};a.destroy=function(b){if(b.shape!=null){if(b.text!=null){b.text.destroy();b.text=null}if(b.overlays!=null){for(var d=0;d<b.overlays.length;d++)b.overlays[d].destroy();b.overlays=null}if(b.control!=null){b.control.destroy();b.control=null}b.shape.destroy();b.shape=null}};
var mxEdgeStyle={EntityRelation:function(b,d,e,f,g){var h=b.view,j=h.graph;f=mxUtils.getValue(b.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*h.scale;b=b.absolutePoints;var k=b[0],l=b[b.length-1];b=false;if(k!=null){d=new mxCellState;d.x=k.x;d.y=k.y}else if(d!=null){k=j.getCellGeometry(d.cell);if(k.relative)b=k.x<=0.5;else if(e!=null)b=e.x+e.width<d.x}else return;k=true;if(l!=null){e=new mxCellState;e.x=l.x;e.y=l.y}else if(e!=null){j=j.getCellGeometry(e.cell);if(j.relative)k=j.x<=0.5;
else if(d!=null)k=d.x+d.width<e.x}if(d!=null&&e!=null){j=b?d.x:d.x+d.width;d=h.getRoutingCenterY(d);l=k?e.x:e.x+e.width;e=h.getRoutingCenterY(e);var m=b?-f:f;h=new mxPoint(j+m,d);m=k?-f:f;m=new mxPoint(l+m,e);if(b==k){f=b?Math.min(j,l)-f:Math.max(j,l)+f;g.push(new mxPoint(f,d));g.push(new mxPoint(f,e))}else{if(h.x<m.x==b){f=d+(e-d)/2;g.push(h);g.push(new mxPoint(h.x,f));g.push(new mxPoint(m.x,f))}else g.push(h);g.push(m)}}},Loop:function(b,d,e,f,g){if(d!=null){e=b.view;var h=e.graph;f=f!=null&&f.length>
0?f[0]:null;if(f!=null){f=e.transformControlPoint(b,f);if(mxUtils.contains(d,f.x,f.y))f=null}var j=0,k=0,l=0,m=0;h=mxUtils.getValue(b.style,mxConstants.STYLE_SEGMENT,h.gridSize)*e.scale;b=mxUtils.getValue(b.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST);if(b==mxConstants.DIRECTION_NORTH||b==mxConstants.DIRECTION_SOUTH){j=e.getRoutingCenterX(d);k=h}else{l=e.getRoutingCenterY(d);m=h}if(f==null||f.x<d.x||f.x>d.x+d.width)if(f!=null){j=f.x;m=Math.max(Math.abs(l-f.y),m)}else if(b==mxConstants.DIRECTION_NORTH)l=
d.y-2*k;else if(b==mxConstants.DIRECTION_SOUTH)l=d.y+d.height+2*k;else j=b==mxConstants.DIRECTION_EAST?d.x-2*m:d.x+d.width+2*m;else if(f!=null){j=e.getRoutingCenterX(d);k=Math.max(Math.abs(j-f.x),m);l=f.y;m=0}g.push(new mxPoint(j-k,l-m));g.push(new mxPoint(j+k,l+m))}},ElbowConnector:function(b,d,e,f,g){var h=f!=null&&f.length>0?f[0]:null,j=false,k=false;if(d!=null&&e!=null)if(h!=null){var l=Math.min(d.x,e.x),m=Math.max(d.x+d.width,e.x+e.width);k=Math.min(d.y,e.y);var n=Math.max(d.y+d.height,e.y+e.height);
h=b.view.transformControlPoint(b,h);j=h.y<k||h.y>n;k=h.x<l||h.x>m}else{l=Math.max(d.x,e.x);m=Math.min(d.x+d.width,e.x+e.width);j=l==m;if(!j){k=Math.max(d.y,e.y);n=Math.min(d.y+d.height,e.y+e.height);k=k==n}}!k&&(j||b.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)?mxEdgeStyle.TopToBottom(b,d,e,f,g):mxEdgeStyle.SideToSide(b,d,e,f,g)},SideToSide:function(b,d,e,f,g){var h=b.view;f=f!=null&&f.length>0?f[0]:null;var j=b.absolutePoints,k=j[0];j=j[j.length-1];if(f!=null)f=h.transformControlPoint(b,
f);if(k!=null){d=new mxCellState;d.x=k.x;d.y=k.y}if(j!=null){e=new mxCellState;e.x=j.x;e.y=j.y}if(d!=null&&e!=null){b=Math.max(d.x,e.x);var l=Math.min(d.x+d.width,e.x+e.width);b=f!=null?f.x:l+(b-l)/2;l=h.getRoutingCenterY(d);h=h.getRoutingCenterY(e);if(f!=null){if(k!=null&&f.y>=d.y&&f.y<=d.y+d.height)l=f.y;if(j!=null&&f.y>=e.y&&f.y<=e.y+e.height)h=f.y}!mxUtils.contains(e,b,l)&&!mxUtils.contains(d,b,l)&&g.push(new mxPoint(b,l));!mxUtils.contains(e,b,h)&&!mxUtils.contains(d,b,h)&&g.push(new mxPoint(b,
h));if(g.length==1)if(f!=null)!mxUtils.contains(e,b,f.y)&&!mxUtils.contains(d,b,f.y)&&g.push(new mxPoint(b,f.y));else{h=Math.max(d.y,e.y);d=Math.min(d.y+d.height,e.y+e.height);g.push(new mxPoint(b,h+(d-h)/2))}}},TopToBottom:function(b,d,e,f,g){var h=b.view;f=f!=null&&f.length>0?f[0]:null;var j=b.absolutePoints,k=j[0];j=j[j.length-1];if(f!=null)f=h.transformControlPoint(b,f);if(k!=null){d=new mxCellState;d.x=k.x;d.y=k.y}if(j!=null){e=new mxCellState;e.x=j.x;e.y=j.y}if(d!=null&&e!=null){k=Math.max(d.y,
e.y);j=Math.min(d.y+d.height,e.y+e.height);b=h.getRoutingCenterX(d);if(f!=null&&f.x>=d.x&&f.x<=d.x+d.width)b=f.x;k=f!=null?f.y:j+(k-j)/2;!mxUtils.contains(e,b,k)&&!mxUtils.contains(d,b,k)&&g.push(new mxPoint(b,k));b=f!=null&&f.x>=e.x&&f.x<=e.x+e.width?f.x:h.getRoutingCenterX(e);!mxUtils.contains(e,b,k)&&!mxUtils.contains(d,b,k)&&g.push(new mxPoint(b,k));if(g.length==1)if(f!=null&&g.length==1)!mxUtils.contains(e,f.x,k)&&!mxUtils.contains(d,f.x,k)&&g.push(new mxPoint(f.x,k));else{h=Math.max(d.x,e.x);
d=Math.min(d.x+d.width,e.x+e.width);g.push(new mxPoint(h+(d-h)/2,k))}}}},mxStyleRegistry={values:[],putValue:function(b,d){mxStyleRegistry.values[b]=d},getValue:function(b){return mxStyleRegistry.values[b]},getName:function(b){for(var d in mxStyleRegistry.values)if(mxStyleRegistry.values[d]==b)return d;return null}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation);
mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom);mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter);
mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter);function mxGraphView(b){this.graph=b;this.translate=new mxPoint;this.graphBounds=new mxRectangle;this.states=new mxDictionary}mxGraphView.prototype=new mxEventSource;a=mxGraphView.prototype;a.constructor=mxGraphView;a.EMPTY_POINT=new mxPoint;a.doneResource=mxClient.language!="none"?"done":"";a.updatingDocumentResource=mxClient.language!="none"?"updatingDocument":"";a.allowEval=false;a.captureDocumentGesture=true;
a.rendering=true;a.graph=null;a.currentRoot=null;a.graphBounds=null;a.scale=1;a.translate=null;a.updateStyle=false;a.getGraphBounds=function(){return this.graphBounds};a.setGraphBounds=function(b){this.graphBounds=b};a.getBounds=function(b){var d=null;if(b!=null&&b.length>0)for(var e=this.graph.getModel(),f=0;f<b.length;f++)if(e.isVertex(b[f])||e.isEdge(b[f])){var g=this.getState(b[f]);if(g!=null)if(d==null)d=new mxRectangle(g.x,g.y,g.width,g.height);else d.add(g)}return d};
a.setCurrentRoot=function(b){if(this.currentRoot!=b){var d=new mxCurrentRootChange(this,b);d.execute();var e=new mxUndoableEdit(this,false);e.add(d);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",e));this.graph.sizeDidChange()}return b};
a.scaleAndTranslate=function(b,d,e){var f=this.scale,g=new mxPoint(this.translate.x,this.translate.y);if(this.scale!=b||this.translate.x!=d||this.translate.y!=e){this.scale=b;this.translate.x=d;this.translate.y=e;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",b,"previousScale",f,"translate",this.translate,"previousTranslate",g))};a.getScale=function(){return this.scale};
a.setScale=function(b){var d=this.scale;if(this.scale!=b){this.scale=b;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",b,"previousScale",d))};a.getTranslate=function(){return this.translate};
a.setTranslate=function(b,d){var e=new mxPoint(this.translate.x,this.translate.y);if(this.translate.x!=b||this.translate.y!=d){this.translate.x=b;this.translate.y=d;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",e))};a.refresh=function(){this.currentRoot!=null&&this.clear();this.revalidate()};a.revalidate=function(){this.invalidate();this.validate()};
a.clear=function(b,d,e){var f=this.graph.getModel();b=b||f.getRoot();d=d!=null?d:false;e=e!=null?e:true;this.removeState(b);if(e&&(d||b!=this.currentRoot)){e=f.getChildCount(b);for(var g=0;g<e;g++)this.clear(f.getChildAt(b,g),d)}else this.invalidate(b)};
a.invalidate=function(b,d,e,f){var g=this.graph.getModel();b=b||g.getRoot();d=d!=null?d:true;e=e!=null?e:true;f=f!=null?f:false;var h=this.getState(b);if(h!=null){h.invalid=true;if(f)h.orderChanged=true}if(d){h=g.getChildCount(b);for(f=0;f<h;f++)this.invalidate(g.getChildAt(b,f),d,e)}if(e){e=g.getEdgeCount(b);for(f=0;f<e;f++)this.invalidate(g.getEdgeAt(b,f),d,false)}};
a.validate=function(b){var d=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;b=b||(this.currentRoot!=null?this.currentRoot:this.graph.getModel().getRoot());this.validateBounds(null,b);b=this.validatePoints(null,b);if(b==null)b=new mxRectangle;this.setGraphBounds(b);this.validateBackground();window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",d)};
a.validateBackground=function(){var b=this.graph.getBackgroundImage();if(b!=null){if(this.backgroundImage==null||this.backgroundImage.image!=b.src){this.backgroundImage!=null&&this.backgroundImage.destroy();var d=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(d,b.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane)}this.redrawBackgroundImage(this.backgroundImage,b)}else if(this.backgroundImage!=null){this.backgroundImage.destroy();this.backgroundImage=
null}if(this.graph.pageVisible){b=this.graph.pageFormat;d=this.scale*this.graph.pageScale;d=new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,b.width*d,b.height*d);if(this.backgroundPageShape==null){this.backgroundPageShape=new mxRectangleShape(d,"white","black");this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.isShadow=true;this.backgroundPageShape.dialect=this.graph.dialect;this.backgroundPageShape.init(this.backgroundPane);mxEvent.addListener(this.backgroundPageShape.node,
"dblclick",mxUtils.bind(this,function(e){this.graph.dblClick(e)}));b=mxClient.IS_TOUCH?"touchmove":"mousemove";d=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(this.backgroundPageShape.node,mxClient.IS_TOUCH?"touchstart":"mousedown",mxUtils.bind(this,function(e){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(e))}));mxEvent.addListener(this.backgroundPageShape.node,b,mxUtils.bind(this,function(e){this.graph.tooltipHandler!=null&&this.graph.tooltipHandler.isHideOnHover()&&
this.graph.tooltipHandler.hide();this.graph.isMouseDown&&!mxEvent.isConsumed(e)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e))}));mxEvent.addListener(this.backgroundPageShape.node,d,mxUtils.bind(this,function(e){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(e))}))}else{this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.bounds=d;this.backgroundPageShape.redraw()}}else if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=
null}};a.redrawBackgroundImage=function(b,d){b.scale=this.scale;b.bounds.x=this.scale*this.translate.x;b.bounds.y=this.scale*this.translate.y;b.bounds.width=this.scale*d.width;b.bounds.height=this.scale*d.height;b.redraw()};
a.validateBounds=function(b,d){var e=this.graph.getModel(),f=this.getState(d,true);if(f!=null&&f.invalid){if(this.graph.isCellVisible(d)){if(d!=this.currentRoot&&b!=null){f.absoluteOffset.x=0;f.absoluteOffset.y=0;f.origin.x=b.origin.x;f.origin.y=b.origin.y;var g=this.graph.getCellGeometry(d);if(g!=null){if(!e.isEdge(d)){var h=g.offset||this.EMPTY_POINT;if(g.relative){f.origin.x+=g.x*b.width/this.scale+h.x;f.origin.y+=g.y*b.height/this.scale+h.y}else{f.absoluteOffset.x=this.scale*h.x;f.absoluteOffset.y=
this.scale*h.y;f.origin.x+=g.x;f.origin.y+=g.y}}f.x=this.scale*(this.translate.x+f.origin.x);f.y=this.scale*(this.translate.y+f.origin.y);f.width=this.scale*g.width;f.height=this.scale*g.height;e.isVertex(d)&&this.updateVertexLabelOffset(f)}}}else this.removeState(d);h=this.graph.getChildOffsetForCell(d);if(h!=null){f.origin.x+=h.x;f.origin.y+=h.y}}if(f!=null&&(!this.graph.isCellCollapsed(d)||d==this.currentRoot)){b=e.getChildCount(d);for(g=0;g<b;g++){h=e.getChildAt(d,g);this.validateBounds(f,h)}}};
a.updateVertexLabelOffset=function(b){var d=mxUtils.getValue(b.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(d==mxConstants.ALIGN_LEFT)b.absoluteOffset.x-=b.width;else if(d==mxConstants.ALIGN_RIGHT)b.absoluteOffset.x+=b.width;d=mxUtils.getValue(b.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(d==mxConstants.ALIGN_TOP)b.absoluteOffset.y-=b.height;else if(d==mxConstants.ALIGN_BOTTOM)b.absoluteOffset.y+=b.height};
a.validatePoints=function(b,d){var e=this.graph.getModel(),f=this.getState(d),g=null;if(f!=null){if(f.invalid){var h=this.graph.getCellGeometry(d);if(h!=null&&e.isEdge(d)){b=this.getState(this.getVisibleTerminal(d,true));if(b!=null&&e.isEdge(b.cell)&&!e.isAncestor(b.cell,d)){var j=this.getState(e.getParent(b.cell));this.validatePoints(j,b.cell)}var k=this.getState(this.getVisibleTerminal(d,false));if(k!=null&&e.isEdge(k.cell)&&!e.isAncestor(k.cell,d)){j=this.getState(e.getParent(k.cell));this.validatePoints(j,
k.cell)}this.updateFixedTerminalPoints(f,b,k);this.updatePoints(f,h.points,b,k);this.updateFloatingTerminalPoints(f,b,k);this.updateEdgeBounds(f);this.updateEdgeLabelOffset(f)}else if(h!=null&&h.relative&&b!=null&&e.isEdge(b.cell)){h=this.getPoint(b,h);if(h!=null){f.x=h.x;f.y=h.y;h.x=h.x/this.scale-this.translate.x;h.y=h.y/this.scale-this.translate.y;f.origin=h;this.childMoved(b,f)}}f.invalid=false;this.isRendering()&&d!=this.currentRoot&&this.graph.cellRenderer.redraw(f)}if(e.isEdge(d)||e.isVertex(d)){g=
new mxRectangle(f.x,f.y,f.width,f.height);h=f.text!=null&&!this.graph.isLabelClipped(f.cell)?f.text.boundingBox:null;h!=null&&g.add(h)}}if(f!=null&&(!this.graph.isCellCollapsed(d)||d==this.currentRoot)){h=e.getChildCount(d);for(b=0;b<h;b++){j=e.getChildAt(d,b);j=this.validatePoints(f,j);if(j!=null)if(g==null)g=j;else g.add(j)}}return g};
a.childMoved=function(b,d){b=d.cell;if(!this.graph.isCellCollapsed(b)||b==this.currentRoot)for(var e=this.graph.getModel(),f=e.getChildCount(b),g=0;g<f;g++)this.validateBounds(d,e.getChildAt(b,g))};a.updateFixedTerminalPoints=function(b,d,e){this.updateFixedTerminalPoint(b,d,true,this.graph.getConnectionConstraint(b,d,true));this.updateFixedTerminalPoint(b,e,false,this.graph.getConnectionConstraint(b,e,false))};
a.updateFixedTerminalPoint=function(b,d,e,f){var g=null;if(f!=null)g=this.graph.getConnectionPoint(d,f);if(g==null&&d==null){d=this.scale;f=this.translate;var h=b.origin;g=this.graph.getCellGeometry(b.cell).getTerminalPoint(e);if(g!=null)g=new mxPoint(d*(f.x+g.x+h.x),d*(f.y+g.y+h.y))}b.setAbsoluteTerminalPoint(g,e)};
a.updatePoints=function(b,d,e,f){if(b!=null){var g=[];g.push(b.absolutePoints[0]);var h=this.getEdgeStyle(b,d,e,f);if(h!=null){e=this.getTerminalPort(b,e,true);f=this.getTerminalPort(b,f,false);h(b,e,f,d,g)}else if(d!=null)for(h=0;h<d.length;h++)if(d[h]!=null){f=mxUtils.clone(d[h]);g.push(this.transformControlPoint(b,f))}d=b.absolutePoints;g.push(d[d.length-1]);b.absolutePoints=g}};
a.transformControlPoint=function(b,d){b=b.origin;return new mxPoint(this.scale*(d.x+this.translate.x+b.x),this.scale*(d.y+this.translate.y+b.y))};
a.getEdgeStyle=function(b,d,e,f){b=e!=null&&e==f?mxUtils.getValue(b.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):!mxUtils.getValue(b.style,mxConstants.STYLE_NOEDGESTYLE,false)?b.style[mxConstants.STYLE_EDGE]:null;if(typeof b=="string"){d=mxStyleRegistry.getValue(b);if(d==null&&this.isAllowEval())d=mxUtils.eval(b);b=d}if(typeof b=="function")return b;return null};
a.updateFloatingTerminalPoints=function(b,d,e){var f=b.absolutePoints,g=f[0];f[f.length-1]==null&&e!=null&&this.updateFloatingTerminalPoint(b,e,d,false);g==null&&d!=null&&this.updateFloatingTerminalPoint(b,d,e,true)};
a.updateFloatingTerminalPoint=function(b,d,e,f){d=this.getTerminalPort(b,d,f);e=this.getNextPoint(b,e,f);var g=parseFloat(b.style[mxConstants.STYLE_PERIMETER_SPACING]||0);g+=parseFloat(b.style[f?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0);d=this.getPerimeterPoint(d,e,this.graph.isOrthogonal(b),g);b.setAbsoluteTerminalPoint(d,f)};
a.getTerminalPort=function(b,d,e){b=mxUtils.getValue(b.style,e?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT);if(b!=null){b=this.getState(this.graph.getModel().getCell(b));if(b!=null)d=b}return d};a.getPerimeterPoint=function(b,d,e,f){var g=null;if(b!=null){var h=this.getPerimeterFunction(b);if(h!=null&&d!=null){f=this.getPerimeterBounds(b,f);if(f.width>0||f.height>0)g=h(f,b,d,e)}if(g==null)g=this.getPoint(b)}return g};
a.getRoutingCenterX=function(b){var d=b.style!=null?parseFloat(b.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return b.getCenterX()+d*b.width};a.getRoutingCenterY=function(b){var d=b.style!=null?parseFloat(b.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return b.getCenterY()+d*b.height};a.getPerimeterBounds=function(b,d){d=d!=null?d:0;if(b!=null)d+=parseFloat(b.style[mxConstants.STYLE_PERIMETER_SPACING]||0);return b.getPerimeterBounds(d*this.scale)};
a.getPerimeterFunction=function(b){b=b.style[mxConstants.STYLE_PERIMETER];if(typeof b=="string"){var d=mxStyleRegistry.getValue(b);if(d==null&&this.isAllowEval())d=mxUtils.eval(b);b=d}if(typeof b=="function")return b;return null};a.getNextPoint=function(b,d,e){b=b.absolutePoints;var f=null;if(b!=null&&(e||b.length>2||d==null)){f=b.length;f=b[e?Math.min(1,f-1):Math.max(0,f-2)]}if(f==null&&d!=null)f=new mxPoint(d.getCenterX(),d.getCenterY());return f};
a.getVisibleTerminal=function(b,d){var e=this.graph.getModel();for(d=b=e.getTerminal(b,d);b!=null&&b!=this.currentRoot;){if(!this.graph.isCellVisible(d)||this.graph.isCellCollapsed(b))d=b;b=e.getParent(b)}if(e.getParent(d)==e.getRoot())d=null;return d};
a.updateEdgeBounds=function(b){var d=b.absolutePoints;b.length=0;if(d!=null&&d.length>0){var e=d[0],f=d[d.length-1];if(e==null||f==null)this.clear(b.cell,true);else{if(e.x!=f.x||e.y!=f.y){var g=f.x-e.x,h=f.y-e.y;b.terminalDistance=Math.sqrt(g*g+h*h)}else b.terminalDistance=0;f=0;var j=[];h=e;if(h!=null){e=h.x;for(var k=h.y,l=e,m=k,n=1;n<d.length;n++){var o=d[n];if(o!=null){g=h.x-o.x;h=h.y-o.y;g=Math.sqrt(g*g+h*h);j.push(g);f+=g;h=o;e=Math.min(h.x,e);k=Math.min(h.y,k);l=Math.max(h.x,l);m=Math.max(h.y,
m)}}b.length=f;b.segments=j;b.x=e;b.y=k;b.width=Math.max(1,l-e);b.height=Math.max(1,m-k)}}}};
a.getPoint=function(b,d){var e=b.getCenterX(),f=b.getCenterY();if(b.segments!=null&&(d==null||d.relative)){for(var g=b.absolutePoints.length,h=((d!=null?d.x/2:0)+0.5)*b.length,j=b.segments[0],k=0,l=1;h>k+j&&l<g-1;){k+=j;j=b.segments[l++]}if(j!=0){g=(h-k)/j;h=b.absolutePoints[l-1];l=b.absolutePoints[l];if(h!=null&&l!=null){b=e=f=0;if(d!=null){f=d.y;d=d.offset;if(d!=null){e=d.x;b=d.y}}d=l.x-h.x;l=l.y-h.y;k=d/j;e=h.x+d*g+(l/j*f+e)*this.scale;f=h.y+l*g-(k*f-b)*this.scale}}}else if(d!=null){d=d.offset;
if(d!=null){e+=d.x;f+=d.y}}return new mxPoint(e,f)};
a.getRelativePoint=function(b,d,e){var f=this.graph.getModel().getGeometry(b.cell);if(f!=null){var g=b.absolutePoints.length;if(f.relative&&g>1){f=b.length;for(var h=b.segments,j=b.absolutePoints[0],k=b.absolutePoints[1],l=mxUtils.ptSegDistSq(j.x,j.y,k.x,k.y,d,e),m=0,n=0,o=0,p=2;p<g;p++){n+=h[p-2];k=b.absolutePoints[p];j=mxUtils.ptSegDistSq(j.x,j.y,k.x,k.y,d,e);if(j<=l){l=j;m=p-1;o=n}j=k}g=h[m];j=b.absolutePoints[m];k=b.absolutePoints[m+1];n=k.x;p=k.y;h=d;l=e;b=j.x-n;m=j.y-p;h-=n;l-=p;n=0;h=b-h;l=
m-l;h=h*b+l*m;n=h<=0?0:h*h/(b*b+m*m);b=Math.sqrt(n);if(b>g)b=g;g=Math.sqrt(mxUtils.ptSegDistSq(j.x,j.y,k.x,k.y,d,e));if(mxUtils.relativeCcw(j.x,j.y,k.x,k.y,d,e)==-1)g=-g;return new mxPoint((f/2-o-b)/f*-2,g/this.scale)}}return new mxPoint};
a.updateEdgeLabelOffset=function(b){var d=b.absolutePoints;b.absoluteOffset.x=b.getCenterX();b.absoluteOffset.y=b.getCenterY();if(d!=null&&d.length>0&&b.segments!=null){var e=this.graph.getCellGeometry(b.cell);if(e.relative){var f=this.getPoint(b,e);if(f!=null)b.absoluteOffset=f}else{f=d[0];var g=d[d.length-1];if(f!=null&&g!=null){d=g.x-f.x;var h=g.y-f.y;var j=g=0;e=e.offset;if(e!=null){g=e.x;j=e.y}e=f.y+h/2+j*this.scale;b.absoluteOffset.x=f.x+d/2+g*this.scale;b.absoluteOffset.y=e}}}};
a.getState=function(b,d){d=d||false;var e=null;if(b!=null){e=this.states.get(b);if(this.graph.isCellVisible(b))if(e==null&&d&&this.graph.isCellVisible(b)){e=this.createState(b);this.states.put(b,e)}else if(d&&e!=null&&this.updateStyle)e.style=this.graph.getCellStyle(b)}return e};a.isRendering=function(){return this.rendering};a.setRendering=function(b){this.rendering=b};a.isAllowEval=function(){return this.allowEval};a.setAllowEval=function(b){this.allowEval=b};a.getStates=function(){return this.states};
a.setStates=function(b){this.states=b};a.getCellStates=function(b){if(b==null)return this.states;else{for(var d=[],e=0;e<b.length;e++){var f=this.getState(b[e]);f!=null&&d.push(f)}return d}};a.removeState=function(b){var d=null;if(b!=null){d=this.states.remove(b);if(d!=null){this.graph.cellRenderer.destroy(d);d.destroy()}}return d};a.createState=function(b){var d=this.graph.getCellStyle(b);b=new mxCellState(this,b,d);this.isRendering()&&this.graph.cellRenderer.initialize(b);return b};
a.getCanvas=function(){return this.canvas};a.getBackgroundPane=function(){return this.backgroundPane};a.getDrawPane=function(){return this.drawPane};a.getOverlayPane=function(){return this.overlayPane};a.isContainerEvent=function(b){b=mxEvent.getSource(b);return b==this.graph.container||b.parentNode==this.backgroundPane||b.parentNode!=null&&b.parentNode.parentNode==this.backgroundPane||b==this.canvas.parentNode||b==this.canvas||b==this.backgroundPane||b==this.drawPane||b==this.overlayPane};
a.isScrollEvent=function(b){var d=mxUtils.getOffset(this.graph.container);b=new mxPoint(b.clientX-d.x,b.clientY-d.y);d=this.graph.container.offsetWidth;var e=this.graph.container.clientWidth;if(d>e&&b.x>e+2&&b.x<=d)return true;d=this.graph.container.offsetHeight;e=this.graph.container.clientHeight;if(d>e&&b.y>e+2&&b.y<=d)return true;return false};
a.init=function(){this.installListeners();var b=this.graph;if(b.dialect==mxConstants.DIALECT_SVG)this.createSvg();else b.dialect==mxConstants.DIALECT_VML?this.createVml():this.createHtml()};
a.installListeners=function(){var b=this.graph,d=b.container;if(d!=null){var e=mxClient.IS_TOUCH?"touchstart":"mousedown",f=mxClient.IS_TOUCH?"touchmove":"mousemove",g=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(d,e,mxUtils.bind(this,function(h){mxClient.IS_TOUCH&&b.isEditing()&&b.stopEditing(!b.isInvokesStopCellEditing());if(this.isContainerEvent(h)&&(!mxClient.IS_IE&&!mxClient.IS_GC&&1||!this.isScrollEvent(h)))b.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(h))}));mxEvent.addListener(d,
f,mxUtils.bind(this,function(h){this.isContainerEvent(h)&&b.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(h))}));mxEvent.addListener(d,g,mxUtils.bind(this,function(h){this.isContainerEvent(h)&&b.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(h))}));mxEvent.addListener(d,"dblclick",mxUtils.bind(this,function(h){b.dblClick(h)}));mxEvent.addListener(document,e,mxUtils.bind(this,function(h){this.isContainerEvent(h)&&b.panningHandler.hideMenu()}));mxEvent.addListener(document,f,mxUtils.bind(this,
function(h){b.tooltipHandler!=null&&b.tooltipHandler.isHideOnHover()&&b.tooltipHandler.hide();this.captureDocumentGesture&&b.isMouseDown&&!mxEvent.isConsumed(h)&&b.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(h))}));mxEvent.addListener(document,g,mxUtils.bind(this,function(h){this.captureDocumentGesture&&b.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(h))}))}};
a.createHtml=function(){var b=this.graph.container;if(b!=null){this.canvas=this.createHtmlPane();this.backgroundPane=this.createHtmlPane(1,1);this.drawPane=this.createHtmlPane(1,1);this.overlayPane=this.createHtmlPane(1,1);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);b.appendChild(this.canvas)}};
a.createHtmlPane=function(b,d){var e=document.createElement("DIV");if(b!=null&&d!=null){e.style.position="absolute";e.style.left="0px";e.style.top="0px";e.style.width=b+"px";e.style.height=d+"px"}else e.style.position="relative";return e};
a.createVml=function(){var b=this.graph.container;if(b!=null){var d=b.offsetWidth,e=b.offsetHeight;this.canvas=this.createVmlPane(d,e);this.backgroundPane=this.createVmlPane(d,e);this.drawPane=this.createVmlPane(d,e);this.overlayPane=this.createVmlPane(d,e);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);b.appendChild(this.canvas)}};
a.createVmlPane=function(b,d){var e=document.createElement("v:group");e.style.position="absolute";e.style.left="0px";e.style.top="0px";e.style.width=b+"px";e.style.height=d+"px";e.setAttribute("coordsize",b+","+d);e.setAttribute("coordorigin","0,0");return e};
a.createSvg=function(){var b=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);var d=document.createElementNS(mxConstants.NS_SVG,"svg"),e=mxUtils.bind(this,
function(){if(this.graph.container!=null){var f=this.graph.container.offsetWidth,g=this.graph.container.offsetHeight,h=this.getGraphBounds();d.setAttribute("width",Math.max(f,h.width));d.setAttribute("height",Math.max(g,h.height))}});mxEvent.addListener(window,"resize",e);d.appendChild(this.canvas);if(b!=null){b.appendChild(d);if(mxUtils.getCurrentStyle(b).position=="static")b.style.position="relative"}};
a.destroy=function(){var b=this.canvas!=null?this.canvas.ownerSVGElement:null;if(b==null)b=this.canvas;if(b!=null&&b.parentNode!=null){this.clear(this.currentRoot,true);mxEvent.removeAllListeners(document);mxEvent.release(this.graph.container);b.parentNode.removeChild(b);this.overlayPane=this.drawPane=this.backgroundPane=this.canvas=null}};
function mxCurrentRootChange(b,d){this.view=b;this.previous=this.root=d;this.isUp=d==null;if(!this.isUp){b=this.view.currentRoot;for(var e=this.view.graph.getModel();b!=null;){if(b==d){this.isUp=true;break}b=e.getParent(b)}}}
mxCurrentRootChange.prototype.execute=function(){var b=this.view.currentRoot;this.view.currentRoot=this.previous;this.previous=b;b=this.view.graph.getTranslateForRoot(this.view.currentRoot);if(b!=null)this.view.translate=new mxPoint(-b.x,-b.y);this.view.fireEvent(new mxEventObject(this.isUp?mxEvent.UP:mxEvent.DOWN,"root",this.view.currentRoot,"previous",this.previous));if(this.isUp){this.view.clear(this.view.currentRoot,true);this.view.validate()}else this.view.refresh();this.isUp=!this.isUp};
function mxGraph(b,d,e){this.renderHint=e;this.dialect=mxClient.IS_NS?mxConstants.DIALECT_SVG:e==mxConstants.RENDERING_HINT_EXACT?mxConstants.DIALECT_VML:e==mxConstants.RENDERING_HINT_FASTEST?mxConstants.DIALECT_STRICTHTML:e==mxConstants.RENDERING_HINT_FASTER?mxConstants.DIALECT_PREFERHTML:mxConstants.DIALECT_MIXEDHTML;this.model=d!=null?d:new mxGraphModel;this.multiplicities=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());this.setStylesheet(this.createStylesheet());
this.view=this.createGraphView();this.model.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(f,g){this.graphModelChanged(g.getProperty("changes"))}));this.createHandlers();b!=null&&this.init(b);this.view.revalidate()}mxResources.add(mxClient.basePath+"/resources/graph");mxGraph.prototype=new mxEventSource;a=mxGraph.prototype;a.constructor=mxGraph;a.EMPTY_ARRAY=[];a.mouseListeners=null;a.isMouseDown=false;a.model=null;a.view=null;a.stylesheet=null;a.selectionModel=null;a.cellEditor=null;
a.cellRenderer=null;a.multiplicities=null;a.renderHint=null;a.dialect=null;a.gridSize=10;a.gridEnabled=true;a.doubleTapEnabled=true;a.doubleTapTimeout=700;a.doubleTapTolerance=25;a.lastTouchY=0;a.lastTouchY=0;a.lastTouchTime=0;a.gestureEnabled=true;a.tolerance=4;a.defaultOverlap=0.5;a.defaultParent=null;a.alternateEdgeStyle=null;a.backgroundImage=null;a.pageVisible=false;a.pageBreaksVisible=false;a.pageBreakColor="gray";a.pageBreakDashed=true;a.minPageBreakDist=20;a.preferPageSize=false;
a.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;a.pageScale=1.5;a.enabled=true;a.escapeEnabled=true;a.invokesStopCellEditing=true;a.enterStopsCellEditing=false;a.useScrollbarsForPanning=true;a.exportEnabled=true;a.importEnabled=true;a.cellsLocked=false;a.cellsCloneable=true;a.foldingEnabled=true;a.cellsEditable=true;a.cellsDeletable=true;a.cellsMovable=true;a.edgeLabelsMovable=true;a.vertexLabelsMovable=false;a.dropEnabled=false;a.splitEnabled=true;a.cellsResizable=true;a.cellsBendable=true;
a.cellsSelectable=true;a.cellsDisconnectable=true;a.autoSizeCells=false;a.autoScroll=true;a.autoExtend=true;a.maximumGraphBounds=null;a.minimumGraphSize=null;a.minimumContainerSize=null;a.maximumContainerSize=null;a.resizeContainer=false;a.border=0;a.ordered=true;a.keepEdgesInForeground=false;a.keepEdgesInBackground=true;a.allowNegativeCoordinates=true;a.constrainChildren=true;a.extendParents=true;a.extendParentsOnAdd=true;a.collapseToPreferredSize=true;a.zoomFactor=1.2;
a.keepSelectionVisibleOnZoom=false;a.centerZoom=true;a.resetViewOnRootChange=true;a.resetEdgesOnResize=false;a.resetEdgesOnMove=false;a.resetEdgesOnConnect=true;a.allowLoops=false;a.defaultLoopStyle=mxEdgeStyle.Loop;a.multigraph=true;a.connectableEdges=false;a.allowDanglingEdges=true;a.cloneInvalidEdges=false;a.disconnectOnMove=true;a.labelsVisible=true;a.htmlLabels=false;a.swimlaneSelectionEnabled=true;a.swimlaneNesting=true;a.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;
a.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);a.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);a.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+(mxClient.IS_MAC?".png":".gif"),16,16);a.alreadyConnectedResource=mxClient.language!="none"?"alreadyConnected":"";a.containsValidationErrorsResource=mxClient.language!="none"?"containsValidationErrors":"";a.collapseExpandResource=mxClient.language!="none"?"collapse-expand":"";
a.init=function(b){this.container=b;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();if(mxClient.IS_IE){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}));mxEvent.addListener(b,"selectstart",mxUtils.bind(this,function(){return this.isEditing()}))}};
a.createHandlers=function(){this.tooltipHandler=new mxTooltipHandler(this);this.tooltipHandler.setEnabled(false);this.panningHandler=new mxPanningHandler(this);this.panningHandler.panningEnabled=false;this.selectionCellsHandler=new mxSelectionCellsHandler(this);this.connectionHandler=new mxConnectionHandler(this);this.connectionHandler.setEnabled(false);this.graphHandler=new mxGraphHandler(this)};a.createSelectionModel=function(){return new mxGraphSelectionModel(this)};a.createStylesheet=function(){return new mxStylesheet};
a.createGraphView=function(){return new mxGraphView(this)};a.createCellRenderer=function(){return new mxCellRenderer};a.createCellEditor=function(){return new mxCellEditor(this)};a.getModel=function(){return this.model};a.getView=function(){return this.view};a.getStylesheet=function(){return this.stylesheet};a.setStylesheet=function(b){this.stylesheet=b};a.getSelectionModel=function(){return this.selectionModel};a.setSelectionModel=function(b){this.selectionModel=b};
a.getSelectionCellsForChanges=function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];if(f.constructor!=mxRootChange){var g=null;if(f.constructor==mxChildChange&&f.isAdded)g=f.child;else if(f.cell!=null&&f.cell.constructor==mxCell)g=f.cell;g!=null&&mxUtils.indexOf(d,g)<0&&d.push(g)}}return this.getModel().getTopmostCells(d)};a.graphModelChanged=function(b){for(var d=0;d<b.length;d++)this.processChange(b[d]);this.removeSelectionCells(this.getRemovedCellsForChanges(b));this.view.validate();this.sizeDidChange()};
a.getRemovedCellsForChanges=function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];if(f.constructor==mxRootChange)break;else if(f.constructor==mxChildChange)f.isAdded||(d=d.concat(this.model.getDescendants(f.child)));else if(f.constructor==mxVisibleChange)d=d.concat(this.model.getDescendants(f.cell))}return d};
a.processChange=function(b){if(b.constructor==mxRootChange){this.clearSelection();this.removeStateForCell(b.previous);if(this.resetViewOnRootChange){this.view.scale=1;this.view.translate.x=0;this.view.translate.y=0}this.fireEvent(new mxEventObject(mxEvent.ROOT))}else if(b.constructor==mxChildChange){var d=this.model.getParent(b.child);d!=null?this.view.invalidate(b.child,true,false,true):this.removeStateForCell(b.child);if(d!=b.previous){d!=null&&this.view.invalidate(d,false,false);b.previous!=null&&
this.view.invalidate(b.previous,false,false)}}else if(b.constructor==mxTerminalChange||b.constructor==mxGeometryChange)this.view.invalidate(b.cell);else if(b.constructor==mxValueChange)this.view.invalidate(b.cell,false,false);else if(b.constructor==mxStyleChange)this.view.removeState(b.cell);else b.cell!=null&&b.cell.constructor==mxCell&&this.removeStateForCell(b.cell)};
a.removeStateForCell=function(b){for(var d=this.model.getChildCount(b),e=0;e<d;e++)this.removeStateForCell(this.model.getChildAt(b,e));this.view.removeState(b)};a.addCellOverlay=function(b,d){if(b.overlays==null)b.overlays=[];b.overlays.push(d);var e=this.view.getState(b);e!=null&&this.cellRenderer.redraw(e);this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",b,"overlay",d));return d};a.getCellOverlays=function(b){return b.overlays};
a.removeCellOverlay=function(b,d){if(d==null)this.removeCellOverlays(b);else{var e=mxUtils.indexOf(b.overlays,d);if(e>=0){b.overlays.splice(e,1);if(b.overlays.length==0)b.overlays=null;e=this.view.getState(b);e!=null&&this.cellRenderer.redraw(e);this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",b,"overlay",d))}else d=null}return d};
a.removeCellOverlays=function(b){var d=b.overlays;if(d!=null){b.overlays=null;var e=this.view.getState(b);e!=null&&this.cellRenderer.redraw(e);for(e=0;e<d.length;e++)this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",b,"overlay",d[e]))}return d};a.clearCellOverlays=function(b){b=b!=null?b:this.model.getRoot();this.removeCellOverlays(b);for(var d=this.model.getChildCount(b),e=0;e<d;e++)this.clearCellOverlays(this.model.getChildAt(b,e))};
a.setCellWarning=function(b,d,e,f){if(d!=null&&d.length>0){e=e!=null?e:this.warningImage;d=new mxCellOverlay(e,"<font color=red>"+d+"</font>");f&&d.addListener(mxEvent.CLICK,mxUtils.bind(this,function(){this.isEnabled()&&this.setSelectionCell(b)}));return this.addCellOverlay(b,d)}else this.removeCellOverlays(b);return null};a.startEditing=function(b){this.startEditingAtCell(null,b)};
a.startEditingAtCell=function(b,d){if(b==null){b=this.getSelectionCell();if(b!=null&&!this.isCellEditable(b))b=null}if(b!=null){this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",b,"event",d));this.cellEditor.startEditing(b,d)}};a.getEditingValue=function(b){return this.convertValueToString(b)};a.stopEditing=function(b){this.cellEditor.stopEditing(b)};
a.labelChanged=function(b,d,e){this.model.beginUpdate();try{this.cellLabelChanged(b,d,this.isAutoSizeCell(b));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",b,"value",d,"event",e))}finally{this.model.endUpdate()}return b};a.cellLabelChanged=function(b,d,e){this.model.beginUpdate();try{this.model.setValue(b,d);e&&this.cellSizeUpdated(b,false)}finally{this.model.endUpdate()}};
a.escape=function(){this.stopEditing(true);this.connectionHandler.reset();this.graphHandler.reset();for(var b=this.getSelectionCells(),d=0;d<b.length;d++){var e=this.view.getState(b[d]);e!=null&&e.handler!=null&&e.handler.reset()}};
a.click=function(b){var d=b.getEvent(),e=b.getCell(),f=new mxEventObject(mxEvent.CLICK,"event",d,"cell",e);b.isConsumed()&&f.consume();this.fireEvent(f);if(this.isEnabled()&&!mxEvent.isConsumed(d)&&!f.isConsumed())if(e!=null)this.selectCellForEvent(e,d);else{b=null;if(this.isSwimlaneSelectionEnabled()){b=mxUtils.convertPoint(this.container,mxEvent.getClientX(d),mxEvent.getClientY(d));b=this.getSwimlaneAt(b.x,b.y)}if(b!=null)this.selectCellForEvent(b,d);else this.isToggleEvent(d)||this.clearSelection()}};
a.dblClick=function(b,d){var e=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",b,"cell",d);this.fireEvent(e);this.isEnabled()&&!mxEvent.isConsumed(b)&&!e.isConsumed()&&d!=null&&this.isCellEditable(d)&&this.startEditingAtCell(d,b)};
a.scrollPointToVisible=function(b,d,e,f){if(mxUtils.hasScrollbars(this.container)){var g=this.container;f=f!=null?f:20;if(b>=g.scrollLeft&&d>=g.scrollTop&&b<=g.scrollLeft+g.clientWidth&&d<=g.scrollTop+g.clientHeight){var h=g.scrollLeft+g.clientWidth-b;if(h<f){b=g.scrollLeft;g.scrollLeft+=f-h;if(e&&b==g.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){b=this.view.getDrawPane().ownerSVGElement;var j=parseInt(b.getAttribute("width"))+f-h;b.setAttribute("width",j)}else{j=Math.max(g.clientWidth,g.scrollWidth)+
f-h;b=this.view.getCanvas();b.style.width=j+"px"}g.scrollLeft+=f-h}}else{h=b-g.scrollLeft;if(h<f)g.scrollLeft-=f-h}h=g.scrollTop+g.clientHeight-d;if(h<f){b=g.scrollTop;g.scrollTop+=f-h;if(b==g.scrollTop&&e){if(this.dialect==mxConstants.DIALECT_SVG){b=this.view.getDrawPane().ownerSVGElement;d=parseInt(b.getAttribute("height"))+f-h;b.setAttribute("height",d)}else{d=Math.max(g.clientHeight,g.scrollHeight)+f-h;b=this.view.getCanvas();b.style.height=d+"px"}g.scrollTop+=f-h}}else{h=d-g.scrollTop;if(h<f)g.scrollTop-=
f-h}}}};
a.sizeDidChange=function(){var b=this.getGraphBounds();if(this.container!=null){var d=this.getBorder(),e=b.x+b.width+1+d;d=b.y+b.height+1+d;if(this.minimumContainerSize!=null){e=Math.max(e,this.minimumContainerSize.width);d=Math.max(d,this.minimumContainerSize.height)}if(this.resizeContainer){var f=e,g=d;if(this.maximumContainerSize!=null){f=Math.min(this.maximumContainerSize.width,f);g=Math.min(this.maximumContainerSize.height,g)}this.container.style.width=f+"px";this.container.style.height=g+"px"}if(this.preferPageSize||
!mxClient.IS_IE&&this.pageVisible){f=this.view.scale;g=this.view.translate;var h=this.pageFormat,j=f*this.pageScale;f=new mxRectangle(f*g.x,f*g.y,h.width*j,h.height*j);e=this.pageBreaksVisible?Math.ceil(e/f.width):1;d=this.pageBreaksVisible?Math.ceil(d/f.height):1;e=e*f.width+2;d=d*f.height+2}e=Math.max(e,this.container.offsetWidth);d=Math.max(d,this.container.offsetHeight);if(this.dialect==mxConstants.DIALECT_SVG){f=this.view.getDrawPane().ownerSVGElement;if(this.minimumGraphSize!=null){e=Math.max(e,
this.minimumGraphSize.width*this.view.scale);d=Math.max(d,this.minimumGraphSize.height*this.view.scale)}f.setAttribute("width",e);f.setAttribute("height",d);if(e<=this.container.offsetWidth&&this.container.clientWidth<this.container.offsetWidth){f=this.container.style.overflow;this.container.style.overflow="hidden";this.container.scrollLeft=1;this.container.style.overflow=f}}else{f=this.view.getDrawPane();g=this.view.getCanvas();f.style.width=e+"px";f.style.height=d+"px";g.style.width=e+"px";g.style.height=
d+"px";if(this.minimumGraphSize!=null){e=Math.max(e,this.minimumGraphSize.width*this.view.scale);d=Math.max(d,this.minimumGraphSize.height*this.view.scale);g.style.width=e+"px";g.style.height=d+"px"}}this.updatePageBreaks(this.pageBreaksVisible,e-1,d-1)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",b))};
a.updatePageBreaks=function(b,d,e){var f=this.view.scale,g=this.view.translate,h=this.pageFormat,j=f*this.pageScale;g=new mxRectangle(f*g.x,f*g.y,h.width*j,h.height*j);b=b&&Math.min(g.width,g.height)>this.minPageBreakDist;g.x=mxUtils.mod(g.x,g.width);g.y=mxUtils.mod(g.y,g.height);h=b?Math.ceil((d-g.x)/g.width):0;b=b?Math.ceil((e-g.y)/g.height):0;if(this.horizontalPageBreaks==null&&h>0)this.horizontalPageBreaks=[];if(this.horizontalPageBreaks!=null){for(j=0;j<=h;j++){var k=[new mxPoint(g.x+j*g.width,
1),new mxPoint(g.x+j*g.width,e)];if(this.horizontalPageBreaks[j]!=null){this.horizontalPageBreaks[j].scale=f;this.horizontalPageBreaks[j].points=k;this.horizontalPageBreaks[j].redraw()}else{k=new mxPolyline(k,this.pageBreakColor,this.scale);k.dialect=this.dialect;k.isDashed=this.pageBreakDashed;k.scale=f;k.crisp=true;k.init(this.view.backgroundPane);this.horizontalPageBreaks[j]=k}}for(j=h;j<this.horizontalPageBreaks.length;j++)this.horizontalPageBreaks[j].destroy();this.horizontalPageBreaks.splice(h,
this.horizontalPageBreaks.length-h)}if(this.verticalPageBreaks==null&&b>0)this.verticalPageBreaks=[];if(this.verticalPageBreaks!=null){for(j=0;j<=b;j++){k=[new mxPoint(1,g.y+j*g.height),new mxPoint(d,g.y+j*g.height)];if(this.verticalPageBreaks[j]!=null){this.verticalPageBreaks[j].scale=f;this.verticalPageBreaks[j].points=k;this.verticalPageBreaks[j].redraw()}else{k=new mxPolyline(k,this.pageBreakColor,f);k.dialect=this.dialect;k.isDashed=this.pageBreakDashed;k.scale=f;k.crisp=true;k.init(this.view.backgroundPane);
this.verticalPageBreaks[j]=k}}for(j=b;j<this.verticalPageBreaks.length;j++)this.verticalPageBreaks[j].destroy();this.verticalPageBreaks.splice(b,this.verticalPageBreaks.length-b)}};a.getCellStyle=function(b){var d=this.model.getStyle(b),e=null;e=this.model.isEdge(b)?this.stylesheet.getDefaultEdgeStyle():this.stylesheet.getDefaultVertexStyle();if(d!=null)e=this.stylesheet.getCellStyle(d,e);if(e==null)e=mxGraph.prototype.EMPTY_ARRAY;return e};
a.setCellStyle=function(b,d){d=d||this.getSelectionCells();if(d!=null){this.model.beginUpdate();try{for(var e=0;e<d.length;e++)this.model.setStyle(d[e],b)}finally{this.model.endUpdate()}}};a.toggleCellStyle=function(b,d,e){e=e||this.getSelectionCell();this.toggleCellStyles(b,d,[e])};
a.toggleCellStyles=function(b,d,e){d=d!=null?d:false;e=e||this.getSelectionCells();if(e!=null&&e.length>0){var f=this.view.getState(e[0]);f=f!=null?f.style:this.getCellStyle(e[0]);if(f!=null){d=mxUtils.getValue(f,b,d)?0:1;this.setCellStyles(b,d,e)}}};a.setCellStyles=function(b,d,e){e=e||this.getSelectionCells();mxUtils.setCellStyles(this.model,e,b,d)};a.toggleCellStyleFlags=function(b,d,e){this.setCellStyleFlags(b,d,null,e)};
a.setCellStyleFlags=function(b,d,e,f){f=f||this.getSelectionCells();if(f!=null&&f.length>0){if(e==null){var g=this.view.getState(f[0]);g=g!=null?g.style:this.getCellStyle(f[0]);if(g!=null)e=(parseInt(g[b]||0)&d)!=d}mxUtils.setCellStyleFlags(this.model,f,b,d,e)}};
a.alignCells=function(b,d,e){if(d==null)d=this.getSelectionCells();if(d!=null&&d.length>1){if(e==null)for(var f=0;f<d.length;f++){var g=this.getCellGeometry(d[f]);if(g!=null&&!this.model.isEdge(d[f]))if(e==null)if(b==mxConstants.ALIGN_CENTER){e=g.x+g.width/2;break}else if(b==mxConstants.ALIGN_RIGHT)e=g.x+g.width;else if(b==mxConstants.ALIGN_TOP)e=g.y;else if(b==mxConstants.ALIGN_MIDDLE){e=g.y+g.height/2;break}else e=b==mxConstants.ALIGN_BOTTOM?g.y+g.height:g.x;else e=b==mxConstants.ALIGN_RIGHT?Math.max(e,
g.x+g.width):b==mxConstants.ALIGN_TOP?Math.min(e,g.y):b==mxConstants.ALIGN_BOTTOM?Math.max(e,g.y+g.height):Math.min(e,g.x)}this.model.beginUpdate();try{for(f=0;f<d.length;f++){g=this.getCellGeometry(d[f]);if(g!=null&&!this.model.isEdge(d[f])){g=g.clone();if(b==mxConstants.ALIGN_CENTER)g.x=e-g.width/2;else if(b==mxConstants.ALIGN_RIGHT)g.x=e-g.width;else if(b==mxConstants.ALIGN_TOP)g.y=e;else if(b==mxConstants.ALIGN_MIDDLE)g.y=e-g.height/2;else if(b==mxConstants.ALIGN_BOTTOM)g.y=e-g.height;else g.x=
e;this.model.setGeometry(d[f],g)}}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",b,"cells",d))}finally{this.model.endUpdate()}}return d};a.flipEdge=function(b){if(b!=null&&this.alternateEdgeStyle!=null){this.model.beginUpdate();try{var d=this.model.getStyle(b);d==null||d.length==0?this.model.setStyle(b,this.alternateEdgeStyle):this.model.setStyle(b,null);this.resetEdge(b);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",b))}finally{this.model.endUpdate()}}return b};
a.orderCells=function(b,d){if(d==null)d=mxUtils.sortCells(this.getSelectionCells(),true);this.model.beginUpdate();try{this.cellsOrdered(d,b);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",b,"cells",d))}finally{this.model.endUpdate()}return d};
a.cellsOrdered=function(b,d){if(b!=null){this.model.beginUpdate();try{for(var e=0;e<b.length;e++){var f=this.model.getParent(b[e]);d?this.model.add(f,b[e],e):this.model.add(f,b[e],this.model.getChildCount(f)-1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",d,"cells",b))}finally{this.model.endUpdate()}}};
a.groupCells=function(b,d,e){if(e==null)e=mxUtils.sortCells(this.getSelectionCells(),true);e=this.getCellsForGroup(e);if(b==null)b=this.createGroupCell(e);var f=this.getBoundsForGroup(b,e,d);if(e.length>0&&f!=null){var g=this.model.getParent(e[0]);this.model.beginUpdate();try{this.getCellGeometry(b)==null&&this.model.setGeometry(b,new mxGeometry);var h=this.model.getChildCount(b);this.cellsAdded(e,b,h,null,null,false);this.cellsMoved(e,-f.x,-f.y,false,true);h=this.model.getChildCount(g);this.cellsAdded([b],
g,h,null,null,false);this.cellsResized([b],[f]);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",b,"border",d,"cells",e))}finally{this.model.endUpdate()}}return b};a.getCellsForGroup=function(b){var d=[];if(b!=null&&b.length>0){var e=this.model.getParent(b[0]);d.push(b[0]);for(var f=1;f<b.length;f++)this.model.getParent(b[f])==e&&d.push(b[f])}return d};
a.getBoundsForGroup=function(b,d,e){d=this.getBoundingBoxFromGeometry(d);if(d!=null){if(this.isSwimlane(b)){b=this.getStartSize(b);d.x-=b.width;d.y-=b.height;d.width+=b.width;d.height+=b.height}d.x-=e;d.y-=e;d.width+=2*e;d.height+=2*e}return d};a.createGroupCell=function(){var b=new mxCell("");b.setVertex(true);b.setConnectable(false);return b};
a.ungroupCells=function(b){var d=[];if(b==null){b=this.getSelectionCells();for(var e=[],f=0;f<b.length;f++)this.model.getChildCount(b[f])>0&&e.push(b[f]);b=e}if(b!=null&&b.length>0){this.model.beginUpdate();try{for(f=0;f<b.length;f++){var g=this.model.getChildren(b[f]);if(g!=null&&g.length>0){g=g.slice();var h=this.model.getParent(b[f]),j=this.model.getChildCount(h);this.cellsAdded(g,h,j,null,null,true);d=d.concat(g)}}this.cellsRemoved(this.addAllEdges(b));this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,
"cells",b))}finally{this.model.endUpdate()}}return d};a.removeCellsFromParent=function(b){if(b==null)b=this.getSelectionCells();this.model.beginUpdate();try{var d=this.getDefaultParent(),e=this.model.getChildCount(d);this.cellsAdded(b,d,e,null,null,true);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",b))}finally{this.model.endUpdate()}return b};
a.updateGroupBounds=function(b,d,e){if(b==null)b=this.getSelectionCells();d=d!=null?d:0;e=e!=null?e:false;this.model.beginUpdate();try{for(var f=0;f<b.length;f++){var g=this.getCellGeometry(b[f]);if(g!=null){var h=this.getChildCells(b[f]);if(h!=null&&h.length>0){var j=this.getBoundingBoxFromGeometry(h);if(j.width>0&&j.height>0){var k=this.isSwimlane(b[f])?this.getStartSize(b[f]):new mxRectangle;g=g.clone();if(e){g.x+=j.x-k.width-d;g.y+=j.y-k.height-d}g.width=j.width+k.width+2*d;g.height=j.height+
k.height+2*d;this.model.setGeometry(b[f],g);this.moveCells(h,-j.x+k.width+d,-j.y+k.height+d)}}}}}finally{this.model.endUpdate()}return b};
a.cloneCells=function(b,d){d=d!=null?d:true;var e=null;if(b!=null){var f={};e=[];for(var g=0;g<b.length;g++){var h=mxCellPath.create(b[g]);f[h]=b[g];e.push(b[g])}if(e.length>0){h=this.view.scale;var j=this.view.translate;e=this.model.cloneCells(b,true);for(g=0;g<b.length;g++)if(!d&&this.model.isEdge(e[g])&&this.getEdgeValidationError(e[g],this.model.getTerminal(e[g],true),this.model.getTerminal(e[g],false))!=null)e[g]=null;else{var k=this.model.getGeometry(e[g]);if(k!=null){var l=this.view.getState(b[g]),
m=this.view.getState(this.model.getParent(b[g]));if(l!=null&&m!=null){var n=m.origin.x;m=m.origin.y;if(this.model.isEdge(e[g])){l=l.absolutePoints;for(var o=this.model.getTerminal(b[g],true),p=mxCellPath.create(o);o!=null&&f[p]==null;){o=this.model.getParent(o);p=mxCellPath.create(o)}o==null&&k.setTerminalPoint(new mxPoint(l[0].x/h-j.x,l[0].y/h-j.y),true);o=this.model.getTerminal(b[g],false);for(p=mxCellPath.create(o);o!=null&&f[p]==null;){o=this.model.getParent(o);p=mxCellPath.create(o)}if(o==null){o=
l.length-1;k.setTerminalPoint(new mxPoint(l[o].x/h-j.x,l[o].y/h-j.y),false)}k=k.points;if(k!=null)for(l=0;l<k.length;l++){k[l].x+=n;k[l].y+=m}}else{k.x+=n;k.y+=m}}}}}else e=[]}return e};a.insertVertex=function(b,d,e,f,g,h,j,k){return this.addCell(this.createVertex(b,d,e,f,g,h,j,k),b)};a.createVertex=function(b,d,e,f,g,h,j,k){b=new mxGeometry(f,g,h,j);e=new mxCell(e,b,k);e.setId(d);e.setVertex(true);e.setConnectable(true);return e};
a.insertEdge=function(b,d,e,f,g,h){return this.addEdge(this.createEdge(b,d,e,f,g,h),b,f,g)};a.createEdge=function(b,d,e,f,g,h){b=new mxCell(e,new mxGeometry,h);b.setId(d);b.setEdge(true);b.geometry.relative=true;return b};a.addEdge=function(b,d,e,f,g){return this.addCell(b,d,g,e,f)};a.addCell=function(b,d,e,f,g){return this.addCells([b],d,e,f,g)[0]};
a.addCells=function(b,d,e,f,g){if(d==null)d=this.getDefaultParent();if(e==null)e=this.model.getChildCount(d);this.model.beginUpdate();try{this.cellsAdded(b,d,e,f,g,false);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",b,"parent",d,"index",e,"source",f,"target",g))}finally{this.model.endUpdate()}return b};
a.cellsAdded=function(b,d,e,f,g,h){if(b!=null&&d!=null&&e!=null){this.model.beginUpdate();try{var j=h?this.view.getState(d):null,k=j!=null?j.origin:null,l=new mxPoint(0,0);for(j=0;j<b.length;j++){var m=this.model.getParent(b[j]);if(k!=null&&b[j]!=d&&d!=m){var n=this.view.getState(m),o=n!=null?n.origin:l,p=this.model.getGeometry(b[j]);if(p!=null){var q=o.x-k.x,r=o.y-k.y;p=p.clone();p.translate(q,r);if(!p.relative&&this.model.isVertex(b[j])&&!this.isAllowNegativeCoordinates()){p.x=Math.max(0,p.x);p.y=
Math.max(0,p.y)}this.model.setGeometry(b[j],p)}}d==m&&e--;this.model.add(d,b[j],e+j);this.isExtendParentsOnAdd()&&this.isExtendParent(b[j])&&this.extendParent(b[j]);this.constrainChild(b[j]);f!=null&&this.cellConnected(b[j],f,true);g!=null&&this.cellConnected(b[j],g,false)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",b,"parent",d,"index",e,"source",f,"target",g,"absolute",h))}finally{this.model.endUpdate()}}};
a.removeCells=function(b,d){d=d!=null?d:true;if(b==null)b=this.getDeletableCells(this.getSelectionCells());if(d)b=this.getDeletableCells(this.addAllEdges(b));this.model.beginUpdate();try{this.cellsRemoved(b);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",b,"includeEdges",d))}finally{this.model.endUpdate()}return b};
a.cellsRemoved=function(b){if(b!=null&&b.length>0){var d=this.view.scale,e=this.view.translate;this.model.beginUpdate();try{for(var f={},g=0;g<b.length;g++){var h=mxCellPath.create(b[g]);f[h]=b[g]}for(g=0;g<b.length;g++){for(var j=this.getConnections(b[g]),k=0;k<j.length;k++){h=mxCellPath.create(j[k]);if(f[h]==null){var l=this.model.getGeometry(j[k]);if(l!=null){var m=this.view.getState(j[k]);if(m!=null){l=l.clone();var n=this.view.getVisibleTerminal(j[k],true)==b[g],o=m.absolutePoints,p=n?0:o.length-
1;l.setTerminalPoint(new mxPoint(o[p].x/d-e.x,o[p].y/d-e.y),n);this.model.setTerminal(j[k],null,n);this.model.setGeometry(j[k],l)}}}}this.model.remove(b[g])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",b))}finally{this.model.endUpdate()}}};
a.splitEdge=function(b,d,e,f,g){f=f||0;g=g||0;if(e==null)e=this.cloneCells([b])[0];var h=this.model.getParent(b),j=this.model.getTerminal(b,true);this.model.beginUpdate();try{this.cellsMoved(d,f,g,false,false);this.cellsAdded(d,h,this.model.getChildCount(h),null,null,true);this.cellsAdded([e],h,this.model.getChildCount(h),j,d[0],false);this.cellConnected(b,d[0],true);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",b,"cells",d,"newEdge",e,"dx",f,"dy",g))}finally{this.model.endUpdate()}return e};
a.toggleCells=function(b,d,e){if(d==null)d=this.getSelectionCells();if(e)d=this.addAllEdges(d);this.model.beginUpdate();try{this.cellsToggled(d,b);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",b,"cells",d,"includeEdges",e))}finally{this.model.endUpdate()}return d};a.cellsToggled=function(b,d){if(b!=null&&b.length>0){this.model.beginUpdate();try{for(var e=0;e<b.length;e++)this.model.setVisible(b[e],d)}finally{this.model.endUpdate()}}};
a.foldCells=function(b,d,e){d=d!=null?d:false;if(e==null)e=this.getFoldableCells(this.getSelectionCells(),b);this.stopEditing(false);this.model.beginUpdate();try{this.cellsFolded(e,b,d);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",b,"recurse",d,"cells",e))}finally{this.model.endUpdate()}return e};
a.cellsFolded=function(b,d,e){if(b!=null&&b.length>0){this.model.beginUpdate();try{for(var f=0;f<b.length;f++)if(d!=this.isCellCollapsed(b[f])){this.model.setCollapsed(b[f],d);this.swapBounds(b[f],d);this.isExtendParent(b[f])&&this.extendParent(b[f]);e&&this.foldCells(this.model.getChildren(b[f]),d,e)}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",b,"collapse",d,"recurse",e))}finally{this.model.endUpdate()}}};
a.swapBounds=function(b,d){if(b!=null){var e=this.model.getGeometry(b);if(e!=null){e=e.clone();this.updateAlternateBounds(b,e,d);e.swap();this.model.setGeometry(b,e)}}};
a.updateAlternateBounds=function(b,d){if(b!=null&&d!=null)if(d.alternateBounds==null){var e=d;if(this.collapseToPreferredSize){var f=this.getPreferredSizeForCell(b);if(f!=null){e=f;f=this.view.getState(b);b=f!=null?f.style:this.getCellStyle(b);b=mxUtils.getValue(b,mxConstants.STYLE_STARTSIZE);if(b>0)e.height=Math.max(e.height,b)}}d.alternateBounds=new mxRectangle(d.x,d.y,e.width,e.height)}else{d.alternateBounds.x=d.x;d.alternateBounds.y=d.y}};a.addAllEdges=function(b){var d=b.slice();return d=d.concat(this.getAllEdges(b))};
a.getAllEdges=function(b){var d=[];if(b!=null)for(var e=0;e<b.length;e++){for(var f=this.model.getEdgeCount(b[e]),g=0;g<f;g++)d.push(this.model.getEdgeAt(b[e],g));f=this.model.getChildren(b[e]);d=d.concat(this.getAllEdges(f))}return d};a.updateCellSize=function(b,d){d=d!=null?d:false;this.model.beginUpdate();try{this.cellSizeUpdated(b,d);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",b,"ignoreChildren",d))}finally{this.model.endUpdate()}return b};
a.cellSizeUpdated=function(b,d){if(b!=null){this.model.beginUpdate();try{var e=this.getPreferredSizeForCell(b),f=this.model.getGeometry(b);if(e!=null&&f!=null){var g=this.isCellCollapsed(b);f=f.clone();if(this.isSwimlane(b)){var h=this.view.getState(b),j=h!=null?h.style:this.getCellStyle(b),k=this.model.getStyle(b);if(k==null)k="";if(mxUtils.getValue(j,mxConstants.STYLE_HORIZONTAL,true)){k=mxUtils.setStyle(k,mxConstants.STYLE_STARTSIZE,e.height+8);if(g)f.height=e.height+8;f.width=e.width}else{k=mxUtils.setStyle(k,
mxConstants.STYLE_STARTSIZE,e.width+8);if(g)f.width=e.width+8;f.height=e.height}this.model.setStyle(b,k)}else{f.width=e.width;f.height=e.height}if(!d&&!g){var l=this.view.getBounds(this.model.getChildren(b));if(l!=null){var m=this.view.translate,n=this.view.scale,o=(l.y+l.height)/n-f.y-m.y;f.width=Math.max(f.width,(l.x+l.width)/n-f.x-m.x);f.height=Math.max(f.height,o)}}this.cellsResized([b],[f])}}finally{this.model.endUpdate()}}};
a.getPreferredSizeForCell=function(b){var d=null;if(b!=null){var e=this.view.getState(b),f=e!=null?e.style:this.getCellStyle(b);if(f!=null&&!this.model.isEdge(b)){var g=f[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE,h=0;d=0;if(this.getImage(e)!=null||f[mxConstants.STYLE_IMAGE]!=null)if(f[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){if(f[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE)h+=f[mxConstants.STYLE_IMAGE_WIDTH]||mxLabel.prototype.imageSize;if(f[mxConstants.STYLE_ALIGN]!=
mxConstants.ALIGN_CENTER)d+=f[mxConstants.STYLE_IMAGE_HEIGHT]||mxLabel.prototype.imageSize}h+=2*(f[mxConstants.STYLE_SPACING]||0);h+=f[mxConstants.STYLE_SPACING_LEFT]||0;h+=f[mxConstants.STYLE_SPACING_RIGHT]||0;d+=2*(f[mxConstants.STYLE_SPACING]||0);d+=f[mxConstants.STYLE_SPACING_TOP]||0;d+=f[mxConstants.STYLE_SPACING_BOTTOM]||0;e=this.getFoldingImage(e);if(e!=null)h+=e.width+8;e=this.getLabel(b);if(e!=null&&e.length>0){this.isHtmlLabel(b)||(e=e.replace(/\n/g,"<br>"));g=mxUtils.getSizeForString(e,
g,f[mxConstants.STYLE_FONTFAMILY]);b=g.width+h;d=g.height+d;if(!mxUtils.getValue(f,mxConstants.STYLE_HORIZONTAL,true)){f=d;d=b;b=f}if(this.gridEnabled){b=this.snap(b+this.gridSize/2);d=this.snap(d+this.gridSize/2)}d=new mxRectangle(0,0,b,d)}else{f=4*this.gridSize;d=new mxRectangle(0,0,f,f)}}}return d};
a.handleGesture=function(b,d){if(Math.abs(1-d.scale)>0.2){var e=this.view.scale,f=this.view.translate,g=b.width*d.scale;d=b.height*d.scale;var h=b.y-(d-b.height)/2;e=new mxRectangle(this.snap((b.x-(g-b.width)/2)/e)-f.x,this.snap(h/e)-f.y,this.snap(g/e),this.snap(d/e));this.resizeCell(b.cell,e)}};a.resizeCell=function(b,d){return this.resizeCells([b],[d])[0]};
a.resizeCells=function(b,d){this.model.beginUpdate();try{this.cellsResized(b,d);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",b,"bounds",d))}finally{this.model.endUpdate()}return b};
a.cellsResized=function(b,d){if(b!=null&&d!=null&&b.length==d.length){this.model.beginUpdate();try{for(var e=0;e<b.length;e++){var f=d[e],g=this.model.getGeometry(b[e]);if(g!=null&&(g.x!=f.x||g.y!=f.y||g.width!=f.width||g.height!=f.height)){g=g.clone();if(g.relative){var h=g.offset;if(h!=null){h.x+=f.x-g.x;h.y+=f.y-g.y}}else{g.x=f.x;g.y=f.y}g.width=f.width;g.height=f.height;if(!g.relative&&this.model.isVertex(b[e])&&!this.isAllowNegativeCoordinates()){g.x=Math.max(0,g.x);g.y=Math.max(0,g.y)}this.model.setGeometry(b[e],
g);this.isExtendParent(b[e])&&this.extendParent(b[e])}}this.resetEdgesOnResize&&this.resetEdges(b);this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",b,"bounds",d))}finally{this.model.endUpdate()}}};
a.extendParent=function(b){if(b!=null){var d=this.model.getParent(b),e=this.model.getGeometry(d);if(d!=null&&e!=null&&!this.isCellCollapsed(d)){b=this.model.getGeometry(b);if(b!=null&&(e.width<b.x+b.width||e.height<b.y+b.height)){e=e.clone();e.width=Math.max(e.width,b.x+b.width);e.height=Math.max(e.height,b.y+b.height);this.cellsResized([d],[e])}}}};a.importCells=function(b,d,e,f,g){return this.moveCells(b,d,e,true,f,g)};
a.moveCells=function(b,d,e,f,g,h){if(b!=null&&(d!=0||e!=0||f||g!=null)){this.model.beginUpdate();try{if(f){b=this.cloneCells(b,this.isCloneInvalidEdges());if(g==null)g=this.getDefaultParent()}this.cellsMoved(b,d,e,!f&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),g==null);if(g!=null){var j=this.model.getChildCount(g);this.cellsAdded(b,g,j,null,null,true)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",b,"dx",d,"dy",e,"clone",f,"target",g,"event",h))}finally{this.model.endUpdate()}}return b};
a.cellsMoved=function(b,d,e,f,g){if(b!=null&&(d!=0||e!=0)){this.model.beginUpdate();try{f&&this.disconnectGraph(b);for(var h=0;h<b.length;h++){this.translateCell(b[h],d,e);g&&this.constrainChild(b[h])}this.resetEdgesOnMove&&this.resetEdges(b);this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",b,"dx",e,"dy",e,"disconnect",f))}finally{this.model.endUpdate()}}};
a.translateCell=function(b,d,e){var f=this.model.getGeometry(b);if(f!=null){f=f.clone();f.translate(d,e);if(!f.relative&&this.model.isVertex(b)&&!this.isAllowNegativeCoordinates()){f.x=Math.max(0,f.x);f.y=Math.max(0,f.y)}if(f.relative&&!this.model.isEdge(b))if(f.offset==null)f.offset=new mxPoint(d,e);else{f.offset.X+=d;f.offset.Y+=e}this.model.setGeometry(b,f)}};
a.getCellContainmentArea=function(b){if(b!=null&&!this.model.isEdge(b)){var d=this.model.getParent(b);if(d==this.getDefaultParent()||d==this.getCurrentRoot())return this.getMaximumGraphBounds();else if(d!=null&&d!=this.getDefaultParent()){var e=this.model.getGeometry(d);if(e!=null){var f=b=0,g=e.width;e=e.height;if(this.isSwimlane(d)){d=this.getStartSize(d);b=d.width;g-=d.width;f=d.height;e-=d.height}return new mxRectangle(b,f,g,e)}}}return null};a.getMaximumGraphBounds=function(){return this.maximumGraphBounds};
a.constrainChild=function(b){if(b!=null){var d=this.model.getGeometry(b),e=this.isConstrainChild(b)?this.getCellContainmentArea(b):this.getMaximumGraphBounds();if(d!=null&&e!=null)if(!d.relative&&(d.x<e.x||d.y<e.y||e.width<d.x+d.width||e.height<d.y+d.height)){b=this.getOverlap(b);if(e.width>0)d.x=Math.min(d.x,e.x+e.width-(1-b)*d.width);if(e.height>0)d.y=Math.min(d.y,e.y+e.height-(1-b)*d.height);d.x=Math.max(d.x,e.x-d.width*b);d.y=Math.max(d.y,e.y-d.height*b)}}};
a.resetEdges=function(b){if(b!=null){for(var d={},e=0;e<b.length;e++){var f=mxCellPath.create(b[e]);d[f]=b[e]}this.model.beginUpdate();try{for(e=0;e<b.length;e++){var g=this.model.getEdges(b[e]);if(g!=null)for(f=0;f<g.length;f++){var h=this.view.getVisibleTerminal(g[f],true),j=mxCellPath.create(h),k=this.view.getVisibleTerminal(g[f],false),l=mxCellPath.create(k);if(d[j]==null||d[l]==null)this.resetEdge(g[f])}this.resetEdges(this.model.getChildren(b[e]))}}finally{this.model.endUpdate()}}};
a.resetEdge=function(b){var d=this.model.getGeometry(b);if(d!=null&&d.points!=null&&d.points.length>0){d=d.clone();d.points=[];this.model.setGeometry(b,d)}return b};a.getAllConnectionConstraints=function(){return null};
a.getConnectionConstraint=function(b,d,e){d=null;var f=b.style[e?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(f!=null){var g=b.style[e?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];if(g!=null)d=new mxPoint(parseFloat(f),parseFloat(g))}f=false;if(d!=null)f=mxUtils.getValue(b.style,e?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,true);return new mxConnectionConstraint(d,f)};
a.setConnectionConstraint=function(b,d,e,f){if(f!=null){this.model.beginUpdate();try{if(f==null||f.point==null){this.setCellStyles(e?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[b]);this.setCellStyles(e?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[b]);this.setCellStyles(e?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[b])}else if(f.point!=null){this.setCellStyles(e?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,f.point.x,[b]);this.setCellStyles(e?
mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,f.point.y,[b]);f.perimeter?this.setCellStyles(e?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[b]):this.setCellStyles(e?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[b])}}finally{this.model.endUpdate()}}};
a.getConnectionPoint=function(b,d){var e=null;if(b!=null&&d.point!=null)e=new mxPoint(b.x+d.point.x*b.width,b.y+d.point.y*b.height);if(e!=null&&d.perimeter)e=this.view.getPerimeterPoint(b,e,false);return e};a.connectCell=function(b,d,e,f){this.model.beginUpdate();try{var g=this.model.getTerminal(b,e);this.cellConnected(b,d,e,f);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",b,"terminal",d,"source",e,"previous",g))}finally{this.model.endUpdate()}return b};
a.cellConnected=function(b,d,e,f){if(b!=null){this.model.beginUpdate();try{var g=this.model.getTerminal(b,e);this.setConnectionConstraint(b,d,e,f);f=null;if(this.isPort(d)){f=d.getId();d=this.getTerminalForPort(d,e)}this.setCellStyles(e?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT,f,[b]);this.model.setTerminal(b,d,e);this.resetEdgesOnConnect&&this.resetEdge(b);this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",b,"terminal",d,"source",e,"previous",g))}finally{this.model.endUpdate()}}};
a.disconnectGraph=function(b){if(b!=null){this.model.beginUpdate();try{for(var d=this.view.scale,e=this.view.translate,f={},g=0;g<b.length;g++){var h=mxCellPath.create(b[g]);f[h]=b[g]}for(g=0;g<b.length;g++)if(this.model.isEdge(b[g])){var j=this.model.getGeometry(b[g]);if(j!=null){var k=this.view.getState(b[g]),l=this.view.getState(this.model.getParent(b[g]));if(k!=null&&l!=null){j=j.clone();var m=-l.origin.x,n=-l.origin.y,o=k.absolutePoints,p=this.model.getTerminal(b[g],true);if(p!=null&&this.isCellDisconnectable(b[g],
p,true)){for(var q=mxCellPath.create(p);p!=null&&f[q]==null;){p=this.model.getParent(p);q=mxCellPath.create(p)}if(p==null){j.setTerminalPoint(new mxPoint(o[0].x/d-e.x+m,o[0].y/d-e.y+n),true);this.model.setTerminal(b[g],null,true)}}var r=this.model.getTerminal(b[g],false);if(r!=null&&this.isCellDisconnectable(b[g],r,false)){for(var s=mxCellPath.create(r);r!=null&&f[s]==null;){r=this.model.getParent(r);s=mxCellPath.create(r)}if(r==null){var u=o.length-1;j.setTerminalPoint(new mxPoint(o[u].x/d-e.x+m,
o[u].y/d-e.y+n),false);this.model.setTerminal(b[g],null,false)}}this.model.setGeometry(b[g],j)}}}}finally{this.model.endUpdate()}}};a.getCurrentRoot=function(){return this.view.currentRoot};a.getTranslateForRoot=function(){return null};a.isPort=function(){return false};a.getTerminalForPort=function(b){return this.model.getParent(b)};a.getChildOffsetForCell=function(){return null};a.enterGroup=function(b){b=b||this.getSelectionCell();if(b!=null&&this.isValidRoot(b)){this.view.setCurrentRoot(b);this.clearSelection()}};
a.exitGroup=function(){var b=this.model.getRoot(),d=this.getCurrentRoot();if(d!=null){for(var e=this.model.getParent(d);e!=b&&!this.isValidRoot(e)&&this.model.getParent(e)!=b;)e=this.model.getParent(e);e==b||this.model.getParent(e)==b?this.view.setCurrentRoot(null):this.view.setCurrentRoot(e);this.view.getState(d)!=null&&this.setSelectionCell(d)}};a.home=function(){var b=this.getCurrentRoot();if(b!=null){this.view.setCurrentRoot(null);this.view.getState(b)!=null&&this.setSelectionCell(b)}};
a.isValidRoot=function(b){return b!=null};a.getGraphBounds=function(){return this.view.getGraphBounds()};a.getCellBounds=function(b,d,e){var f=[b];if(d)f=f.concat(this.model.getEdges(b));f=this.view.getBounds(f);if(e){e=this.model.getChildCount(b);for(var g=0;g<e;g++){var h=this.getCellBounds(this.model.getChildAt(b,g),d,true);if(f!=null)f.add(h);else f=h}}};
a.getBoundingBoxFromGeometry=function(b){var d=null;if(b!=null)for(var e=0;e<b.length;e++)if(this.model.isVertex(b[e])){var f=this.getCellGeometry(b[e]);if(d==null)d=new mxRectangle(f.x,f.y,f.width,f.height);else d.add(f)}return d};a.refresh=function(b){this.view.clear(b,b==null);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH))};a.snap=function(b){if(this.gridEnabled)b=Math.round(b/this.gridSize)*this.gridSize;return b};
a.panGraph=function(b,d){mxUtils.getCurrentStyle(this.container);if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-b;this.container.scrollTop=-d}else{var e=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG){e.setAttribute("transform","translate("+b+","+d+")");if(b==0&&d==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);this.shiftPreview=null;for(var f=this.container.firstChild;f!=null;){if(f!=e.parentNode)if(f.style!=
null)f.style.visibility="visible";f=f.nextSibling}}}else{if(this.shiftPreview==null){this.shiftPreview=document.createElement("div");var g=[];for(f=this.container.firstChild;f!=null;){if(f!=e.parentNode){g.push(mxUtils.getInnerHtml(f));if(f.style!=null)f.style.visibility="hidden"}f=f.nextSibling}this.shiftPreview.innerHTML=g.join("");this.shiftPreview.style.position="absolute";this.shiftPreview.style.overflow="visible";f=mxUtils.getOffset(this.container);this.shiftPreview.style.left=f.x+"px";this.shiftPreview.style.top=
f.y+"px";this.container.appendChild(this.shiftPreview)}this.shiftPreview.style.left=b+"px";this.shiftPreview.style.top=d+"px"}}else if(this.dialect==mxConstants.DIALECT_VML)e.setAttribute("coordorigin",-b+","+-d);else if(b==0&&d==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);e.style.visibility="visible";this.shiftPreview=null}}else{if(this.shiftPreview==null){this.shiftPreview=this.view.getDrawPane().cloneNode(false);g=mxUtils.getInnerHtml(this.view.getBackgroundPane());
g+=mxUtils.getInnerHtml(this.view.getDrawPane());this.shiftPreview.innerHTML=g;f=mxUtils.getOffset(this.container);this.shiftPreview.style.position="absolute";this.shiftPreview.style.left=f.x+"px";this.shiftPreview.style.top=f.y+"px";e.style.visibility="hidden";this.container.appendChild(this.shiftPreview)}this.shiftPreview.style.left=b+"px";this.shiftPreview.style.top=d+"px"}}};a.zoomIn=function(){this.zoom(this.zoomFactor)};a.zoomOut=function(){this.zoom(1/this.zoomFactor)};
a.zoomActual=function(){this.view.translate.x=0;this.view.translate.y=0;this.view.setScale(1)};
a.zoom=function(b){var d=this.view.scale*b,e=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&e!=null){b=new mxRectangle(e.x*b,e.y*b,e.width*b,e.height*b);this.view.scale=d;if(!this.scrollRectToVisible(b)){this.view.revalidate();this.view.setScale(d)}}else if(this.centerZoom&&!mxUtils.hasScrollbars(this.container)){e=this.container.offsetWidth;var f=this.container.offsetHeight;if(b>1){b=(b-1)/(d*2);e*=-b;f*=-b}else{b=(1/b-1)/(this.view.scale*2);e*=b;f*=b}this.view.scaleAndTranslate(d,
this.view.translate.x+e,this.view.translate.y+f)}else this.view.setScale(d)};
a.fit=function(b,d){if(this.container!=null){b=b!=null?b:0;d=d!=null?d:false;var e=this.container.offsetWidth,f=this.container.offsetHeight,g=this.view.getGraphBounds();if(d&&g.x!=null&&g.y!=null){g.width+=g.x;g.height+=g.y;g.x=0;g.y=0}var h=this.view.scale,j=g.width/h+1,k=g.height/h+1;if(this.backgroundImage!=null){j=Math.max(j,this.backgroundImage.width-g.x/h);k=Math.max(k,this.backgroundImage.height-g.y/h)}var l=d?b:2*b;e=Math.min(e/(j+l),f/(k+l));if(e>0.1&&e<8){if(!d){this.view.translate.x=g.x!=
null?this.view.translate.x-g.x/h+b:b;this.view.translate.y=g.y!=null?this.view.translate.y-g.y/h+b:b}this.view.setScale(e)}}return this.view.scale};
a.scrollCellToVisible=function(b,d){var e=-this.view.translate.x,f=-this.view.translate.y;b=this.view.getState(b);if(b!=null){e=new mxRectangle(e+b.x,f+b.y,b.width,b.height);if(d&&this.container!=null){d=this.container.clientWidth;f=this.container.clientHeight;e.x=e.getCenterX()-d/2;e.width=d;e.y=e.getCenterY()-f/2;e.height=f}this.scrollRectToVisible(e)&&this.view.setTranslate(this.view.translate.x,this.view.translate.y)}};
a.scrollRectToVisible=function(b){if(b!=null){var d=false,e=this.container.offsetWidth,f=this.container.offsetHeight,g=Math.min(e,b.width),h=Math.min(f,b.height);if(mxUtils.hasScrollbars(this.container)){e=this.container;var j=e.scrollLeft-b.x;f=Math.max(j-e.scrollLeft,0);if(j>0)e.scrollLeft-=j+2;else{j=b.x+g-e.scrollLeft-e.clientWidth;if(j>0)e.scrollLeft+=j+2}g=e.scrollTop-b.y;j=Math.max(0,g-e.scrollTop);if(g>0)e.scrollTop-=g+2;else{g=b.y+h-e.scrollTop-e.clientHeight;if(g>0)e.scrollTop+=g+2}if(!this.useScrollbarsForPanning&&
(f!=0||j!=0))this.view.setTranslate(f,j)}else{j=-this.view.translate.x;var k=-this.view.translate.y,l=this.view.scale;if(b.x+g>j+e){this.view.translate.x-=(b.x+g-e-j)/l;d=true}if(b.y+h>k+f){this.view.translate.y-=(b.y+h-f-k)/l;d=true}if(b.x<j){this.view.translate.x+=(j-b.x)/l;d=true}if(b.y<k){this.view.translate.y+=(k-b.y)/l;d=true}d&&this.view.refresh()}}return d};a.getCellGeometry=function(b){return this.model.getGeometry(b)};a.isCellVisible=function(b){return this.model.isVisible(b)};
a.isCellCollapsed=function(b){return this.model.isCollapsed(b)};a.isCellConnectable=function(b){return this.model.isConnectable(b)};a.isOrthogonal=function(b){var d=b.style[mxConstants.STYLE_ORTHOGONAL];if(d!=null)return d;b=this.view.getEdgeStyle(b);return b==mxEdgeStyle.ElbowConnector||b==mxEdgeStyle.SideToSide||b==mxEdgeStyle.TopToBottom||b==mxEdgeStyle.EntityRelation};
a.isLoop=function(b){var d=this.view.getVisibleTerminal(b.cell,true);b=this.view.getVisibleTerminal(b.cell,false);return d!=null&&d==b};a.isCloneEvent=function(b){return mxEvent.isControlDown(b)};a.isToggleEvent=function(b){return mxEvent.isControlDown(b)};a.isGridEnabledEvent=function(b){return b!=null&&!mxEvent.isAltDown(b)};a.isConstrainedEvent=function(b){return mxEvent.isShiftDown(b)};a.isForceMarqueeEvent=function(b){return mxEvent.isAltDown(b)||mxEvent.isMetaDown(b)};a.validationAlert=function(b){mxUtils.alert(b)};
a.isEdgeValid=function(b,d,e){return this.getEdgeValidationError(b,d,e)==null};
a.getEdgeValidationError=function(b,d,e){if(b!=null&&this.model.getTerminal(b,true)==null&&this.model.getTerminal(b,false)==null)return null;if(!this.allowLoops&&d==e&&d!=null)return"";if(!this.isValidConnection(d,e))return"";if(d!=null&&e!=null){var f="";if(!this.multigraph){var g=this.model.getEdgesBetween(d,e,true);if(g.length>1||g.length==1&&g[0]!=b)f+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n"}g=this.model.getDirectedEdgeCount(d,true,b);for(var h=this.model.getDirectedEdgeCount(e,
false,b),j=0;j<this.multiplicities.length;j++){var k=this.multiplicities[j].check(this,b,d,e,g,h);if(k!=null)f+=k}k=this.validateEdge(b,d,e);if(k!=null)f+=k;return f.length>0?f:null}return this.allowDanglingEdges?null:""};a.validateEdge=function(){return null};
a.validateGraph=function(b,d){b=b!=null?b:this.model.getRoot();d=d!=null?d:{};for(var e=true,f=this.model.getChildCount(b),g=0;g<f;g++){var h=this.model.getChildAt(b,g),j=d;if(this.isValidRoot(h))j={};j=this.validateGraph(h,j);if(j!=null){var k=j.replace(/\n/g,"<br>");this.setCellWarning(h,k.substring(0,Math.max(0,k.length-4)))}else this.setCellWarning(h,null);e=e&&j==null}f="";if(this.isCellCollapsed(b)&&!e)f+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+
"\n";f+=this.model.isEdge(b)?this.getEdgeValidationError(b,this.model.getTerminal(b,true),this.model.getTerminal(b,false))||"":this.getCellValidationError(b)||"";d=this.validateCell(b,d);if(d!=null)f+=d;this.model.getParent(b)==null&&this.view.validate();return f.length>0||!e?f:null};
a.getCellValidationError=function(b){var d=this.model.getDirectedEdgeCount(b,true),e=this.model.getDirectedEdgeCount(b,false);b=this.model.getValue(b);for(var f="",g=0;g<this.multiplicities.length;g++){var h=this.multiplicities[g];if(h.source&&mxUtils.isNode(b,h.type,h.attr,h.value)&&(h.max==0&&d>0||h.min==1&&d==0||h.max==1&&d>1))f+=h.countError+"\n";else if(!h.source&&mxUtils.isNode(b,h.type,h.attr,h.value)&&(h.max==0&&e>0||h.min==1&&e==0||h.max==1&&e>1))f+=h.countError+"\n"}return f.length>0?f:
null};a.validateCell=function(){return null};a.getBackgroundImage=function(){return this.backgroundImage};a.setBackgroundImage=function(b){this.backgroundImage=b};a.getFoldingImage=function(b){if(b!=null){var d=this.isCellCollapsed(b.cell);if(this.isCellFoldable(b.cell,!d))return d?this.collapsedImage:this.expandedImage}return null};
a.convertValueToString=function(b){b=this.model.getValue(b);if(b!=null)if(mxUtils.isNode(b))return b.nodeName;else if(typeof b.toString=="function")return b.toString();return""};a.getLabel=function(b){var d="";if(b!=null){var e=this.view.getState(b);e=e!=null?e.style:this.getCellStyle(b);if(this.labelsVisible&&!mxUtils.getValue(e,mxConstants.STYLE_NOLABEL,false))d=this.convertValueToString(b)}return d};a.isHtmlLabel=function(){return this.isHtmlLabels()};a.isHtmlLabels=function(){return this.htmlLabels};
a.setHtmlLabels=function(b){this.htmlLabels=b};a.isWrapping=function(b){var d=this.view.getState(b);b=d!=null?d.style:this.getCellStyle(b);return b!=null?b[mxConstants.STYLE_WHITE_SPACE]=="wrap":false};a.isLabelClipped=function(b){var d=this.view.getState(b);b=d!=null?d.style:this.getCellStyle(b);return b!=null?b[mxConstants.STYLE_OVERFLOW]=="hidden":false};
a.getTooltip=function(b,d){var e=null;if(b!=null){if(b.control!=null&&(d==b.control.node||d.parentNode==b.control.node)){e=this.collapseExpandResource;e=mxResources.get(e)||e}if(e==null&&b.overlays!=null)for(var f=0;f<b.overlays.length;f++)if(d==b.overlays[f].node||d.parentNode==b.overlays[f].node){e=this.getCellOverlays(b.cell)[f].toString();break}if(e==null){f=this.selectionCellsHandler.getHandler(b.cell);if(f!=null&&typeof f.getTooltipForNode=="function")e=f.getTooltipForNode(d)}if(e==null)e=this.getTooltipForCell(b.cell)}return e};
a.getTooltipForCell=function(b){var d=null;return d=b.getTooltip!=null?b.getTooltip():this.convertValueToString(b)};a.getCursorForCell=function(){return null};a.getStartSize=function(b){var d=new mxRectangle,e=this.view.getState(b);b=e!=null?e.style:this.getCellStyle(b);if(b!=null){e=parseInt(mxUtils.getValue(b,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(mxUtils.getValue(b,mxConstants.STYLE_HORIZONTAL,true))d.height=e;else d.width=e}return d};
a.getImage=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_IMAGE]:null};a.getVerticalAlign=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE:null};a.getIndicatorColor=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_INDICATOR_COLOR]:null};a.getIndicatorGradientColor=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};
a.getIndicatorShape=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};a.getIndicatorImage=function(b){return b!=null&&b.style!=null?b.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};a.getBorder=function(){return this.border};a.setBorder=function(b){this.border=b};
a.isSwimlane=function(b){if(b!=null)if(this.model.getParent(b)!=this.model.getRoot()){var d=this.view.getState(b);d=d!=null?d.style:this.getCellStyle(b);if(d!=null&&!this.model.isEdge(b))return d[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}return false};a.isResizeContainer=function(){return this.resizeContainer};a.setResizeContainer=function(b){this.resizeContainer=b};a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isEscapeEnabled=function(){return this.escapeEnabled};
a.setEscapeEnabled=function(b){this.escapeEnabled=b};a.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing};a.setInvokesStopCellEditing=function(b){this.invokesStopCellEditing=b};a.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing};a.setEnterStopsCellEditing=function(b){this.enterStopsCellEditing=b};a.isCellLocked=function(b){var d=this.model.getGeometry(b);return this.isCellsLocked()||d!=null&&this.model.isVertex(b)&&d.relative};a.isCellsLocked=function(){return this.cellsLocked};
a.setCellsLocked=function(b){this.cellsLocked=b};a.getCloneableCells=function(b){return this.model.filterCells(b,mxUtils.bind(this,function(d){return this.isCellCloneable(d)}))};a.isCellCloneable=function(){return this.isCellsCloneable()};a.isCellsCloneable=function(){return this.cellsCloneable};a.setCellsCloneable=function(b){this.cellsCloneable=b};a.getExportableCells=function(b){return this.model.filterCells(b,mxUtils.bind(this,function(d){return this.canExportCell(d)}))};a.canExportCell=function(){return this.exportEnabled};
a.getImportableCells=function(b){return this.model.filterCells(b,mxUtils.bind(this,function(d){return this.canImportCell(d)}))};a.canImportCell=function(){return this.importEnabled};a.isCellSelectable=function(){return this.isCellsSelectable()};a.isCellsSelectable=function(){return this.cellsSelectable};a.setCellsSelectable=function(b){this.cellsSelectable=b};a.getDeletableCells=function(b){return this.model.filterCells(b,mxUtils.bind(this,function(d){return this.isCellDeletable(d)}))};
a.isCellDeletable=function(){return this.isCellsDeletable()};a.isCellsDeletable=function(){return this.cellsDeletable};a.setCellsDeletable=function(b){this.cellsDeletable=b};a.isLabelMovable=function(b){return!this.isCellLocked(b)&&(this.model.isEdge(b)&&this.edgeLabelsMovable||this.model.isVertex(b)&&this.vertexLabelsMovable)};a.getMovableCells=function(b){return this.model.filterCells(b,mxUtils.bind(this,function(d){return this.isCellMovable(d)}))};
a.isCellMovable=function(b){return this.isCellsMovable()&&!this.isCellLocked(b)};a.isCellsMovable=function(){return this.cellsMovable};a.setCellsMovable=function(b){this.cellsMovable=b};a.isGridEnabled=function(){return this.gridEnabled};a.setGridEnabled=function(b){this.gridEnabled=b};a.getGridSize=function(){return this.gridSize};a.setGridSize=function(b){this.gridSize=b};a.getTolerance=function(){return this.tolerance};a.setTolerance=function(b){this.tolerance=b};a.isVertexLabelsMovable=function(){return this.vertexLabelsMovable};
a.setVertexLabelsMovable=function(b){this.vertexLabelsMovable=b};a.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable};a.setEdgeLabelsMovable=function(b){this.edgeLabelsMovable=b};a.isSwimlaneNesting=function(){return this.swimlaneNesting};a.setSwimlaneNesting=function(b){this.swimlaneNesting=b};a.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};a.setSwimlaneSelectionEnabled=function(b){this.swimlaneSelectionEnabled=b};a.isMultigraph=function(){return this.multigraph};
a.setMultigraph=function(b){this.multigraph=b};a.isAllowLoops=function(){return this.allowLoops};a.setAllowDanglingEdges=function(b){this.allowDanglingEdges=b};a.isAllowDanglingEdges=function(){return this.allowDanglingEdges};a.setConnectableEdges=function(b){this.connectableEdges=b};a.isConnectableEdges=function(){return this.connectableEdges};a.setCloneInvalidEdges=function(b){this.cloneInvalidEdges=b};a.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};
a.setAllowLoops=function(b){this.allowLoops=b};a.isDisconnectOnMove=function(){return this.disconnectOnMove};a.setDisconnectOnMove=function(b){this.disconnectOnMove=b};a.isDropEnabled=function(){return this.dropEnabled};a.setDropEnabled=function(b){this.dropEnabled=b};a.isSplitEnabled=function(){return this.splitEnabled};a.setSplitEnabled=function(b){this.splitEnabled=b};a.isCellResizable=function(b){return this.isCellsResizable()&&!this.isCellLocked(b)};a.isCellsResizable=function(){return this.cellsResizable};
a.setCellsResizable=function(b){this.cellsResizable=b};a.isCellBendable=function(b){return this.isCellsBendable()&&!this.isCellLocked(b)};a.isCellsBendable=function(){return this.cellsBendable};a.setCellsBendable=function(b){this.cellsBendable=b};a.isCellEditable=function(b){return this.isCellsEditable()&&!this.isCellLocked(b)};a.isCellsEditable=function(){return this.cellsEditable};a.setCellsEditable=function(b){this.cellsEditable=b};
a.isCellDisconnectable=function(b){return this.isCellsDisconnectable()&&!this.isCellLocked(b)};a.isCellsDisconnectable=function(){return this.cellsDisconnectable};a.setCellsDisconnectable=function(b){this.cellsDisconnectable=b};a.isValidSource=function(b){return b==null&&this.allowDanglingEdges||b!=null&&(!this.model.isEdge(b)||this.connectableEdges)&&this.isCellConnectable(b)};a.isValidTarget=function(b){return this.isValidSource(b)};
a.isValidConnection=function(b,d){return this.isValidSource(b)&&this.isValidTarget(d)};a.setConnectable=function(b){this.connectionHandler.setEnabled(b)};a.isConnectable=function(){return this.connectionHandler.isEnabled()};a.setTooltips=function(b){this.tooltipHandler.setEnabled(b)};a.setPanning=function(b){this.panningHandler.panningEnabled=b};a.isEditing=function(b){if(this.cellEditor!=null){var d=this.cellEditor.getEditingCell();return b==null?d!=null:b==d}return false};a.isAutoSizeCell=function(){return this.isAutoSizeCells()};
a.isAutoSizeCells=function(){return this.autoSizeCells};a.setAutoSizeCells=function(b){this.autoSizeCells=b};a.isExtendParent=function(b){return!this.getModel().isEdge(b)&&this.isExtendParents()};a.isExtendParents=function(){return this.extendParents};a.setExtendParents=function(b){this.extendParents=b};a.isExtendParentsOnAdd=function(){return this.extendParentsOnAdd};a.setExtendParentsOnAdd=function(b){this.extendParentsOnAdd=b};a.isConstrainChild=function(){return this.isConstrainChildren()};
a.isConstrainChildren=function(){return this.constrainChildren};a.setConstrainChildren=function(b){this.constrainChildren=b};a.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates};a.setAllowNegativeCoordinates=function(b){this.allowNegativeCoordinates=b};a.getOverlap=function(b){return this.isAllowOverlapParent(b)?this.defaultOverlap:0};a.isAllowOverlapParent=function(){return false};
a.getFoldableCells=function(b,d){return this.model.filterCells(b,mxUtils.bind(this,function(e){return this.isCellFoldable(e,d)}))};a.isCellFoldable=function(b){return this.model.getChildCount(b)>0};a.isValidDropTarget=function(b,d,e){return b!=null&&(this.isSplitEnabled()&&this.isSplitTarget(b,d,e)||!this.model.isEdge(b)&&(this.isSwimlane(b)||this.model.getChildCount(b)>0&&!this.isCellCollapsed(b)))};
a.isSplitTarget=function(b,d){if(this.model.isEdge(b)&&d!=null&&d.length==1&&this.isCellConnectable(d[0])&&this.getEdgeValidationError(b,this.model.getTerminal(b,true),d[0])==null){var e=this.model.getTerminal(b,true);b=this.model.getTerminal(b,false);return!this.model.isAncestor(d[0],e)&&!this.model.isAncestor(d[0],b)}return false};
a.getDropTarget=function(b,d,e){if(!this.isSwimlaneNesting())for(var f=0;f<b.length;f++)if(this.isSwimlane(b[f]))return null;f=mxUtils.convertPoint(this.container,mxEvent.getClientX(d),mxEvent.getClientY(d));f=this.getSwimlaneAt(f.x,f.y);if(e==null)e=f;else if(f!=null){for(var g=this.model.getParent(f);g!=null&&this.isSwimlane(g)&&g!=e;)g=this.model.getParent(g);if(g==e)e=f}for(;e!=null&&!this.isValidDropTarget(e,b,d)&&!this.model.isLayer(e);)e=this.model.getParent(e);return!this.model.isLayer(e)&&
mxUtils.indexOf(b,e)<0?e:null};a.getDefaultParent=function(){var b=this.defaultParent;if(b==null){b=this.getCurrentRoot();if(b==null)b=this.model.getChildAt(this.model.getRoot(),0)}return b};a.setDefaultParent=function(b){this.defaultParent=b};a.getSwimlane=function(b){for(;b!=null&&!this.isSwimlane(b);)b=this.model.getParent(b);return b};
a.getSwimlaneAt=function(b,d,e){e=e||this.getDefaultParent();if(e!=null)for(var f=this.model.getChildCount(e),g=0;g<f;g++){var h=this.model.getChildAt(e,g),j=this.getSwimlaneAt(b,d,h);if(j!=null)return j;else if(this.isSwimlane(h))if(this.intersects(this.view.getState(h),b,d))return h}return null};
a.getCellAt=function(b,d,e,f,g){f=f||true;g=g||true;e=e||this.getDefaultParent();if(e!=null)for(var h=this.model.getChildCount(e)-1;h>=0;h--){var j=this.model.getChildAt(e,h),k=this.getCellAt(b,d,j,f,g);if(k!=null)return k;else if(this.isCellVisible(j)&&(g&&this.model.isEdge(j)||f&&this.model.isVertex(j)))if(this.intersects(this.view.getState(j),b,d))return j}return null};
a.intersects=function(b,d,e){if(b!=null){var f=b.absolutePoints;if(f!=null){b=this.tolerance*this.tolerance;for(var g=f[0],h=1;h<f.length;h++){var j=f[h];if(mxUtils.ptSegDistSq(g.x,g.y,j.x,j.y,d,e)<=b)return true;g=j}}else if(mxUtils.contains(b,d,e))return true}return false};
a.hitsSwimlaneContent=function(b,d,e){var f=this.getView().getState(b);b=this.getStartSize(b);if(f!=null){var g=this.getView().getScale();d-=f.x;e-=f.y;if(b.width>0&&d>0&&d>b.width*g)return true;else if(b.height>0&&e>0&&e>b.height*g)return true}return false};a.getChildVertices=function(b){return this.getChildCells(b,true,false)};a.getChildEdges=function(b){return this.getChildCells(b,false,true)};
a.getChildCells=function(b,d,e){b=b!=null?b:this.getDefaultParent();d=d!=null?d:false;e=e!=null?e:false;b=this.model.getChildCells(b,d,e);d=[];for(e=0;e<b.length;e++)this.isCellVisible(b[e])&&d.push(b[e]);return d};a.getConnections=function(b,d){return this.getEdges(b,d,true,true,false)};a.getIncomingEdges=function(b,d){return this.getEdges(b,d,true,false,false)};a.getOutgoingEdges=function(b,d){return this.getEdges(b,d,false,true,false)};
a.getEdges=function(b,d,e,f,g){e=e!=null?e:true;f=f!=null?f:true;g=g!=null?g:true;for(var h=[],j=this.isCellCollapsed(b),k=this.model.getChildCount(b),l=0;l<k;l++){var m=this.model.getChildAt(b,l);if(j||!this.isCellVisible(m))h=h.concat(this.model.getEdges(m,e,f))}h=h.concat(this.model.getEdges(b,e,f));j=[];for(l=0;l<h.length;l++){k=this.view.getVisibleTerminal(h[l],true);m=this.view.getVisibleTerminal(h[l],false);if(g||k!=m&&(e&&m==b&&(d==null||this.model.getParent(k)==d)||f&&k==b&&(d==null||this.model.getParent(m)==
d)))j.push(h[l])}return j};a.getOpposites=function(b,d,e,f){e=e!=null?e:true;f=f!=null?f:true;var g=[],h={};if(b!=null)for(var j=0;j<b.length;j++){var k=this.view.getVisibleTerminal(b[j],true),l=this.view.getVisibleTerminal(b[j],false);if(k==d&&l!=null&&l!=d&&f){var m=mxCellPath.create(l);if(h[m]==null){h[m]=l;g.push(l)}}else if(l==d&&k!=null&&k!=d&&e){m=mxCellPath.create(k);if(h[m]==null){h[m]=k;g.push(k)}}}return g};
a.getEdgesBetween=function(b,d,e){e=e!=null?e:false;for(var f=this.getEdges(b),g=[],h=0;h<f.length;h++){var j=this.view.getVisibleTerminal(f[h],true),k=this.view.getVisibleTerminal(f[h],false);if(j==b&&k==d||!e&&j==d&&k==b)g.push(f[h])}return g};a.getPointForEvent=function(b){b=mxUtils.convertPoint(this.container,mxEvent.getClientX(b),mxEvent.getClientY(b));var d=this.view.scale,e=this.view.translate;b.x=this.snap(b.x/d-e.x-this.gridSize/2);b.y=this.snap(b.y/d-e.y-this.gridSize/2);return b};
a.getCells=function(b,d,e,f,g,h){h=h||[];if(e>0||f>0){var j=b+e,k=d+f;g=g||this.getDefaultParent();if(g!=null)for(var l=this.model.getChildCount(g),m=0;m<l;m++){var n=this.model.getChildAt(g,m),o=this.view.getState(n);if(this.isCellVisible(n)&&o!=null)o.x>=b&&o.y>=d&&o.x+o.width<=j&&o.y+o.height<=k?h.push(n):this.getCells(b,d,e,f,n,h)}}return h};
a.getCellsBeyond=function(b,d,e,f,g){var h=[];if(f||g){if(e==null)e=this.getDefaultParent();if(e!=null)for(var j=this.model.getChildCount(e),k=0;k<j;k++){var l=this.model.getChildAt(e,k),m=this.view.getState(l);if(this.isCellVisible(l)&&m!=null)if((!f||m.x>=b)&&(!g||m.y>=d))h.push(l)}}return h};
a.findTreeRoots=function(b,d,e){d=d!=null?d:false;e=e!=null?e:false;var f=[];if(b!=null){for(var g=this.getModel(),h=g.getChildCount(b),j=null,k=0,l=0;l<h;l++){var m=g.getChildAt(b,l);if(this.model.isVertex(m)&&this.isCellVisible(m)){for(var n=this.getConnections(m,d?b:null),o=0,p=0,q=0;q<n.length;q++)if(this.view.getVisibleTerminal(n[q],true)==m)o++;else p++;if(e&&o==0&&p>0||!e&&p==0&&o>0)f.push(m);n=e?p-o:o-p;if(n>k){k=n;j=m}}}f.length==0&&j!=null&&f.push(j)}return f};
a.traverse=function(b,d,e,f,g){if(e!=null&&b!=null){d=d!=null?d:true;g=g||[];var h=mxCellPath.create(b);if(g[h]==null){g[h]=b;f=e(b,f);if(f==null||f){f=this.model.getEdgeCount(b);if(f>0)for(h=0;h<f;h++){var j=this.model.getEdgeAt(b,h),k=this.model.getTerminal(j,true)==b;if(!d||k)this.traverse(this.model.getTerminal(j,!k),d,e,j,g)}}}}};a.isCellSelected=function(b){return this.getSelectionModel().isSelected(b)};a.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()};
a.clearSelection=function(){return this.getSelectionModel().clear()};a.getSelectionCount=function(){return this.getSelectionModel().cells.length};a.getSelectionCell=function(){return this.getSelectionModel().cells[0]};a.getSelectionCells=function(){return this.getSelectionModel().cells.slice()};a.setSelectionCell=function(b){this.getSelectionModel().setCell(b)};a.setSelectionCells=function(b){this.getSelectionModel().setCells(b)};a.addSelectionCell=function(b){this.getSelectionModel().addCell(b)};
a.addSelectionCells=function(b){this.getSelectionModel().addCells(b)};a.removeSelectionCell=function(b){this.getSelectionModel().removeCell(b)};a.removeSelectionCells=function(b){this.getSelectionModel().removeCells(b)};a.selectRegion=function(b,d){b=this.getCells(b.x,b.y,b.width,b.height);this.selectCellsForEvent(b,d);return b};a.selectNextCell=function(){this.selectCell(true)};a.selectPreviousCell=function(){this.selectCell()};a.selectParentCell=function(){this.selectCell(false,true)};
a.selectChildCell=function(){this.selectCell(false,false,true)};
a.selectCell=function(b,d,e){var f=this.selectionModel,g=f.cells.length>0?f.cells[0]:null;f.cells.length>1&&f.clear();f=g!=null?this.model.getParent(g):this.getDefaultParent();var h=this.model.getChildCount(f);if(g==null&&h>0){b=this.model.getChildAt(f,0);this.setSelectionCell(b)}else if((g==null||d)&&this.view.getState(f)!=null&&this.model.getGeometry(f)!=null)this.getCurrentRoot()!=f&&this.setSelectionCell(f);else if(g!=null&&e){if(this.model.getChildCount(g)>0){b=this.model.getChildAt(g,0);this.setSelectionCell(b)}}else if(h>
0){d=f.getIndex(g);if(b){d++;b=this.model.getChildAt(f,d%h)}else{d--;b=this.model.getChildAt(f,d<0?h-1:d)}this.setSelectionCell(b)}};a.selectAll=function(b){b=b||this.getDefaultParent();b=this.model.getChildren(b);b!=null&&this.setSelectionCells(b)};a.selectVertices=function(b){this.selectCells(true,false,b)};a.selectEdges=function(b){this.selectCells(false,true,b)};
a.selectCells=function(b,d,e){e=e||this.getDefaultParent();this.setSelectionCells(this.model.filterDescendants(mxUtils.bind(this,function(f){return this.view.getState(f)!=null&&this.model.getChildCount(f)==0&&(this.model.isVertex(f)&&b||this.model.isEdge(f)&&d)}),e))};a.selectCellForEvent=function(b,d){var e=this.isCellSelected(b);if(this.isToggleEvent(d))e?this.removeSelectionCell(b):this.addSelectionCell(b);else if(!e||this.getSelectionCount()!=1)this.setSelectionCell(b)};
a.selectCellsForEvent=function(b,d){this.isToggleEvent(d)?this.addSelectionCells(b):this.setSelectionCells(b)};a.createHandler=function(b){var d=null;if(b!=null)if(this.model.isEdge(b.cell)){d=this.view.getEdgeStyle(b);d=this.isLoop(b)||d==mxEdgeStyle.ElbowConnector||d==mxEdgeStyle.SideToSide||d==mxEdgeStyle.TopToBottom?new mxElbowEdgeHandler(b):new mxEdgeHandler(b)}else d=new mxVertexHandler(b);return d};a.addMouseListener=function(b){if(this.mouseListeners==null)this.mouseListeners=[];this.mouseListeners.push(b)};
a.removeMouseListener=function(b){if(this.mouseListeners!=null)for(var d=0;d<this.mouseListeners.length;d++)if(this.mouseListeners[d]==b){this.mouseListeners.splice(d,1);break}};
a.fireMouseEvent=function(b,d,e){if(e==null)e=this;if(b==mxEvent.MOUSE_DOWN)this.isMouseDown=true;if(mxClient.IS_TOUCH&&this.doubleTapEnabled&&b==mxEvent.MOUSE_DOWN){var f=(new Date).getTime();if(f-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-d.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-d.getY())<this.doubleTapTolerance){this.lastTouchTime=0;this.dblClick(d.getEvent(),d.getCell());d.getEvent().cancelBubble=true}else{this.lastTouchX=d.getX();this.lastTouchY=d.getY();
this.lastTouchTime=f}}if((b!=mxEvent.MOUSE_UP||this.isMouseDown)&&d.getEvent().detail!=2){if(b==mxEvent.MOUSE_UP)this.isMouseDown=false;if(!this.isEditing()&&(mxClient.IS_GC||d.getEvent().target!=this.container)){if(b==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll){f=mxUtils.convertPoint(this.container,d.getX(),d.getY());this.scrollPointToVisible(f.x,f.y,this.autoExtend)}if(this.mouseListeners!=null){e=[e,d];d.getEvent().returnValue=true;for(f=0;f<this.mouseListeners.length;f++){var g=this.mouseListeners[f];
if(b==mxEvent.MOUSE_DOWN)g.mouseDown.apply(g,e);else if(b==mxEvent.MOUSE_MOVE)g.mouseMove.apply(g,e);else b==mxEvent.MOUSE_UP&&g.mouseUp.apply(g,e)}}b==mxEvent.MOUSE_UP&&this.click(d)}}else if(b==mxEvent.MOUSE_UP)this.isMouseDown=false};
a.destroy=function(){if(!this.destroyed){this.destroyed=true;this.tooltipHandler!=null&&this.tooltipHandler.destroy();this.selectionCellsHandler!=null&&this.selectionCellsHandler.destroy();this.panningHandler!=null&&this.panningHandler.destroy();this.connectionHandler!=null&&this.connectionHandler.destroy();this.graphHandler!=null&&this.graphHandler.destroy();this.cellEditor!=null&&this.cellEditor.destroy();this.view!=null&&this.view.destroy();this.container=null}};
function mxCellOverlay(b,d,e,f){this.image=b;this.tooltip=d;this.align=e;this.verticalAlign=f}mxCellOverlay.prototype=new mxEventSource;a=mxCellOverlay.prototype;a.constructor=mxCellOverlay;a.image=null;a.tooltip=null;a.align=null;a.verticalAlign=null;a.defaultOverlap=0.5;
a.getBounds=function(b){var d=b.view.graph.getModel().isEdge(b.cell),e=b.view.scale,f=null,g=this.image.width,h=this.image.height;if(d){d=b.absolutePoints;if(d.length%2==1)f=d[Math.floor(d.length/2)];else{f=d.length/2;b=d[f-1];d=d[f];f=new mxPoint(b.x+(d.x-b.x)/2,b.y+(d.y-b.y)/2)}}else{f=new mxPoint;f.x=this.align==mxConstants.ALIGN_LEFT?b.x:this.align==mxConstants.ALIGN_CENTER?b.x+b.width/2:b.x+b.width;f.y=this.verticalAlign==mxConstants.ALIGN_TOP?b.y:this.verticalAlign==mxConstants.ALIGN_MIDDLE?
b.y+b.height/2:b.y+b.height}return new mxRectangle(f.x-g*this.defaultOverlap*e,f.y-h*this.defaultOverlap*e,g*e,h*e)};a.toString=function(){return this.tooltip};
function mxOutline(b,d){this.source=b;this.outline=new mxGraph(d,b.getModel(),this.graphRenderHint);if(mxClient.IS_NS){d=this.outline.getView().getCanvas().parentNode;d.setAttribute("shape-rendering","optimizeSpeed");d.setAttribute("image-rendering","optimizeSpeed")}this.outline.setStylesheet(b.getStylesheet());this.outline.setEnabled(false);this.outline.labelsVisible=false;b.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.update()}));this.outline.addMouseListener(this);d=
mxUtils.bind(this,function(){this.active||this.update()});this.source.getModel().addListener(mxEvent.CHANGE,d);var e=this.source.getView();e.addListener(mxEvent.SCALE,d);e.addListener(mxEvent.TRANSLATE,d);e.addListener(mxEvent.SCALE_AND_TRANSLATE,d);e.addListener(mxEvent.DOWN,d);e.addListener(mxEvent.UP,d);mxEvent.addListener(b.container,"scroll",d);b.addListener(mxEvent.REFRESH,mxUtils.bind(this,function(){this.outline.setStylesheet(b.getStylesheet());this.outline.refresh()}));this.bounds=new mxRectangle(0,
0,0,0);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=this.outline.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.outline.getView().getOverlayPane());mxEvent.redirectMouseEvents(this.selectionBorder.node,this.outline);this.selectionBorder.node.style.background="";this.sizer=new mxRectangleShape(this.bounds,mxConstants.OUTLINE_HANDLE_FILLCOLOR,
mxConstants.OUTLINE_HANDLE_STROKECOLOR);this.sizer.dialect=this.outline.dialect;this.sizer.init(this.outline.getView().getOverlayPane());if(this.enabled)this.sizer.node.style.cursor="pointer";mxEvent.addListener(this.sizer.node,"mousedown",mxUtils.bind(this,function(f){this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(f))}));this.selectionBorder.node.style.display=this.showViewport?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;this.selectionBorder.node.style.cursor=
"move";this.refresh()}a=mxOutline.prototype;a.source=null;a.outline=null;a.graphRenderHint=mxConstants.RENDERING_HINT_FASTER;a.enabled=true;a.showViewport=true;a.border=10;a.sizerSize=4;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.setZoomEnabled=function(b){this.sizer.node.style.visibility=b?"visible":"hidden"};a.refresh=function(){this.update();this.outline.refresh()};
a.update=function(b){var d=this.source.view.scale,e=this.source.getGraphBounds();e=new mxRectangle(e.x/d,e.y/d,e.width/d,e.height/d);var f=Math.min(0,e.x),g=Math.min(0,e.y);f=new mxRectangle(-f,-g,this.source.container.clientWidth/d,this.source.container.clientHeight/d);e.add(f);f=Math.max(this.source.container.scrollWidth/d,e.width+e.x);d=Math.max(this.source.container.scrollHeight/d,e.height+e.y);g=Math.max(0,this.outline.container.clientWidth-this.border);var h=Math.max(0,this.outline.container.clientHeight-
this.border);g=Math.min(g/f,h/d);if(g>0){if(this.outline.getView().scale!=g){this.outline.getView().scale=g;b=true}d=this.outline.getView();d.currentRoot!=this.source.getView().currentRoot&&d.setCurrentRoot(this.source.getView().currentRoot);f=this.source.view.translate;g=f.x;h=f.y;if(e.x<0)g=f.x-e.x;if(e.y<0)h=f.y-e.y;if(d.translate.x!=g||d.translate.y!=h){d.translate.x=g;d.translate.y=h;b=true}e=d.translate;g=this.source.getView().scale;h=g/d.scale;var j=1/d.scale,k=this.source.container;this.bounds=
new mxRectangle((e.x-f.x)/j,(e.y-f.y)/j,k.clientWidth/h,k.clientHeight/h);this.bounds.x+=this.source.container.scrollLeft*d.scale/g;this.bounds.y+=this.source.container.scrollTop*d.scale/g;this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw();e=this.sizerSize;this.sizer.bounds=new mxRectangle(this.bounds.x+this.bounds.width-e,this.bounds.y+this.bounds.height-e,2*e,2*e);this.sizer.redraw();b&&this.outline.view.revalidate()}};
a.mouseDown=function(b,d){if(this.enabled&&this.showViewport){this.zoom=d.isSource(this.sizer);this.startX=d.getX();this.startY=d.getY();this.active=true;if(this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)){this.dx0=this.source.container.scrollLeft;this.dy0=this.source.container.scrollTop}else this.dy0=this.dx0=0}d.consume()};
a.mouseMove=function(b,d){if(this.active){this.selectionBorder.node.style.display=this.showViewport?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;b=d.getX()-this.startX;var e=d.getY()-this.startY,f=null;if(this.zoom){f=this.source.container;e=b/(f.clientWidth/f.clientHeight);f=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+b),Math.max(1,this.bounds.height+e));this.selectionBorder.bounds=f;this.selectionBorder.redraw()}else{var g=this.outline.getView().scale;
f=new mxRectangle(this.bounds.x+b,this.bounds.y+e,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=f;this.selectionBorder.redraw();b/=g;b*=this.source.getView().scale;e/=g;e*=this.source.getView().scale;this.source.panGraph(-b-this.dx0,-e-this.dy0)}b=this.sizerSize;this.sizer.bounds=new mxRectangle(f.x+f.width-b,f.y+f.height-b,2*b,2*b);this.sizer.redraw();d.consume()}};
a.mouseUp=function(b,d){if(this.active){b=d.getX()-this.startX;var e=d.getY()-this.startY;if(Math.abs(b)>0||Math.abs(e)>0){if(this.zoom){e=this.selectionBorder.bounds.width;var f=this.source.getView().scale;this.source.getView().setScale(f-b*f/e)}else if(!this.source.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.source.container)){this.source.panGraph(0,0);b/=this.outline.getView().scale;e/=this.outline.getView().scale;f=this.source.getView().translate;this.source.getView().setTranslate(f.x-
b,f.y-e)}this.update();d.consume()}this.index=null;this.active=false}};function mxMultiplicity(b,d,e,f,g,h,j,k,l,m){this.source=b;this.type=d;this.attr=e;this.value=f;this.min=g!=null?g:0;this.max=h!=null?h:"n";this.validNeighbors=j;this.countError=mxResources.get(k)||k;this.typeError=mxResources.get(l)||l;this.validNeighborsAllowed=m!=null?m:true}a=mxMultiplicity.prototype;a.type=null;a.attr=null;a.value=null;a.source=null;a.min=null;a.max=null;a.validNeighbors=null;a.validNeighborsAllowed=true;
a.countError=null;a.typeError=null;
a.check=function(b,d,e,f,g,h){d=b.model.getValue(e);f=b.model.getValue(f);e="";if(this.source&&this.checkType(b,d,this.type,this.attr,this.value)||!this.source&&this.checkType(b,f,this.type,this.attr,this.value)){if(this.countError!=null&&(this.source&&(this.max==0||g>=this.max)||!this.source&&(this.max==0||h>=this.max)))e+=this.countError+"\n";g=this.validNeighbors;if(g!=null&&g.length>0){h=!this.validNeighborsAllowed;for(var j=0;j<g.length;j++)if(this.source&&this.checkType(b,f,g[j])){h=this.validNeighborsAllowed;
break}else if(!this.source&&this.checkType(b,d,g[j])){h=this.validNeighborsAllowed;break}if(!h&&this.typeError!=null)e+=this.typeError+"\n"}}return e.length>0?e:null};a.checkType=function(b,d,e,f,g){if(d!=null)return isNaN(d.nodeType)?d==e:mxUtils.isNode(d,e,f,g);return false};
function mxLayoutManager(b){this.undoHandler=mxUtils.bind(this,function(d,e){this.isEnabled()&&this.beforeUndo(e.getProperty("edit"))});this.moveHandler=mxUtils.bind(this,function(d,e){this.isEnabled()&&this.cellsMoved(e.getProperty("cells"),e.getProperty("event"))});this.setGraph(b)}mxLayoutManager.prototype=new mxEventSource;a=mxLayoutManager.prototype;a.constructor=mxLayoutManager;a.graph=null;a.bubbling=true;a.enabled=true;a.updateHandler=null;a.moveHandler=null;a.isEnabled=function(){return this.enabled};
a.setEnabled=function(b){this.enabled=b};a.isBubbling=function(){return this.bubbling};a.setBubbling=function(b){this.bubbling=b};a.getGraph=function(){return this.graph};a.setGraph=function(b){if(this.graph!=null){var d=this.graph.getModel();d.removeListener(this.undoHandler);this.graph.removeListener(this.moveHandler)}this.graph=b;if(this.graph!=null){d=this.graph.getModel();d.addListener(mxEvent.BEFORE_UNDO,this.undoHandler);this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler)}};
a.getLayout=function(){return null};a.beforeUndo=function(b){b=this.getCellsForChanges(b.changes);var d=this.getGraph().getModel();if(this.isBubbling())for(var e=d.getParents(b);e.length>0;){b=b.concat(e);e=d.getParents(e)}this.layoutCells(mxUtils.sortCells(b,false))};
a.cellsMoved=function(b,d){if(b!=null&&d!=null){d=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(d),mxEvent.getClientY(d));for(var e=this.getGraph().getModel(),f=0;f<b.length;f++){var g=this.getLayout(e.getParent(b[f]));g!=null&&g.moveCell(b[f],d.x,d.y)}}};
a.getCellsForChanges=function(b){for(var d=[],e={},f=0;f<b.length;f++){var g=b[f];if(g instanceof mxRootChange)return[];else{g=this.getCellsForChange(g);for(var h=0;h<g.length;h++)if(g[h]!=null){var j=mxCellPath.create(g[h]);if(e[j]==null){e[j]=g[h];d.push(g[h])}}}}return d};
a.getCellsForChange=function(b){var d=this.getGraph().getModel();if(b.constructor==mxChildChange)return[b.child,b.previous,d.getParent(b.child)];else if(b.constructor==mxTerminalChange||b.constructor==mxGeometryChange)return[b.cell,d.getParent(b.cell)];return[]};
a.layoutCells=function(b){if(b.length>0){var d=this.getGraph().getModel();d.beginUpdate();try{for(var e=null,f=0;f<b.length;f++)if(b[f]!=d.getRoot()&&b[f]!=e){e=b[f];this.executeLayout(this.getLayout(e),e)}this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",b))}finally{d.endUpdate()}}};a.executeLayout=function(b,d){b!=null&&d!=null&&b.execute(d)};a.destroy=function(){this.setGraph(null)};
function mxSpaceManager(b,d,e,f){this.resizeHandler=mxUtils.bind(this,function(g,h){this.isEnabled()&&this.cellsResized(h.getProperty("cells"))});this.foldHandler=mxUtils.bind(this,function(g,h){this.isEnabled()&&this.cellsResized(h.getProperty("cells"))});this.shiftRightwards=d!=null?d:true;this.shiftDownwards=e!=null?e:true;this.extendParents=f!=null?f:true;this.setGraph(b)}mxSpaceManager.prototype=new mxEventSource;a=mxSpaceManager.prototype;a.constructor=mxSpaceManager;a.graph=null;
a.enabled=true;a.shiftRightwards=true;a.shiftDownwards=true;a.extendParents=true;a.resizeHandler=null;a.foldHandler=null;a.isCellIgnored=function(b){return!this.getGraph().getModel().isVertex(b)};a.isCellShiftable=function(b){return this.getGraph().getModel().isVertex(b)&&this.getGraph().isCellMovable(b)};a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isShiftRightwards=function(){return this.shiftRightwards};
a.setShiftRightwards=function(b){this.shiftRightwards=b};a.isShiftDownwards=function(){return this.shiftDownwards};a.setShiftDownwards=function(b){this.shiftDownwards=b};a.isExtendParents=function(){return this.extendParents};a.setExtendParents=function(b){this.extendParents=b};a.getGraph=function(){return this.graph};
a.setGraph=function(b){if(this.graph!=null){this.graph.removeListener(this.resizeHandler);this.graph.removeListener(this.foldHandler)}this.graph=b;if(this.graph!=null){this.graph.addListener(mxEvent.RESIZE_CELLS,this.resizeHandler);this.graph.addListener(mxEvent.FOLD_CELLS,this.foldHandler)}};a.cellsResized=function(b){if(b!=null){var d=this.graph.getModel();d.beginUpdate();try{for(var e=0;e<b.length;e++)if(!this.isCellIgnored(b[e])){this.cellResized(b[e]);break}}finally{d.endUpdate()}}};
a.cellResized=function(b){var d=this.getGraph(),e=d.getView(),f=d.getModel(),g=e.getState(b),h=e.getState(f.getParent(b));if(g!=null&&h!=null){var j=this.getCellsToShift(g),k=f.getGeometry(b);if(j!=null&&k!=null){var l=e.translate,m=e.scale;e=g.x-h.origin.x-l.x*m;h=g.y-h.origin.y-l.y*m;l=g.x+g.width;var n=g.y+g.height,o=g.width-k.width*m+e-k.x*m,p=g.height-k.height*m+h-k.y*m,q=1-k.width*m/g.width;g=1-k.height*m/g.height;f.beginUpdate();try{for(k=0;k<j.length;k++)j[k]!=b&&this.isCellShiftable(j[k])&&
this.shiftCell(j[k],o,p,e,h,l,n,q,g,this.isExtendParents()&&d.isExtendParent(j[k]))}finally{f.endUpdate()}}}};
a.shiftCell=function(b,d,e,f,g,h,j,k,l,m){f=this.getGraph();var n=f.getView().getState(b);if(n!=null){var o=f.getModel(),p=o.getGeometry(b);if(p!=null){o.beginUpdate();try{if(this.isShiftRightwards())if(n.x>=h){p=p.clone();p.translate(-d,0)}else{var q=Math.max(0,n.x-x0);p=p.clone();p.translate(-k*q,0)}if(this.isShiftDownwards())if(n.y>=j){p=p.clone();p.translate(0,-e)}else{var r=Math.max(0,n.y-g);p=p.clone();p.translate(0,-l*r)}if(p!=o.getGeometry(b)){o.setGeometry(b,p);m&&f.extendParent(b)}}finally{o.endUpdate()}}}};
a.getCellsToShift=function(b){var d=this.getGraph(),e=d.getModel().getParent(b.cell),f=this.isShiftDownwards(),g=this.isShiftRightwards();return d.getCellsBeyond(b.x+(f?0:b.width),b.y+(f&&g?0:b.height),e,g,f)};a.destroy=function(){this.setGraph(null)};
function mxSwimlaneManager(b,d,e,f){this.addHandler=mxUtils.bind(this,function(g,h){this.isEnabled()&&this.cellsAdded(h.getProperty("cells"))});this.resizeHandler=mxUtils.bind(this,function(g,h){this.isEnabled()&&this.cellsResized(h.getProperty("cells"))});this.horizontal=d!=null?d:true;this.siblings=e!=null?e:true;this.bubbling=f!=null?f:true;this.setGraph(b)}mxSwimlaneManager.prototype=new mxEventSource;a=mxSwimlaneManager.prototype;a.constructor=mxSwimlaneManager;a.graph=null;a.enabled=true;
a.horizontal=true;a.siblings=true;a.bubbling=true;a.addHandler=null;a.resizeHandler=null;a.isSwimlaneIgnored=function(b){return!this.getGraph().isSwimlane(b)};a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isHorizontal=function(){return this.horizontal};a.setHorizontal=function(b){this.horizontal=b};a.isSiblings=function(){return this.siblings};a.setSiblings=function(b){this.siblings=b};a.isBubbling=function(){return this.bubbling};
a.setBubbling=function(b){this.bubbling=b};a.getGraph=function(){return this.graph};a.setGraph=function(b){if(this.graph!=null){this.graph.removeListener(this.addHandler);this.graph.removeListener(this.resizeHandler)}this.graph=b;if(this.graph!=null){this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler);this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler)}};
a.cellsAdded=function(b){if(b!=null){var d=this.getGraph().getModel();d.beginUpdate();try{for(var e=0;e<b.length;e++)this.isSwimlaneIgnored(b[e])||this.swimlaneAdded(b[e])}finally{d.endUpdate()}}};a.swimlaneAdded=function(b){for(var d=this.getGraph().getModel(),e=null,f=d.getParent(b),g=d.getChildCount(f),h=0;h<g;h++){var j=d.getChildAt(f,h);if(j!=b&&!this.isSwimlaneIgnored(j)){e=d.getGeometry(j);break}}e!=null&&this.resizeSwimlane(b,e.width,e.height)};
a.cellsResized=function(b){if(b!=null){var d=this.getGraph().getModel();d.beginUpdate();try{for(var e=0;e<b.length;e++)this.isSwimlaneIgnored(b[e])||this.swimlaneResized(b[e])}finally{d.endUpdate()}}};
a.swimlaneResized=function(b){var d=this.getGraph().getModel(),e=d.getGeometry(b);if(e!=null){var f=e.width;e=e.height;d.beginUpdate();try{var g=d.getParent(b);if(this.isSiblings())for(var h=d.getChildCount(g),j=0;j<h;j++){var k=d.getChildAt(g,j);k!=b&&!this.isSwimlaneIgnored(k)&&this.resizeSwimlane(k,f,e)}if(this.isBubbling()&&!this.isSwimlaneIgnored(g)){this.resizeParent(g,f,e);this.swimlaneResized(g)}}finally{d.endUpdate()}}};
a.resizeSwimlane=function(b,d,e){var f=this.getGraph().getModel(),g=f.getGeometry(b);if(g!=null){g=g.clone();if(this.isHorizontal())g.width=d;else g.height=e;f.setGeometry(b,g)}};a.resizeParent=function(b,d,e){var f=this.getGraph().getModel(),g=f.getGeometry(b);if(g!=null){g=g.clone();var h=this.graph.isSwimlane(b)?this.graph.getStartSize(b):new mxRectangle;if(this.isHorizontal())g.width=d+h.width;else g.height=e+h.height;f.setGeometry(b,g)}};a.destroy=function(){this.setGraph(null)};
function mxTemporaryCellStates(b,d,e){this.view=b;d=d!=null?d:1;this.oldBounds=b.getGraphBounds();this.oldStates=b.getStates();this.oldScale=b.getScale();b.setStates(new mxDictionary);b.setScale(d);if(e!=null){d=b.createState(new mxCell);for(var f=0;f<e.length;f++)b.validateBounds(d,e[f]);var g=null;for(f=0;f<e.length;f++){var h=b.validatePoints(d,e[f]);if(g==null)g=h;else g.add(h)}if(g==null)g=new mxRectangle;b.setGraphBounds(g)}}a=mxTemporaryCellStates.prototype;a.view=null;a.oldStates=null;
a.oldBounds=null;a.oldScale=null;a.destroy=function(){this.view.setScale(this.oldScale);this.view.setStates(this.oldStates);this.view.setGraphBounds(this.oldBounds)};function mxCellStatePreview(b){this.graph=b;this.deltas={}}a=mxCellStatePreview.prototype;a.graph=null;a.deltas=null;a.count=0;a.isEmpty=function(){return this.count==0};
a.moveState=function(b,d,e,f,g){f=f!=null?f:true;g=g!=null?g:true;var h=mxCellPath.create(b.cell),j=this.deltas[h];if(j==null){j=new mxPoint(d,e);this.deltas[h]=j;this.count++}else if(f){j.X+=d;j.Y+=e}else{j.X=d;j.Y=e}g&&this.addEdges(b);return j};
a.show=function(b){var d=this.graph.getModel(),e=d.getRoot();for(var f in this.deltas){var g=mxCellPath.resolve(e,f),h=this.graph.view.getState(g),j=this.deltas[f];g=this.graph.view.getState(d.getParent(g));this.translateState(g,h,j.x,j.y)}for(f in this.deltas){g=mxCellPath.resolve(e,f);h=this.graph.view.getState(g);j=this.deltas[f];g=this.graph.view.getState(d.getParent(g));this.revalidateState(g,h,j.x,j.y,b)}};
a.translateState=function(b,d,e,f){if(d!=null){var g=this.graph.getModel();if(g.isVertex(d.cell)){d.invalid=true;this.graph.view.validateBounds(b,d.cell);b=g.getGeometry(d.cell);var h=mxCellPath.create(d.cell);if(b!=null&&(e!=0||f!=0)&&(!b.relative||this.deltas[h]!=null)){d.x+=e;d.y+=f}}b=g.getChildCount(d.cell);for(h=0;h<b;h++)this.translateState(d,this.graph.view.getState(g.getChildAt(d.cell,h)),e,f)}};
a.revalidateState=function(b,d,e,f,g){if(d!=null){d.invalid=true;this.graph.view.validatePoints(b,d.cell);var h=mxCellPath.create(d.cell);b=this.graph.getModel();var j=b.getGeometry(d.cell);if(j!=null&&e!=0&&f!=0&&b.isVertex(d.cell)&&j.relative&&this.deltas[h]!=null){d.x+=e;d.y+=f;this.graph.view.updateLabelBounds(d);this.graph.cellRenderer.redraw(d)}g!=null&&g(d);h=b.getChildCount(d.cell);for(j=0;j<h;j++)this.revalidateState(d,this.graph.view.getState(b.getChildAt(d.cell,j)),e,f,g)}};
a.addEdges=function(b){for(var d=this.graph.getModel(),e=d.getEdgeCount(b.cell),f=0;f<e;f++){var g=this.graph.view.getState(d.getEdgeAt(b.cell,f));g!=null&&this.moveState(g,0,0)}};function mxConnectionConstraint(b,d){this.point=b;this.perimeter=d!=null?d:true}mxConnectionConstraint.prototype.point=null;mxConnectionConstraint.prototype.perimeter=null;function mxGraphHandler(b){this.graph=b;this.graph.addMouseListener(this)}a=mxGraphHandler.prototype;a.graph=null;a.maxCells=mxClient.IS_IE?20:50;
a.enabled=true;a.highlightEnabled=true;a.cloneEnabled=true;a.moveEnabled=true;a.updateCursor=true;a.selectEnabled=true;a.removeCellsFromParent=true;a.connectOnDrop=false;a.scrollOnMove=true;a.minimumSize=6;a.previewColor="black";a.htmlPreview=false;a.shape=null;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isCloneEnabled=function(){return this.cloneEnabled};a.setCloneEnabled=function(b){this.cloneEnabled=b};a.isMoveEnabled=function(){return this.moveEnabled};
a.setMoveEnabled=function(b){this.moveEnabled=b};a.isSelectEnabled=function(){return this.selectEnabled};a.setSelectEnabled=function(b){this.selectEnabled=b};a.isRemoveCellsFromParent=function(){return this.removeCellsFromParent};a.setRemoveCellsFromParent=function(b){this.removeCellsFromParent=b};
a.mouseDown=function(b,d){if(!d.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(d.getEvent())&&d.getState()!=null){b=d.getCell();this.cell=null;this.delayedSelection=this.graph.isCellSelected(b);this.isSelectEnabled()&&!this.delayedSelection&&this.graph.selectCellForEvent(b,d.getEvent());if(this.isMoveEnabled()){var e=this.graph.model,f=e.getGeometry(b);if(this.graph.isCellMovable(b)&&(!e.isEdge(b)||this.graph.getSelectionCount()>1||f.points!=null&&f.points.length>
0||e.getTerminal(b,true)==null||e.getTerminal(b,false)==null||this.graph.allowDanglingEdges||this.graph.isCloneEvent(d.getEvent())&&this.graph.isCellsCloneable()))this.start(b,d.getX(),d.getY());this.cellWasClicked=true;d.consume()}}};a.getCells=function(){return this.graph.getMovableCells(this.graph.getSelectionCells())};
a.getPreviewBounds=function(b){b=this.graph.getView().getBounds(b);if(b!=null){if(b.width<this.minimumSize){b.x-=(this.minimumSize-b.width)/2;b.width=this.minimumSize}if(b.height<this.minimumSize){b.y-=(this.minimumSize-b.height)/2;b.height=this.minimumSize}}return b};
a.createPreviewShape=function(b){b=new mxRectangleShape(b,null,this.previewColor);b.isDashed=true;if(this.htmlPreview){b.dialect=mxConstants.DIALECT_STRICTHTML;b.init(this.graph.container)}else{b.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;b.init(this.graph.getView().getOverlayPane());if(b.dialect==mxConstants.DIALECT_SVG)b.node.setAttribute("style","pointer-events:none;");else b.node.style.background=""}return b};
a.start=function(b,d,e){this.cell=b;this.first=mxUtils.convertPoint(this.graph.container,d,e);this.cells=this.getCells(this.cell);this.bounds=this.getPreviewBounds(this.cells)};
a.mouseMove=function(b,d){b=this.graph;if(!d.isConsumed()&&b.isMouseDown&&this.cell!=null&&this.first!=null&&this.bounds!=null){var e=mxUtils.convertPoint(b.container,d.getX(),d.getY()),f=e.x-this.first.x;e=e.y-this.first.y;var g=b.tolerance;if(this.shape!=null||Math.abs(f)>g||Math.abs(e)>g){if(this.highlight==null)this.highlight=new mxCellHighlight(this.graph,mxConstants.DROP_TARGET_COLOR,3);if(this.shape==null)this.shape=this.createPreviewShape(this.bounds);var h=b.getView().translate;g=b.getView().scale;
if(b.isGridEnabledEvent(d.getEvent())){var j=this.bounds.x-(this.graph.snap(this.bounds.x/g-h.x)+h.x)*g;h=this.bounds.y-(this.graph.snap(this.bounds.y/g-h.y)+h.y)*g;f=this.graph.snap(f/g)*g-j;e=this.graph.snap(e/g)*g-h}if(b.isConstrainedEvent(d.getEvent()))if(Math.abs(f)>Math.abs(e))e=0;else f=0;this.shape.bounds=new mxRectangle(this.bounds.x+f,this.bounds.y+e,this.bounds.width,this.bounds.height);this.shape.redraw();f=null;e=d.getCell();if(b.isDropEnabled()&&this.highlightEnabled)f=b.getDropTarget(this.cells,
d.getEvent(),e);g=f;for(j=b.getModel();g!=null&&g!=this.cell;)g=j.getParent(g);h=b.isCloneEvent(d.getEvent())&&b.isCellsCloneable()&&this.isCloneEnabled();var k=b.getView().getState(f),l=false;if(k!=null&&g==null&&(j.getParent(this.cell)!=f||h)){if(this.target!=f){this.target=f;this.setHighlightColor(mxConstants.DROP_TARGET_COLOR)}l=true}else{this.target=null;if(this.connectOnDrop&&e!=null&&this.cells.length==1&&b.getModel().isVertex(e)&&b.isCellConnectable(e)){k=b.getView().getState(e);if(k!=null){this.setHighlightColor(b.getEdgeValidationError(null,
this.cell,e)==null?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR);l=true}}}k!=null&&l?this.highlight.highlight(k):this.highlight.hide()}d.consume();mxEvent.consume(d.getEvent())}else if((this.isMoveEnabled()||this.isCloneEnabled())&&this.updateCursor&&!d.isConsumed()&&d.getState()!=null&&!b.isMouseDown){f=b.getCursorForCell(d.getCell());if(f==null&&b.isEnabled()&&b.isCellMovable(d.getCell()))f=b.getModel().isEdge(d.getCell())?mxConstants.CURSOR_MOVABLE_EDGE:mxConstants.CURSOR_MOVABLE_VERTEX;
d.getState().setCursor(f);d.consume()}};a.setHighlightColor=function(b){this.highlight!=null&&this.highlight.setHighlightColor(b)};
a.mouseUp=function(b,d){if(!d.isConsumed()){b=this.graph;if(this.cell!=null&&this.first!=null&&this.shape!=null){var e=mxUtils.convertPoint(b.container,d.getX(),d.getY()),f=b.getView().translate,g=b.getView().scale,h=b.isCloneEvent(d.getEvent())&&b.isCellsCloneable()&&this.isCloneEnabled(),j=(e.x-this.first.x)/g;e=(e.y-this.first.y)/g;if(b.isGridEnabledEvent(d.getEvent())){var k=this.bounds.x-(b.snap(this.bounds.x/g-f.x)+f.x)*g;f=this.bounds.y-(b.snap(this.bounds.y/g-f.y)+f.y)*g;j=b.snap(j)-k/g;e=
b.snap(e)-f/g}if(b.isConstrainedEvent(d.getEvent()))if(Math.abs(j)>Math.abs(e))e=0;else j=0;g=d.getCell();if(this.connectOnDrop&&this.target==null&&g!=null&&b.getModel().isVertex(g)&&b.isCellConnectable(g)&&b.isEdgeValid(null,this.cell,g))b.connectionHandler.connect(this.cell,g,d.getEvent());else{g=b.getSelectionCells();f=this.target;b.isSplitEnabled()&&b.isSplitTarget(f,g,d.getEvent())?b.splitEdge(f,g,null,j,e):this.moveCells(b.getSelectionCells(),j,e,h,this.target,d.getEvent())}}else this.isSelectEnabled()&&
this.delayedSelection&&this.cell!=null&&b.selectCellForEvent(this.cell,d.getEvent())}this.cellWasClicked&&d.consume();this.reset()};a.reset=function(){this.destroyShapes();this.delayedSelection=this.cellWasClicked=false;this.target=this.cell=this.first=null};
a.shouldRemoveCellsFromParent=function(b,d,e){if(this.graph.getModel().isVertex(b)){b=this.graph.getView().getState(b);e=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(e),mxEvent.getClientY(e));return b!=null&&!mxUtils.contains(b,e.x,e.y)}return false};
a.moveCells=function(b,d,e,f,g,h){if(f)b=this.graph.getCloneableCells(b);if(g==null&&this.isRemoveCellsFromParent()&&this.shouldRemoveCellsFromParent(this.graph.getModel().getParent(this.cell),b,h))g=this.graph.getDefaultParent();b=this.graph.moveCells(b,d,e,f,g,h);this.isSelectEnabled()&&this.scrollOnMove&&this.graph.scrollCellToVisible(b[0]);f&&this.graph.setSelectionCells(b)};
a.destroyShapes=function(){if(this.shape!=null){this.shape.destroy();this.shape=null}if(this.highlight!=null){this.highlight.destroy();this.highlight=null}};a.destroy=function(){this.graph.removeMouseListener(this);this.destroyShapes()};function mxPanningHandler(b,d){if(b!=null){this.graph=b;this.factoryMethod=d;this.graph.addMouseListener(this);this.init()}}mxPanningHandler.prototype=new mxPopupMenu;a=mxPanningHandler.prototype;a.constructor=mxPanningHandler;a.graph=null;a.usePopupTrigger=true;
a.useLeftButtonForPanning=false;a.selectOnPopup=true;a.clearSelectionOnBackground=true;a.ignoreCell=false;a.previewEnabled=true;a.useGrid=false;a.panningEnabled=true;a.isPanningEnabled=function(){return this.panningEnabled};a.setPanningEnabled=function(b){this.panningEnabled=b};a.init=function(){mxPopupMenu.prototype.init.apply(this);mxEvent.addListener(this.div,mxClient.IS_TOUCH?"touchmove":"mousemove",mxUtils.bind(this,function(){this.graph.tooltipHandler.hide()}))};
a.isPanningTrigger=function(b){var d=b.getEvent();return this.useLeftButtonForPanning&&(this.ignoreCell||b.getState()==null)&&mxEvent.isLeftMouseButton(d)||mxEvent.isControlDown(d)&&mxEvent.isShiftDown(d)||this.usePopupTrigger&&mxEvent.isPopupTrigger(d)};
a.mouseDown=function(b,d){if(!d.isConsumed()&&this.isEnabled()){this.hideMenu();this.dx0=-this.graph.container.scrollLeft;this.dy0=-this.graph.container.scrollTop;this.popupTrigger=this.isPopupTrigger(d);this.panningTrigger=this.isPanningEnabled()&&this.isPanningTrigger(d);this.startX=d.getX();this.startY=d.getY();if(this.popupTrigger&&mxEvent.isRightMouseButton(d.getEvent())&&mxClient.IS_MAC&&0)this.mouseUp(b,d);else this.panningTrigger&&d.consume()}};
a.mouseMove=function(b,d){b=d.getX()-this.startX;var e=d.getY()-this.startY;if(this.active){if(this.previewEnabled){if(this.useGrid){b=this.graph.snap(b);e=this.graph.snap(e)}this.graph.panGraph(b+this.dx0,e+this.dy0)}d.consume()}else if(this.panningTrigger)this.active=Math.abs(b)>this.graph.tolerance||Math.abs(e)>this.graph.tolerance};
a.mouseUp=function(b,d){b=Math.abs(d.getX()-this.startX);var e=Math.abs(d.getY()-this.startY);if(this.active){mxUtils.getCurrentStyle(this.graph.container);if(!this.graph.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.graph.container)){b=d.getX()-this.startX;e=d.getY()-this.startY;var f=this.graph.getView().scale,g=this.graph.getView().translate;this.graph.panGraph(0,0);this.panGraph(g.x+b/f,g.y+e/f)}d.consume()}else if(this.popupTrigger)if(b<this.graph.tolerance&&e<this.graph.tolerance){b=
d.getCell();this.graph.isEnabled()&&this.selectOnPopup&&b!=null&&!this.graph.isCellSelected(b)&&this.graph.setSelectionCell(b);this.clearSelectionOnBackground&&!this.graph.isCellSelected(b)&&this.graph.clearSelection();this.graph.tooltipHandler.hide();e=mxUtils.getScrollOrigin();e=new mxPoint(d.getX()+e.x,d.getY()+e.y);this.popup(e.x,e.y,b,d.getEvent());d.consume()}this.active=this.popupTrigger=this.panningTrigger=false};a.panGraph=function(b,d){this.graph.getView().setTranslate(b,d)};
a.destroy=function(){this.graph.removeMouseListener(this);mxPopupMenu.prototype.destroy.apply(this)};function mxCellMarker(b,d,e,f){if(b!=null){this.graph=b;this.validColor=d!=null?d:mxConstants.DEFAULT_VALID_COLOR;this.invalidColor=d!=null?e:mxConstants.DEFAULT_INVALID_COLOR;this.hotspot=f!=null?f:mxConstants.DEFAULT_HOTSPOT;this.highlight=new mxCellHighlight(b)}}mxCellMarker.prototype=new mxEventSource;a=mxCellMarker.prototype;a.constructor=mxCellMarker;a.graph=null;a.enabled=true;a.hotspot=mxConstants.DEFAULT_HOTSPOT;
a.hotspotEnabled=false;a.validColor=null;a.invalidColor=null;a.currentColor=null;a.validState=null;a.markedState=null;a.setEnabled=function(b){this.enabled=b};a.isEnabled=function(){return this.enabled};a.setHotspot=function(b){this.hotspot=b};a.getHotspot=function(){return this.hotspot};a.setHotspotEnabled=function(b){this.hotspotEnabled=b};a.isHotspotEnabled=function(){return this.hotspotEnabled};a.hasValidState=function(){return this.validState!=null};a.getValidState=function(){return this.validState};
a.getMarkedState=function(){return this.markedState};a.reset=function(){this.validState=null;if(this.markedState!=null){this.markedState=null;this.unmark()}};
a.process=function(b){var d=null;if(this.isEnabled()){d=this.getState(b);var e=d!=null?this.isValidState(d):false;b=this.getMarkerColor(b.getEvent(),d,e);this.validState=e?d:null;if(d!=this.markedState||b!=this.currentColor){this.currentColor=b;if(d!=null&&this.currentColor!=null){this.markedState=d;this.mark()}else if(this.markedState!=null){this.markedState=null;this.unmark()}}}return d};
a.mark=function(){this.highlight.setHighlightColor(this.currentColor);this.highlight.highlight(this.markedState);this.fireEvent(new mxEventObject(mxEvent.MARK,"state",this.markedState))};a.unmark=function(){this.mark()};a.isValidState=function(){return true};a.getMarkerColor=function(b,d,e){return e?this.validColor:this.invalidColor};a.getState=function(b){var d=this.graph.getView();cell=this.getCell(b);d=this.getStateToMark(d.getState(cell));return d!=null&&this.intersects(d,b)?d:null};
a.getCell=function(b){return b.getCell()};a.getStateToMark=function(b){return b};a.intersects=function(b,d){if(this.hotspotEnabled){d=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY());return mxUtils.intersectsHotspot(b,d.x,d.y,this.hotspot,mxConstants.MIN_HOTSPOT_SIZE,mxConstants.MAX_HOTSPOT_SIZE)}return true};a.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);this.highlight.destroy()};
function mxSelectionCellsHandler(b){this.graph=b;this.handlers=new mxDictionary;this.graph.addMouseListener(this);this.refreshHandler=mxUtils.bind(this,function(){this.refresh()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,
this.refreshHandler);this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler);this.graph.getView().addListener(mxEvent.UP,this.refreshHandler)}a=mxSelectionCellsHandler.prototype;a.graph=null;a.enabled=true;a.refreshHandler=null;a.maxHandlers=100;a.handlers=null;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.getHandler=function(b){return this.handlers.get(b)};a.reset=function(){this.handlers.visit(function(b,d){d.reset.apply(d)})};
a.refresh=function(){var b=this.handlers;this.handlers=new mxDictionary;for(var d=this.graph.getSelectionCells(),e=0;e<d.length;e++){var f=this.graph.view.getState(d[e]);if(f!=null){var g=b.remove(d[e]);if(g!=null)if(g.state!=f){g.destroy();g=null}else g.redraw();if(g==null)g=this.graph.createHandler(f);g!=null&&this.handlers.put(d[e],g)}}b.visit(function(h,j){j.destroy()})};
a.mouseDown=function(b,d){if(this.graph.isEnabled()&&this.isEnabled()){var e=[b,d];this.handlers.visit(function(f,g){g.mouseDown.apply(g,e)})}};a.mouseMove=function(b,d){if(this.graph.isEnabled()&&this.isEnabled()){var e=[b,d];this.handlers.visit(function(f,g){g.mouseMove.apply(g,e)})}};a.mouseUp=function(b,d){if(this.graph.isEnabled()&&this.isEnabled()){var e=[b,d];this.handlers.visit(function(f,g){g.mouseUp.apply(g,e)})}};
a.destroy=function(){this.graph.removeMouseListener(this);if(this.refreshHandler!=null){this.graph.getSelectionModel().removeListener(this.refreshHandler);this.graph.getModel().removeListener(this.refreshHandler);this.graph.getView().removeListener(this.refreshHandler);this.refreshHandler=null}};function mxConnectionHandler(b,d){if(b!=null){this.graph=b;this.factoryMethod=d;this.init()}}a=mxConnectionHandler.prototype;a.graph=null;a.factoryMethod=true;a.moveIconFront=false;a.moveIconBack=false;
a.connectImage=null;a.targetConnectImage=false;a.enabled=true;a.select=true;a.createTarget=false;a.marker=null;a.constraintHandler=null;a.error=null;a.tapAndHoldEnabled=true;a.tapAndHoldDelay=700;a.tapAndHoldInProgress=false;a.tapAndHoldValid=false;a.tapAndHoldTolerance=4;a.initialTouchY=0;a.initialTouchY=0;a.ignoreMouseDown=false;a.start=null;a.edgeState=null;a.changeHandler=null;a.drillHandler=null;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};
a.isCreateTarget=function(){return this.createTarget};a.setCreateTarget=function(b){this.createTarget=b};a.createShape=function(){var b=new mxPolyline([],mxConstants.INVALID_COLOR);b.isDashed=true;b.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;b.init(this.graph.getView().getOverlayPane());if(this.graph.dialect==mxConstants.DIALECT_SVG){b.pipe.setAttribute("style","pointer-events:none;");b.innerNode.setAttribute("style","pointer-events:none;")}return b};
a.init=function(){this.graph.addMouseListener(this);this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.changeHandler=mxUtils.bind(this,function(){if(this.iconState!=null)this.iconState=this.graph.getView().getState(this.iconState.cell);if(this.iconState!=null)this.redrawIcons(this.icons,this.iconState);else{this.destroyIcons(this.icons);this.previous=null}this.constraintHandler.reset()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);
this.graph.getView().addListener(mxEvent.SCALE,this.changeHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.changeHandler);this.drillHandler=mxUtils.bind(this,function(){this.destroyIcons(this.icons)});this.graph.addListener(mxEvent.START_EDITING,this.drillHandler);this.graph.getView().addListener(mxEvent.DOWN,this.drillHandler);this.graph.getView().addListener(mxEvent.UP,this.drillHandler)};
a.createMarker=function(){var b=new mxCellMarker(this.graph);b.hotspotEnabled=true;b.getCell=mxUtils.bind(this,function(d,e){e=mxCellMarker.prototype.getCell.apply(this,arguments);this.error=null;if(e!=null)if(this.isConnecting()){if(this.previous!=null){this.error=this.validateConnection(this.previous.cell,e);if(this.error!=null&&this.error.length==0){e=null;if(this.isCreateTarget())this.error=null}}}else this.isValidSource(e)||(e=null);else if(this.isConnecting()&&!this.isCreateTarget()&&!this.graph.allowDanglingEdges)this.error=
"";return e});b.isValidState=mxUtils.bind(this,function(){return this.isConnecting()?this.error==null:mxCellMarker.prototype.isValidState.apply(b,arguments)});b.getMarkerColor=mxUtils.bind(this,function(){return this.connectImage==null||this.isConnecting()?mxCellMarker.prototype.getMarkerColor.apply(b,arguments):null});b.intersects=mxUtils.bind(this,function(){if(this.connectImage!=null||this.isConnecting())return true;return mxCellMarker.prototype.intersects.apply(b,arguments)});return b};
a.isConnecting=function(){return this.start!=null&&this.shape!=null};a.isValidSource=function(b){return this.graph.isValidSource(b)};a.isValidTarget=function(){return true};a.validateConnection=function(b,d){if(!this.isValidTarget(d))return"";return this.graph.getEdgeValidationError(null,b,d)};a.getConnectImage=function(){return this.connectImage};
a.createIcons=function(b){var d=this.getConnectImage(b);if(d!=null&&b!=null){this.iconState=b;var e=[],f=new mxRectangle(0,0,d.width,d.height),g=new mxImageShape(f,d.src);if(this.moveIconFront){g.dialect=mxConstants.DIALECT_STRICTHTML;g.init(this.graph.container)}else{g.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;g.init(this.graph.getView().getOverlayPane());this.moveIconBack&&g.node.previousSibling!=null&&g.node.parentNode.insertBefore(g.node,
g.node.parentNode.firstChild)}g.node.style.cursor=mxConstants.CURSOR_CONNECT;var h=mxUtils.bind(this,function(){return this.currentState!=null?this.currentState:b});d=mxUtils.bind(this,function(j){if(!mxEvent.isConsumed(j)){this.icon=g;this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(j,h()))}});mxEvent.redirectMouseEvents(g.node,this.graph,h,d);e.push(g);this.redrawIcons(e,this.iconState);return e}return null};
a.redrawIcons=function(b,d){if(b!=null&&b[0]!=null&&d!=null){d=this.getIconPosition(b[0],d);b[0].bounds.x=d.x;b[0].bounds.y=d.y;b[0].redraw()}};a.getIconPosition=function(b,d){var e=this.graph.getView().scale,f=d.getCenterX(),g=d.getCenterY();if(this.graph.isSwimlane(d.cell)){var h=this.graph.getStartSize(d.cell);f=h.width!=0?d.x+h.width*e/2:f;g=h.height!=0?d.y+h.height*e/2:g}return new mxPoint(f-b.bounds.width/2,g-b.bounds.height/2)};
a.destroyIcons=function(b){if(b!=null){this.iconState=null;for(var d=0;d<b.length;d++)b[d].destroy()}};
a.mouseDown=function(b,d){if(this.isEnabled()&&this.graph.isEnabled()&&!d.isConsumed()&&!this.graph.isForceMarqueeEvent(d.getEvent())&&this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null){this.sourceConstraint=this.constraintHandler.currentConstraint;this.previous=this.constraintHandler.currentFocus;this.start=this.constraintHandler.currentPoint;this.edgeState=this.createEdgeState(d);d.consume()}else if(this.isEnabled()&&this.graph.isEnabled()&&!d.isConsumed()&&
!this.graph.isForceMarqueeEvent(d.getEvent())&&this.previous!=null&&this.error==null&&(this.icons==null||this.icons!=null&&this.icon!=null)){this.start=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY());this.edgeState=this.createEdgeState(d);d.consume()}else if(mxClient.IS_TOUCH&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress&&this.isEnabled()&&this.graph.isEnabled()){this.tapAndHoldValid=this.tapAndHoldInProgress=true;this.initialTouchX=d.getX();this.initialTouchY=d.getY();this.previous=
this.graph.view.getState(this.marker.getCell(d));this.previous!=null&&window.setTimeout(mxUtils.bind(this,function(){if(this.tapAndHoldValid){this.marker.currentColor=this.marker.validColor;this.marker.markedState=this.previous;this.marker.mark();this.start=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY());this.edgeState=this.createEdgeState(d)}this.tapAndHoldValid=this.tapAndHoldInProgress=false}),this.tapAndHoldDelay)}this.selectedIcon=this.icon;this.icon=null};a.createEdgeState=function(){return null};
a.mouseMove=function(b,d){if(this.tapAndHoldValid)this.tapAndHoldValid=Math.abs(this.initialTouchX-d.getX())<this.tapAndHoldTolerance&&Math.abs(this.initialTouchY-d.getY())<this.tapAndHoldTolerance;if(!d.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.ignoreMouseDown||this.start!=null||!this.graph.isMouseDown)){var e=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY());b=this.marker.process(d);this.constraintHandler.update(d,this.start==null);this.currentState=b;if(this.previous!=
null&&this.start!=null){var f=this.graph.getView(),g=f.scale,h=g=new mxPoint(this.graph.snap(e.x/g)*g,this.graph.snap(e.y/g)*g);if(b!=null)if(this.constraintHandler.currentConstraint==null){var j=f.getPerimeterFunction(b);if(j!=null){var k=new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());j=j(f.getPerimeterBounds(b),this.edgeState,k,false);if(j!=null)h=j}else h=new mxPoint(b.getCenterX(),b.getCenterY())}else h=this.constraintHandler.currentPoint;if(this.selectedIcon!=null){k=this.selectedIcon.bounds.width;
var l=this.selectedIcon.bounds.height;if(b!=null&&this.targetConnectImage){e=this.getIconPosition(this.selectedIcon,b);this.selectedIcon.bounds.x=e.x;this.selectedIcon.bounds.y=e.y}else{j=mxConstants.TOOLTIP_VERTICAL_OFFSET;this.selectedIcon.bounds=new mxRectangle(e.x,e.y+j,k,l)}this.selectedIcon.redraw()}e=this.start;if(this.sourceConstraint==null){j=f.getPerimeterFunction(this.previous);if(j!=null){j=j(f.getPerimeterBounds(this.previous),this.previous,h,false);if(j!=null)e=j}else e=new mxPoint(this.previous.getCenterX(),
this.previous.getCenterY())}if(b==null){f=h.x-e.x;j=h.y-e.y;k=Math.sqrt(f*f+j*j);h.x-=f*4/k;h.y-=j*4/k}if(this.shape==null){f=Math.abs(g.x-this.start.x);j=Math.abs(g.y-this.start.y);if(f>this.graph.tolerance||j>this.graph.tolerance)this.shape=this.createShape()}if(this.shape!=null){this.shape.points=[e,h];this.drawPreview()}mxEvent.consume(d.getEvent());d.consume()}else if(this.previous!=b){this.destroyIcons(this.icons);this.icons=null;if(b!=null&&this.error==null){this.icons=this.createIcons(b);
if(this.icons==null){b.setCursor(mxConstants.CURSOR_CONNECT);d.consume()}}this.previous=b}else this.previous==b&&b!=null&&this.icons==null&&!this.graph.isMouseDown&&d.consume();this.constraintHandler.currentConstraint!=null&&this.marker.reset();if(!this.graph.isMouseDown&&b!=null&&this.icons!=null){g=false;h=d.getSource();for(f=0;f<this.icons.length&&!g;f++)g=h==this.icons[f].node||h.parentNode==this.icons[f].node;g||this.updateIcons(b,this.icons,d)}}else this.constraintHandler.reset()};
a.updateIcons=function(){};
a.mouseUp=function(b,d){if(!d.isConsumed()&&this.isConnecting()){if(this.error==null){b=this.previous.cell;var e=null;if(this.constraintHandler.currentFocus!=null)e=this.constraintHandler.currentFocus.cell;if(e==null&&this.marker.hasValidState())e=this.marker.validState.cell;this.connect(b,e,d.getEvent(),d.getCell())}else{this.previous!=null&&this.marker.validState!=null&&this.previous.cell==this.marker.validState.cell&&this.graph.selectCellForEvent(this.marker.source,evt);this.error.length>0&&this.graph.validationAlert(this.error)}this.destroyIcons(this.icons);
d.consume()}this.start!=null&&this.reset();this.tapAndHoldValid=this.tapAndHoldInProgress=false};a.reset=function(){if(this.shape!=null){this.shape.destroy();this.shape=null}this.destroyIcons(this.icons);this.icons=null;this.marker.reset();this.constraintHandler.reset();this.icon=this.start=this.sourceConstraint=this.error=this.previous=this.edgeState=this.selectedIcon=null};
a.drawPreview=function(){var b=this.error==null,d=this.getEdgeColor(b);this.shape.dialect==mxConstants.DIALECT_SVG?this.shape.innerNode.setAttribute("stroke",d):this.shape.node.setAttribute("strokecolor",d);this.shape.strokewidth=this.getEdgeWidth(b);this.shape.redraw();mxUtils.repaintGraph(this.graph,this.shape.points[1])};a.getEdgeColor=function(b){return b?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR};a.getEdgeWidth=function(b){return b?3:1};
a.connect=function(b,d,e,f){if(b!=null&&(d!=null||this.isCreateTarget()||this.graph.allowDanglingEdges)){var g=this.graph.getModel(),h=null;g.beginUpdate();try{if(d==null&&this.isCreateTarget()){d=this.createTargetVertex(e,b);if(d!=null){f=this.graph.getDropTarget([d],e,f);if(f==null||!this.graph.getModel().isEdge(f)){var j=this.graph.getView().getState(f);if(j!=null){var k=g.getGeometry(d);k.x-=j.origin.x;k.y-=j.origin.y}}else f=this.graph.getDefaultParent();this.graph.addCell(d,f)}}var l=this.graph.getDefaultParent();
if(g.getParent(b)==g.getParent(d))l=g.getParent(b);f=null;if(this.edgeState!=null)f=this.edgeState.cell.value;h=this.insertEdge(l,null,f,b,d);if(h!=null){this.graph.setConnectionConstraint(h,b,true,this.sourceConstraint);this.graph.setConnectionConstraint(h,d,false,this.constraintHandler.currentConstraint);var m=g.getGeometry(h);if(m==null){m=new mxGeometry;m.relative=true;g.setGeometry(h,m)}if(d==null){var n=this.graph.getPointForEvent(e);m.setTerminalPoint(n,false)}}}finally{g.endUpdate()}this.select&&
this.graph.setSelectionCell(h)}};a.insertEdge=function(b,d,e,f,g){if(this.factoryMethod==null)return this.graph.insertEdge(b,d,e,f,g);else{d=this.createEdge(e,f,g);return d=this.graph.addEdge(d,b,f,g)}};
a.createTargetVertex=function(b,d){var e=this.graph.cloneCells([d])[0],f=this.graph.getModel().getGeometry(e);if(f!=null){b=this.graph.getPointForEvent(b);f.x=this.graph.snap(b.x-f.width/2);f.y=this.graph.snap(b.y-f.height/2);if(this.start!=null){d=this.graph.view.getState(d);if(d!=null){var g=this.graph.isGridEnabled()?this.graph.gridSize:this.graph.tolerance;if(Math.abs(this.graph.snap(this.start.x)-this.graph.snap(b.x))<=g)f.x=d.x;else if(Math.abs(this.graph.snap(this.start.y)-this.graph.snap(b.y))<=
g)f.y=d.y}}}return e};a.createEdge=function(b,d,e){var f=null;if(this.factoryMethod!=null)f=this.factoryMethod(d,e);if(f==null){f=new mxCell(b||"");f.setEdge(true);b=new mxGeometry;b.relative=true;f.setGeometry(b)}return f};
a.destroy=function(){this.graph.removeMouseListener(this);if(this.shape!=null){this.shape.destroy();this.shape=null}if(this.marker!=null){this.marker.destroy();this.marker=null}if(this.constraintHandler!=null){this.constraintHandler.destroy();this.constraintHandler=null}if(this.changeHandler!=null){this.graph.getModel().removeListener(this.changeHandler);this.graph.getView().removeListener(this.changeHandler);this.changeHandler=null}if(this.drillHandler!=null){this.graph.removeListener(this.drillHandler);
this.graph.getView().removeListener(this.drillHandler);this.drillHandler=null}};function mxConstraintHandler(b){this.graph=b}a=mxConstraintHandler.prototype;a.pointImage=new mxImage(mxClient.imageBasePath+"/point.gif",5,5);a.graph=null;a.enabled=true;a.highlightColor=mxConstants.DEFAULT_VALID_COLOR;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};
a.reset=function(){if(this.focusIcons!=null){for(var b=0;b<this.focusIcons.length;b++)this.focusIcons[b].destroy();this.focusIcons=null}if(this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null}this.focusPoints=this.currentFocus=this.currentPoint=this.currentFocusArea=this.currentConstraint=null};a.getTolerance=function(){return this.graph.getTolerance()};a.getImageForConstraint=function(){return this.pointImage};
a.update=function(b,d){if(this.isEnabled()){var e=this.getTolerance(),f=mxUtils.convertPoint(this.graph.container,b.getX(),b.getY());f=new mxRectangle(f.x-e,f.y-e,2*e,2*e);if(this.currentFocusArea==null||!mxUtils.intersects(this.currentFocusArea,f)){this.currentFocusArea=null;if(b.getState()!=this.currentFocus){this.currentFocus=null;if(b.getState()!=null){this.constraints=this.graph.getAllConnectionConstraints(b.getState(),d);if(this.constraints!=null){this.currentFocus=b.getState();this.currentFocusArea=
new mxRectangle(b.getState().x,b.getState().y,b.getState().width,b.getState().height);if(this.focusIcons!=null){for(d=0;d<this.focusIcons.length;d++)this.focusIcons[d].destroy();this.focusPoints=this.focusIcons=null}this.focusIcons=[];this.focusPoints=[];for(d=0;d<this.constraints.length;d++){var g=this.graph.getConnectionPoint(b.getState(),this.constraints[d]),h=this.getImageForConstraint(b.getState(),this.constraints[d],g),j=h.src;h=new mxRectangle(g.x-h.width/2,g.y-h.height/2,h.width,h.height);
h=new mxImageShape(h,j);h.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;h.init(this.graph.getView().getOverlayPane());h.node.previousSibling!=null&&h.node.parentNode.insertBefore(h.node,h.node.parentNode.firstChild);j=mxUtils.bind(this,function(){return this.currentFocus!=null?this.currentFocus:b.getState()});mxEvent.redirectMouseEvents(h.node,this.graph,j);this.currentFocusArea.add(h.bounds);this.focusIcons.push(h);this.focusPoints.push(g)}this.currentFocusArea.grow(e)}}else if(this.focusIcons!=
null){if(this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null}for(d=0;d<this.focusIcons.length;d++)this.focusIcons[d].destroy();this.focusPoints=this.focusIcons=null}}}this.currentPoint=this.currentConstraint=null;if(this.focusIcons!=null&&this.constraints!=null&&(b.getState()==null||this.currentFocus==b.getState()))for(d=0;d<this.focusIcons.length;d++)if(mxUtils.intersects(this.focusIcons[d].bounds,f)){this.currentConstraint=this.constraints[d];this.currentPoint=this.focusPoints[d];
e=this.focusIcons[d].bounds.clone();e.grow(mxClient.IS_IE?3:2);if(mxClient.IS_IE){e.width-=1;e.height-=1}if(this.focusHighlight==null){e=new mxRectangleShape(e,null,this.highlightColor,3);e.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;e.init(this.graph.getView().getOverlayPane());this.focusHighlight=e;j=mxUtils.bind(this,function(){return this.currentFocus!=null?this.currentFocus:b.getState()});mxEvent.redirectMouseEvents(e.node,this.graph,j)}else{this.focusHighlight.bounds=
e;this.focusHighlight.redraw()}break}if(this.currentConstraint==null&&this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null}}};a.destroy=function(){this.reset()};function mxRubberband(b){if(b!=null){this.graph=b;this.graph.addMouseListener(this);mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}}a=mxRubberband.prototype;a.defaultOpacity=20;a.enabled=true;a.isEnabled=function(){return this.enabled};
a.setEnabled=function(b){this.enabled=b};
a.mouseDown=function(b,d){if(!d.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.graph.isForceMarqueeEvent(d.getEvent())||d.getState()==null)){b=mxUtils.getOffset(this.graph.container);var e=mxUtils.getScrollOrigin(this.graph.container);e.x-=b.x;e.y-=b.y;this.start(d.getX()+e.x,d.getY()+e.y);this.dragHandler=mxUtils.bind(this,function(f){this.mouseMove(this.graph,new mxMouseEvent(f))});this.dropHandler=mxUtils.bind(this,function(f){this.mouseUp(this.graph,new mxMouseEvent(f))});b=mxClient.IS_TOUCH?
"touchend":"mouseup";mxEvent.addListener(document,mxClient.IS_TOUCH?"touchmove":"mousemove",this.dragHandler);mxEvent.addListener(document,b,this.dropHandler);d.consume(false)}};a.start=function(b,d){this.first=new mxPoint(b,d)};
a.mouseMove=function(b,d){if(!d.isConsumed()&&this.first!=null){var e=mxUtils.getScrollOrigin(this.graph.container);b=mxUtils.getOffset(this.graph.container);e.x-=b.x;e.y-=b.y;b=d.getX()+e.x;e=d.getY()+e.y;var f=this.first.x-b,g=this.first.y-e,h=this.graph.tolerance;if(this.div!=null||Math.abs(f)>h||Math.abs(g)>h){if(this.div==null)this.div=this.createShape();mxUtils.clearSelection();this.update(b,e);d.consume()}}};
a.createShape=function(){var b=document.createElement("div");b.className="mxRubberband";mxUtils.setOpacity(b,this.defaultOpacity);this.graph.container.appendChild(b);return b};a.mouseUp=function(b,d){b=this.div!=null;this.reset();if(b){this.graph.selectRegion(new mxRectangle(this.x,this.y,this.width,this.height),d.getEvent());d.consume()}};
a.reset=function(){this.div!=null&&this.div.parentNode.removeChild(this.div);var b=mxClient.IS_TOUCH?"touchmove":"mousemove",d=mxClient.IS_TOUCH?"touchend":"mouseup";if(this.dragHandler!=null){mxEvent.removeListener(document,b,this.dragHandler);this.dragHandler=null}if(this.dropHandler!=null){mxEvent.removeListener(document,d,this.dropHandler);this.dropHandler=null}this.first=this.div=null};
a.update=function(b,d){this.x=Math.min(this.first.x,b);this.y=Math.min(this.first.y,d);this.width=Math.max(this.first.x,b)-this.x;this.height=Math.max(this.first.y,d)-this.y;this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";this.div.style.width=Math.max(1,this.width)+"px";this.div.style.height=Math.max(1,this.height)+"px"};a.destroy=function(){if(!this.destroyed){this.graph.removeMouseListener(this);this.reset();this.destroyed=true}};
function mxVertexHandler(b){if(b!=null){this.state=b;this.init()}}a=mxVertexHandler.prototype;a.graph=null;a.state=null;a.singleSizer=false;a.index=null;
a.init=function(){this.graph=this.state.view.graph;this.bounds=this.getSelectionBounds(this.state);this.selectionBorder=this.createSelectionShape(this.bounds);this.selectionBorder.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.graph.getView().getOverlayPane());if(this.selectionBorder.dialect==mxConstants.DIALECT_SVG)this.selectionBorder.node.setAttribute("pointer-events","none");else this.selectionBorder.node.style.background=
"";if(this.graph.isCellMovable(this.state.cell))this.selectionBorder.node.style.cursor=mxConstants.CURSOR_MOVABLE_VERTEX;mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state);if(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells){this.sizers=[];if(this.graph.isCellResizable(this.state.cell)){var b=0;if(!this.singleSizer){this.sizers.push(this.createSizer("nw-resize",b++));this.sizers.push(this.createSizer("n-resize",b++));
this.sizers.push(this.createSizer("ne-resize",b++));this.sizers.push(this.createSizer("w-resize",b++));this.sizers.push(this.createSizer("e-resize",b++));this.sizers.push(this.createSizer("sw-resize",b++));this.sizers.push(this.createSizer("s-resize",b++))}this.sizers.push(this.createSizer("se-resize",b++));b=this.graph.model.getGeometry(this.state.cell);if(b!=null&&!b.relative&&!this.graph.isSwimlane(this.state.cell)&&this.graph.isLabelMovable(this.state.cell)){this.labelShape=this.createSizer(mxConstants.CURSOR_LABEL_HANDLE,
mxEvent.LABEL_HANDLE,mxConstants.LABEL_HANDLE_SIZE,mxConstants.LABEL_HANDLE_FILLCOLOR);this.sizers.push(this.labelShape)}}else if(this.graph.isCellMovable(this.state.cell)&&!this.graph.isCellResizable(this.state.cell)&&this.state.width<2&&this.state.height<2){this.labelShape=this.createSizer(mxConstants.CURSOR_MOVABLE_VERTEX,null,null,mxConstants.LABEL_HANDLE_FILLCOLOR);this.sizers.push(this.labelShape)}}this.redraw()};a.getSelectionBounds=function(b){return new mxRectangle(b.x,b.y,b.width,b.height)};
a.createSelectionShape=function(b){b=new mxRectangleShape(b,null,this.getSelectionColor());b.strokewidth=this.getSelectionStrokeWidth();b.isDashed=this.isSelectionDashed();return b};a.getSelectionColor=function(){return mxConstants.VERTEX_SELECTION_COLOR};a.getSelectionStrokeWidth=function(){return mxConstants.VERTEX_SELECTION_STROKEWIDTH};a.isSelectionDashed=function(){return mxConstants.VERTEX_SELECTION_DASHED};
a.createSizer=function(b,d,e,f){e=e||mxConstants.HANDLE_SIZE;e=this.createSizerShape(new mxRectangle(0,0,e,e),d,f);if(this.state.text!=null&&this.state.text.node.parentNode==this.graph.container){e.bounds.height-=1;e.bounds.width-=1;e.dialect=mxConstants.DIALECT_STRICTHTML;e.init(this.graph.container)}else{e.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;e.init(this.graph.getView().getOverlayPane())}e.node.style.cursor=b;mxEvent.redirectMouseEvents(e.node,
this.graph,this.state);if(!this.isSizerVisible(d))e.node.style.visibility="hidden";return e};a.isSizerVisible=function(){return true};a.createSizerShape=function(b,d,e){return new mxRectangleShape(b,e||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};a.moveSizerTo=function(b,d,e){if(b!=null){b.bounds.x=d-b.bounds.width/2;b.bounds.y=e-b.bounds.height/2;b.redraw()}};
a.getHandleForEvent=function(b){if(b.isSource(this.labelShape))return mxEvent.LABEL_HANDLE;if(this.sizers!=null)for(var d=0;d<this.sizers.length;d++)if(b.isSource(this.sizers[d]))return d;return null};a.mouseDown=function(b,d){if(!d.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(d.getEvent())&&d.getState()==this.state){b=this.getHandleForEvent(d);if(b!=null){this.start(d.getX(),d.getY(),b);d.consume()}}};
a.start=function(b,d,e){b=mxUtils.convertPoint(this.graph.container,b,d);this.startX=b.x;this.startY=b.y;this.index=e;this.selectionBorder.node.style.visibility="hidden";this.preview=this.createSelectionShape(this.bounds);if(this.state.text!=null&&this.state.text.node.parentNode==this.graph.container){this.preview.dialect=mxConstants.DIALECT_STRICTHTML;this.preview.init(this.graph.container)}else{this.preview.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;
this.preview.init(this.graph.view.getOverlayPane())}};
a.mouseMove=function(b,d){if(!d.isConsumed()&&this.index!=null){var e=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY());b=this.graph.isGridEnabledEvent(d.getEvent());var f=this.graph.getView().scale;if(this.index==mxEvent.LABEL_HANDLE){if(b){e.x=this.graph.snap(e.x/f)*f;e.y=this.graph.snap(e.y/f)*f}this.moveSizerTo(this.sizers[8],e.x,e.y);d.consume()}else if(this.index!=null){var g=e.x-this.startX;e=e.y-this.startY;if(b){g=this.graph.snap(g/f)*f;e=this.graph.snap(e/f)*f}this.bounds=this.union(this.state,
g,e,this.index);this.drawPreview();d.consume()}}};a.mouseUp=function(b,d){if(!d.isConsumed()&&this.index!=null&&this.state!=null){var e=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY()),f=this.graph.getView().scale;b=(e.x-this.startX)/f;e=(e.y-this.startY)/f;if(this.graph.isGridEnabledEvent(d.getEvent())){b=this.graph.snap(b);e=this.graph.snap(e)}this.resizeCell(this.state.cell,b,e,this.index);this.reset();d.consume()}};
a.reset=function(){this.index=null;if(this.preview!=null){this.preview.destroy();this.preview=null}this.selectionBorder.node.style.visibility="visible";this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);this.drawPreview()};
a.resizeCell=function(b,d,e,f){var g=this.graph.model.getGeometry(b);if(f==mxEvent.LABEL_HANDLE){g=g.clone();if(g.offset==null)g.offset=new mxPoint(d,e);else{g.offset.x+=d;g.offset.y+=e}this.graph.model.setGeometry(b,g)}else{d=this.union(g,d,e,f);this.graph.resizeCell(b,d)}};
a.union=function(b,d,e,f){if(this.singleSizer)return new mxRectangle(b.x,b.y,Math.max(0,b.width+d),Math.max(0,b.height+e));else{var g=b.x,h=g+b.width,j=b.y;b=j+b.height;if(f>4)b+=e;else if(f<3)j+=e;if(f==0||f==3||f==5)g+=d;else if(f==2||f==4||f==7)h+=d;d=h-g;e=b-j;if(d<0){g+=d;d=Math.abs(d)}if(e<0){j+=e;e=Math.abs(e)}return new mxRectangle(g,j,d,e)}};
a.redraw=function(){this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.sizers!=null){var b=this.state,d=b.x+b.width,e=b.y+b.height;if(this.singleSizer)this.moveSizerTo(this.sizers[0],d,e);else{var f=b.x+b.width/2,g=b.y+b.height/2;this.moveSizerTo(this.sizers[0],b.x,b.y);if(this.sizers.length>1){this.moveSizerTo(this.sizers[1],f,b.y);this.moveSizerTo(this.sizers[2],d,b.y);this.moveSizerTo(this.sizers[3],b.x,g);this.moveSizerTo(this.sizers[4],d,g);this.moveSizerTo(this.sizers[5],
b.x,e);this.moveSizerTo(this.sizers[6],f,e);this.moveSizerTo(this.sizers[7],d,e);this.moveSizerTo(this.sizers[8],f+b.absoluteOffset.x,g+b.absoluteOffset.y)}}}this.drawPreview()};a.drawPreview=function(){if(this.preview!=null){this.preview.bounds=this.bounds;if(this.preview.node.parentNode==this.graph.container){this.preview.bounds.width-=1;this.preview.bounds.height-=1}this.preview.redraw()}this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw()};
a.destroy=function(){if(this.preview!=null){this.preview.destroy();this.preview=null}this.selectionBorder.destroy();this.labelShape=this.selectionBorder=null;if(this.sizers!=null)for(var b=0;b<this.sizers.length;b++){this.sizers[b].destroy();this.sizers[b]=null}};function mxEdgeHandler(b){if(b!=null){this.state=b;this.init()}}a=mxEdgeHandler.prototype;a.graph=null;a.state=null;a.marker=null;a.constraintHandler=null;a.error=null;a.shape=null;a.bends=null;a.labelShape=null;a.cloneEnabled=true;
a.addEnabled=false;a.removeEnabled=false;a.preferHtml=false;
a.init=function(){this.graph=this.state.view.graph;this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.points=[];this.abspoints=this.getSelectionPoints(this.state);this.shape=this.createSelectionShape(this.abspoints);this.shape.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.node.style.cursor=mxConstants.CURSOR_MOVABLE_EDGE;var b=mxClient.IS_TOUCH?
"touchstart":"mousedown",d=mxClient.IS_TOUCH?"touchmove":"mousemove",e=mxClient.IS_TOUCH?"touchend":"mouseup";mxEvent.addListener(this.shape.node,"dblclick",mxUtils.bind(this,function(f){this.graph.dblClick(f,this.state.cell)}));mxEvent.addListener(this.shape.node,b,mxUtils.bind(this,function(f){this.addEnabled&&this.isAddPointEvent(f)?this.addPoint(this.state,f):this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(f,this.state))}));mxEvent.addListener(this.shape.node,d,mxUtils.bind(this,
function(f){var g=this.state.cell;if(this.index!=null){var h=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(f),mxEvent.getClientY(f));g=this.graph.getCellAt(h.x,h.y);if(this.graph.isSwimlane(g)&&this.graph.hitsSwimlaneContent(g,h.x,h.y))g=null}this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(f,this.graph.getView().getState(g)))}));mxEvent.addListener(this.shape.node,e,mxUtils.bind(this,function(f){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(f,this.state))}));
this.preferHtml=this.state.text!=null&&this.state.text.node.parentNode==this.graph.container;if(!this.preferHtml){b=this.graph.view.getState(this.graph.view.getVisibleTerminal(this.state.cell,true));if(b!=null)this.preferHtml=b.text!=null&&b.text.node.parentNode==this.graph.container;if(!this.preferHtml){b=this.graph.view.getState(this.graph.view.getVisibleTerminal(this.state.cell,false));if(b!=null)this.preferHtml=b.text!=null&&b.text.node.parentNode==this.graph.container}}if(this.graph.getSelectionCount()<
mxGraphHandler.prototype.maxCells||mxGraphHandler.prototype.maxCells<=0)this.bends=this.createBends();this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape=new mxRectangleShape(new mxRectangle,mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(this.labelShape);this.labelShape.node.style.cursor=mxConstants.CURSOR_LABEL_HANDLE;mxEvent.redirectMouseEvents(this.labelShape.node,this.graph,this.state);this.redraw()};
a.isAddPointEvent=function(b){return mxEvent.isShiftDown(b)};a.isRemovePointEvent=function(b){return mxEvent.isShiftDown(b)};a.getSelectionPoints=function(b){return b.absolutePoints};a.createSelectionShape=function(b){b=new mxPolyline(b,this.getSelectionColor());b.strokewidth=this.getSelectionStrokeWidth();b.isDashed=this.isSelectionDashed();return b};a.getSelectionColor=function(){return mxConstants.EDGE_SELECTION_COLOR};a.getSelectionStrokeWidth=function(){return mxConstants.EDGE_SELECTION_STROKEWIDTH};
a.isSelectionDashed=function(){return mxConstants.EDGE_SELECTION_DASHED};
a.createMarker=function(){var b=new mxCellMarker(this.graph),d=this;b.getCell=function(){var e=mxCellMarker.prototype.getCell.apply(this,arguments),f=d.graph.getModel();if(e==d.state.cell||e!=null&&!d.graph.connectableEdges&&f.isEdge(e))e=null;return e};b.isValidState=function(e){var f=d.graph.getModel().getTerminal(d.state.cell,!d.isSource);d.error=d.validateConnection(d.isSource?e.cell:f,d.isSource?f:e.cell);return d.error==null};return b};
a.validateConnection=function(b,d){return this.graph.getEdgeValidationError(this.state.cell,b,d)};
a.createBends=function(){for(var b=this.state.cell,d=[],e=0;e<this.abspoints.length;e++)if(this.isHandleVisible(e)){var f=e==this.abspoints.length-1;if((f=e==0||f)||this.graph.isCellBendable(b)){var g=this.createHandleShape(e);this.initBend(g);if(this.isHandleEnabled(e)){g.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(g.node,this.graph,this.state)}d.push(g);if(!f){this.points.push(new mxPoint(0,0));g.node.style.visibility="hidden"}}}return d};a.isHandleEnabled=function(){return true};
a.isHandleVisible=function(b){return!this.abspoints[b].isRouted};a.createHandleShape=function(){return new mxRectangleShape(new mxRectangle,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};a.initBend=function(b){if(this.preferHtml){b.dialect=mxConstants.DIALECT_STRICTHTML;b.init(this.graph.container)}else{b.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;b.init(this.graph.getView().getOverlayPane())}};
a.getHandleForEvent=function(b){if(this.bends!=null)for(var d=0;d<this.bends.length;d++)if(b.isSource(this.bends[d]))return d;if(b.isSource(this.labelShape)||b.isSource(this.state.text))return mxEvent.LABEL_HANDLE;return null};
a.mouseDown=function(b,d){b=null;if(mxClient.IS_NS||d.getState()==this.state)b=this.getHandleForEvent(d);if(!d.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(d.getEvent())&&b!=null){if(this.removeEnabled&&this.isRemovePointEvent(d.getEvent()))this.removePoint(this.state,b);else if(b!=mxEvent.LABEL_HANDLE||this.graph.isLabelMovable(d.getCell()))this.start(d.getX(),d.getY(),b);d.consume()}};
a.start=function(b,d,e){this.startX=b;this.startY=d;this.isSource=this.bends==null?false:e==0;this.isTarget=this.bends==null?false:e==this.bends.length-1;this.isLabel=e==mxEvent.LABEL_HANDLE;if(this.isSource||this.isTarget){b=this.state.cell;d=this.graph.model.getTerminal(b,this.isSource);if(d==null||this.graph.isCellDisconnectable(b,d,this.isSource)){b=this.abspoints[0];d=this.abspoints[this.abspoints.length-1];this.abspoints=[];this.abspoints.push(b);this.abspoints.push(d);this.index=e}}else this.index=
e};
a.mouseMove=function(b,d){if(this.index!=null&&this.marker!=null){var e=this.graph.isGridEnabledEvent(d.getEvent()),f=mxUtils.convertPoint(this.graph.container,d.getX(),d.getY(),e);if(e){b=this.graph.getView().scale;f.x=this.graph.snap(f.x/b)*b;f.y=this.graph.snap(f.y/b)*b}if(this.isLabel){this.label.x=f.x;this.label.y=f.y}else{b=this.state.clone();var g=this.graph.getCellGeometry(this.state.cell).points,h=null,j=null;if(this.isSource||this.isTarget){this.constraintHandler.update(d,this.isSource);this.marker.process(d);
e=this.marker.getValidState();j=this.graph.getView().getVisibleTerminal(this.state.cell,!this.isSource);this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null&&this.marker.reset();if(e!=null)h=e.cell;else if(this.constraintHandler.currentFocus!=null)h=this.constraintHandler.currentFocus.cell;else{b.setAbsoluteTerminalPoint(f,this.isSource);if(this.marker.getMarkedState()==null)this.error=this.graph.allowDanglingEdges?null:""}if(!this.isSource){f=h;h=j;j=f}}else{this.convertPoint(f,
e);if(g==null)g=[f];else g[this.index-1]=f;this.points=g;this.active=true;h=b.view.getVisibleTerminal(this.state.cell,true);j=b.view.getVisibleTerminal(this.state.cell,false)}f=b.view.getState(h);j=b.view.getState(j);h=this.graph.getConnectionConstraint(b,f,true);e=this.graph.getConnectionConstraint(b,j,false);var k=this.constraintHandler.currentConstraint;if(k==null)k=new mxConnectionConstraint;if(this.isSource)h=k;else if(this.isTarget)e=k;if(!this.isSource||f!=null)b.view.updateFixedTerminalPoint(b,
f,true,h);if(!this.isTarget||j!=null)b.view.updateFixedTerminalPoint(b,j,false,e);b.view.updatePoints(b,g,f,j);b.view.updateFloatingTerminalPoints(b,f,j);this.setPreviewColor(this.error==null?this.marker.validColor:this.marker.invalidColor);this.abspoints=b.absolutePoints}this.drawPreview();mxEvent.consume(d.getEvent());d.consume()}};
a.mouseUp=function(b,d){if(this.index!=null&&this.marker!=null){b=this.state.cell;if(d.getX()!=this.startX||d.getY()!=this.startY){if(this.error!=null)this.error.length>0&&this.graph.validationAlert(this.error);else if(this.isLabel)this.moveLabel(this.state,this.label.x,this.label.y);else if(this.isSource||this.isTarget){var e=null;if(this.constraintHandler.currentFocus!=null)e=this.constraintHandler.currentFocus.cell;if(e==null&&this.marker.hasValidState())e=this.marker.validState.cell;if(e!=null)b=
this.connect(b,e,this.isSource,this.graph.isCloneEvent(d.getEvent())&&this.cloneEnabled&&this.graph.isCellsCloneable(),d);else if(this.graph.isAllowDanglingEdges()){e=this.graph.getPointForEvent(d.getEvent());var f=this.graph.getView().getState(this.graph.getModel().getParent(b));if(f!=null){e.x-=f.origin.x;e.y-=f.origin.y}this.changeTerminalPoint(b,e,this.isSource)}}else if(this.active)this.changePoints(b,this.points);else{this.graph.getView().invalidate(this.state.cell);this.graph.getView().revalidate(this.state.cell)}this.abspoints=
this.state.absolutePoints}if(this.marker!=null){this.reset();b!=this.state.cell&&this.graph.setSelectionCell(b)}d.consume()}};a.reset=function(){this.label=this.index=this.error=null;this.isTarget=this.isSource=this.isLabel=this.active=false;this.marker.reset();this.constraintHandler.reset();this.setPreviewColor(mxConstants.EDGE_SELECTION_COLOR);this.redraw()};
a.setPreviewColor=function(b){if(this.shape!=null&&this.shape.node!=null)this.shape.dialect==mxConstants.DIALECT_SVG?this.shape.innerNode.setAttribute("stroke",b):this.shape.node.setAttribute("strokecolor",b)};
a.convertPoint=function(b,d){var e=this.graph.getView().getScale(),f=this.graph.getView().getTranslate();if(d){b.x=this.graph.snap(b.x);b.y=this.graph.snap(b.y)}b.x=b.x/e-f.x;b.y=b.y/e-f.y;d=this.graph.getView().getState(this.graph.getModel().getParent(this.state.cell));if(d!=null){b.x-=d.origin.x;b.y-=d.origin.y}return b};
a.moveLabel=function(b,d,e){var f=this.graph.getModel(),g=f.getGeometry(b.cell);if(g!=null){g=g.clone();var h=this.graph.getView().getRelativePoint(b,d,e);g.x=h.x;g.y=h.y;var j=this.graph.getView().scale;g.offset=new mxPoint(0,0);h=this.graph.view.getPoint(b,g);g.offset=new mxPoint((d-h.x)/j,(e-h.y)/j);f.setGeometry(b.cell,g)}};
a.connect=function(b,d,e,f){var g=this.graph.getModel(),h=g.getParent(b);g.beginUpdate();try{if(f){var j=b.clone();g.add(h,j,g.getChildCount(h));var k=g.getTerminal(b,!e);this.graph.connectCell(j,k,!e);b=j}var l=this.constraintHandler.currentConstraint;if(l==null)l=new mxConnectionConstraint;this.graph.connectCell(b,d,e,l)}finally{g.endUpdate()}return b};
a.changeTerminalPoint=function(b,d,e){var f=this.graph.getModel(),g=f.getGeometry(b);if(g!=null){f.beginUpdate();try{g=g.clone();g.setTerminalPoint(d,e);f.setGeometry(b,g);this.graph.connectCell(b,null,e,new mxConnectionConstraint)}finally{f.endUpdate()}}};a.changePoints=function(b,d){var e=this.graph.getModel(),f=e.getGeometry(b);if(f!=null){f=f.clone();f.points=d;e.setGeometry(b,f)}};
a.addPoint=function(b,d){var e=this.graph.getCellGeometry(b.cell);if(e!=null){e=e.clone();var f=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(d),mxEvent.getClientY(d)),g=mxUtils.findNearestSegment(b,f.x,f.y),h=this.graph.isGridEnabledEvent(d);this.convertPoint(f,h);if(e.points==null)e.points=[f];else e.points.splice(g,0,f);this.graph.getModel().setGeometry(b.cell,e);this.destroy();this.init();mxEvent.consume(d)}};
a.removePoint=function(b,d){if(d>0&&d<this.abspoints.length-1){var e=this.graph.getCellGeometry(this.state.cell);if(e!=null&&e.points!=null){e=e.clone();e.points.splice(d-1,1);this.graph.getModel().setGeometry(b.cell,e);this.destroy();this.init()}}};
a.getHandleFillColor=function(b){b=b==0;var d=this.state.cell,e=this.graph.getModel().getTerminal(d,b),f=mxConstants.HANDLE_FILLCOLOR;if(e!=null)f=this.graph.isCellDisconnectable(d,e,b)?mxConstants.CONNECT_HANDLE_FILLCOLOR:mxConstants.LOCKED_HANDLE_FILLCOLOR;return f};
a.redraw=function(){this.abspoints=this.state.absolutePoints;var b=this.state.cell,d=mxConstants.LABEL_HANDLE_SIZE;this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape.bounds=new mxRectangle(this.label.x-d/2,this.label.y-d/2,d,d);this.labelShape.redraw();d=this.graph.getLabel(b);this.labelShape.node.style.visibility=d!=null&&d.length>0&&this.graph.isLabelMovable(b)?"visible":"hidden";if(this.bends!=null&&this.bends.length>0){this.graph.getModel();d=mxConstants.HANDLE_SIZE;
if(this.preferHtml)d-=1;b=this.abspoints.length-1;var e=this.abspoints[0];this.bends[0].bounds=new mxRectangle(this.abspoints[0].x-d/2,this.abspoints[0].y-d/2,d,d);this.bends[0].fill=this.getHandleFillColor(0);this.bends[0].reconfigure();this.bends[0].redraw();var f=this.abspoints[b],g=this.bends.length-1;this.bends[g].bounds=new mxRectangle(this.abspoints[b].x-d/2,this.abspoints[b].y-d/2,d,d);this.bends[g].fill=this.getHandleFillColor(g);this.bends[g].reconfigure();this.bends[g].redraw();this.redrawInnerBends(e,
f)}this.drawPreview()};a.redrawInnerBends=function(){var b=mxConstants.HANDLE_SIZE,d=this.graph.getModel().getGeometry(this.state.cell).points;if(d!=null)for(var e=1;e<this.bends.length-1;e++)if(this.abspoints[e]!=null){var f=this.abspoints[e].x,g=this.abspoints[e].y;this.bends[e].node.style.visibility="visible";this.bends[e].bounds=new mxRectangle(f-b/2,g-b/2,b,b);this.bends[e].redraw();this.points[e-1]=d[e-1]}else if(this.bends[e]!=null){this.bends[e].destroy();this.bends[e]=null}};
a.drawPreview=function(){if(this.isLabel){var b=mxConstants.LABEL_HANDLE_SIZE;this.labelShape.bounds=new mxRectangle(this.label.x-b/2,this.label.y-b/2,b,b);this.labelShape.redraw()}else{this.shape.points=this.abspoints;this.shape.redraw()}mxUtils.repaintGraph(this.graph,this.shape.points[this.shape.points.length-1])};
a.destroy=function(){this.marker.destroy();this.marker=null;this.shape.destroy();this.shape=null;this.labelShape.destroy();this.labelShape=null;if(this.constraintHandler!=null){this.constraintHandler.destroy();this.constraintHandler=null}if(this.bends!=null)for(var b=0;b<this.bends.length;b++)if(this.bends[b]!=null){this.bends[b].destroy();this.bends[b]=null}};function mxElbowEdgeHandler(b){if(b!=null){this.state=b;this.init()}}mxElbowEdgeHandler.prototype=new mxEdgeHandler;a=mxElbowEdgeHandler.prototype;
a.constructor=mxElbowEdgeHandler;a.flipEnabled=true;a.doubleClickOrientationResource=mxClient.language!="none"?"doubleClickOrientation":"";
a.createBends=function(){var b=[],d=new mxRectangleShape(new mxRectangle,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(d);d.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(d.node,this.graph,this.state);b.push(d);b.push(this.createVirtualBend());this.points.push(new mxPoint(0,0));d=new mxRectangleShape(new mxRectangle,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(d);d.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;
mxEvent.redirectMouseEvents(d.node,this.graph,this.state);b.push(d);return b};
a.createVirtualBend=function(){var b=new mxRectangleShape(new mxRectangle(0,0,1,1),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(b);var d=this.getCursorForBend();b.node.style.cursor=d;d=mxUtils.bind(this,function(e){if(!mxEvent.isConsumed(e)&&this.flipEnabled){this.graph.flipEdge(this.state.cell,e);mxEvent.consume(e)}});mxEvent.redirectMouseEvents(b.node,this.graph,this.state,null,null,null,d);if(!this.graph.isCellBendable(this.state.cell))b.node.style.visibility="hidden";
return b};a.getCursorForBend=function(){return this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_TOPTOBOTTOM||(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_ELBOW)&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL?"row-resize":"col-resize"};
a.getTooltipForNode=function(b){var d=null;if(this.bends!=null&&this.bends[1]!=null&&(b==this.bends[1].node||b.parentNode==this.bends[1].node)){d=this.doubleClickOrientationResource;d=mxResources.get(d)||d}return d};a.convertPoint=function(b,d){var e=this.graph.getView().getScale(),f=this.graph.getView().getTranslate(),g=this.state.origin;if(d){b.x=this.graph.snap(b.x);b.y=this.graph.snap(b.y)}b.x=b.x/e-f.x-g.x;b.y=b.y/e-f.y-g.y};
a.redrawInnerBends=function(b,d){var e=mxConstants.HANDLE_SIZE,f=this.graph.getModel().getGeometry(this.state.cell).points;f=f!=null?f[0]:null;f=f==null?new mxPoint(b.x+(d.x-b.x)/2,b.y+(d.y-b.y)/2):new mxPoint(this.graph.getView().scale*(f.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(f.y+this.graph.getView().translate.y+this.state.origin.y));b=new mxRectangle(f.x-e/2,f.y-e/2,e,e);if(this.labelShape.node.style.visibility!="hidden"&&mxUtils.intersects(b,this.labelShape.bounds)){e+=
3;b=new mxRectangle(f.x-e/2,f.y-e/2,e,e)}this.bends[1].bounds=b;this.bends[1].reconfigure();this.bends[1].redraw()};function mxKeyHandler(b,d){if(b!=null){this.graph=b;this.target=d||document.documentElement;this.normalKeys=[];this.controlKeys=[];mxEvent.addListener(this.target,"keydown",mxUtils.bind(this,function(e){this.keyDown(e)}));mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}}a=mxKeyHandler.prototype;a.graph=null;a.target=null;
a.normalKeys=null;a.controlKeys=null;a.enabled=true;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.bindKey=function(b,d){this.normalKeys[b]=d};a.bindControlKey=function(b,d){this.controlKeys[b]=d};a.getFunction=function(b){if(b!=null)return mxEvent.isControlDown(b)?this.controlKeys[b.keyCode]:this.normalKeys[b.keyCode];return null};
a.isGraphEvent=function(b){b=mxEvent.getSource(b);if(b==this.target||b.parentNode==this.target||this.graph.cellEditor!=null&&b==this.graph.cellEditor.textarea)return true;for(b=b;b!=null;){if(b==this.graph.container)return true;b=b.parentNode}return false};a.keyDown=function(b){if(this.graph.isEnabled()&&!mxEvent.isConsumed(b)&&this.isGraphEvent(b)&&this.isEnabled())if(b.keyCode==27)this.escape(b);else if(!this.graph.isEditing()){var d=this.getFunction(b);if(d!=null){d(b);mxEvent.consume(b)}}};
a.escape=function(b){this.graph.isEscapeEnabled()&&this.graph.escape(b)};a.destroy=function(){this.target=null};function mxTooltipHandler(b,d){if(b!=null){this.graph=b;this.delay=d||500;this.graph.addMouseListener(this)}}a=mxTooltipHandler.prototype;a.zIndex=10005;a.graph=null;a.delay=null;a.hideOnHover=false;a.enabled=true;a.isEnabled=function(){return this.enabled};a.setEnabled=function(b){this.enabled=b};a.isHideOnHover=function(){return this.hideOnHover};
a.setHideOnHover=function(b){this.hideOnHover=b};
a.init=function(){if(document.body!=null){this.div=document.createElement("div");this.div.className="mxTooltip";this.div.style.visibility="hidden";this.div.style.zIndex=this.zIndex;if(!mxClient.IS_IE&&mxClient.TOOLTIP_SHADOWS){this.shadow=document.createElement("div");this.shadow.className="mxTooltipShadow";this.shadow.style.visibility="hidden";this.shadow.style.zIndex=this.zIndex;mxUtils.setOpacity(this.shadow,70);document.body.appendChild(this.shadow)}else if(mxClient.IS_IE&&!mxClient.TOOLTIP_SHADOWS)this.div.style.filter=
"";document.body.appendChild(this.div);mxEvent.addListener(this.div,"mousedown",mxUtils.bind(this,function(){this.hide()}))}};a.mouseDown=function(b,d){this.reset(d,false);this.hide()};
a.mouseMove=function(b,d){if(d.getX()!=this.lastX||d.getY()!=this.lastY){this.reset(d,true);if(this.isHideOnHover()||d.getState()!=this.state||d.getSource()!=this.node&&(!this.stateSource||d.getState()!=null&&this.stateSource==(d.isSource(d.getState().shape)||!d.isSource(d.getState().text))))this.hide()}this.lastX=d.getX();this.lastY=d.getY()};a.mouseUp=function(b,d){this.reset(d,true);this.hide()};
a.reset=function(b,d){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}if(d&&this.isEnabled()&&b.getState()!=null&&(this.div==null||this.div.style.visibility=="hidden")){var e=b.getState(),f=b.getSource(),g=b.getX(),h=b.getY(),j=b.isSource(e.shape)||b.isSource(e.text);this.thread=window.setTimeout(mxUtils.bind(this,function(){if(!this.graph.isEditing()&&!this.graph.panningHandler.isMenuShowing()){this.show(this.graph.getTooltip(e,f,g,h),g,h);this.state=e;this.node=f;this.stateSource=
j}}),this.delay)}};a.hide=function(){if(this.shadow!=null)this.shadow.style.visibility="hidden";if(this.div!=null)this.div.style.visibility="hidden"};
a.show=function(b,d,e){if(b!=null&&b.length>0){this.div==null&&this.init();var f=mxUtils.getScrollOrigin();this.div.style.left=d+f.x+"px";this.div.style.top=e+mxConstants.TOOLTIP_VERTICAL_OFFSET+f.y+"px";if(mxUtils.isNode(b)){this.div.innerHTML="";this.div.appendChild(b)}else this.div.innerHTML=b.replace(/\n/g,"<br>");this.div.style.visibility="";mxUtils.fit(this.div);if(this.shadow!=null){this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";this.shadow.style.left=
parseInt(this.div.style.left)+3+"px";this.shadow.style.top=parseInt(this.div.style.top)+3+"px";this.shadow.style.visibility=""}}};a.destroy=function(){this.graph.removeMouseListener(this);mxEvent.release(this.div);this.div!=null&&this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div);this.div=null;if(this.shadow!=null){mxEvent.release(this.shadow);this.shadow.parentNode!=null&&this.shadow.parentNode.removeChild(this.shadow);this.shadow=null}};
function mxCellTracker(b,d,e){mxCellMarker.call(this,b,d);this.graph.addMouseListener(this);if(e!=null)this.getCell=e;mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}mxCellTracker.prototype=new mxCellMarker;a=mxCellTracker.prototype;a.constructor=mxCellTracker;a.mouseDown=function(){};a.mouseMove=function(b,d){this.isEnabled()&&this.process(d)};a.mouseUp=function(){this.reset()};
a.destroy=function(){if(!this.destroyed){this.destroyed=true;this.graph.removeMouseListener(this);mxCellMarker.prototype.destroy.apply(this)}};
function mxCellHighlight(b,d,e){if(b!=null){this.graph=b;this.highlightColor=d!=null?d:mxConstants.DEFAULT_VALID_COLOR;this.strokeWidth=e!=null?e:mxConstants.HIGHLIGHT_STROKEWIDTH;this.resetHandler=mxUtils.bind(this,function(){this.hide()});this.graph.getView().addListener(mxEvent.SCALE,this.resetHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.resetHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.resetHandler);this.graph.getView().addListener(mxEvent.DOWN,
this.resetHandler);this.graph.getView().addListener(mxEvent.UP,this.resetHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.resetHandler)}}a=mxCellHighlight.prototype;a.keepOnTop=false;a.graph=true;a.state=null;a.resetHandler=null;
a.setHighlightColor=function(b){this.highlightColor=b;if(this.shape!=null)if(this.shape.dialect==mxConstants.DIALECT_SVG)this.shape.innerNode.setAttribute("stroke",b);else this.shape.dialect==mxConstants.DIALECT_VML&&this.shape.node.setAttribute("strokecolor",b)};
a.createShape=function(b){var d=null;d=this.graph.model.isEdge(b.cell)?new mxPolyline(b.absolutePoints,this.highlightColor,this.strokeWidth):new mxRectangleShape(new mxRectangle(b.x-2,b.y-2,b.width+4,b.height+4),null,this.highlightColor,this.strokeWidth);d.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;d.init(this.graph.getView().getOverlayPane());mxEvent.redirectMouseEvents(d.node,this.graph,b);if(d.dialect==mxConstants.DIALECT_SVG)d.node.setAttribute("style",
"pointer-events:none;");else d.node.style.background="";!this.keepOnTop&&d.node.parentNode.firstChild!=d.node&&d.node.parentNode.insertBefore(d.node,d.node.parentNode.firstChild);this.graph.model.isEdge(b.cell)&&mxUtils.repaintGraph(this.graph,d.points[0]);return d};a.hide=function(){this.highlight(null)};a.highlight=function(b){if(this.state!=b){if(this.shape!=null){this.shape.destroy();this.shape=null}if(b!=null)this.shape=this.createShape(b);this.state=b}};
a.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);if(this.shape!=null){this.shape.destroy();this.shape=null}};function mxDefaultKeyHandler(b){if(b!=null){this.editor=b;this.handler=new mxKeyHandler(b.graph);var d=this.handler.escape;this.handler.escape=function(e){d.apply(this,arguments);b.hideProperties();b.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",e))}}}mxDefaultKeyHandler.prototype.editor=null;
mxDefaultKeyHandler.prototype.handler=null;mxDefaultKeyHandler.prototype.bindAction=function(b,d,e){var f=mxUtils.bind(this,function(){this.editor.execute(d)});e?this.handler.bindControlKey(b,f):this.handler.bindKey(b,f)};mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy();this.handler=null};function mxDefaultPopupMenu(b){this.config=b}a=mxDefaultPopupMenu.prototype;a.imageBasePath=null;a.config=null;
a.createMenu=function(b,d,e,f){if(this.config!=null){var g=this.createConditions(b,e,f);this.addItems(b,d,e,f,g,this.config.firstChild,null)}};
a.addItems=function(b,d,e,f,g,h,j){for(var k=false;h!=null;){if(h.nodeName=="add"){var l=h.getAttribute("if");if(l==null||g[l]){l=h.getAttribute("as");l=mxResources.get(l)||l;var m=mxUtils.eval(mxUtils.getTextContent(h)),n=h.getAttribute("action"),o=h.getAttribute("icon");if(k){d.addSeparator(j);k=false}if(o!=null&&this.imageBasePath)o=this.imageBasePath+o;l=this.addAction(d,b,l,o,m,n,e,j);this.addItems(b,d,e,f,g,h.firstChild,l)}}else if(h.nodeName=="separator")k=true;h=h.nextSibling}};
a.addAction=function(b,d,e,f,g,h,j,k){return b.addItem(e,f,function(l){typeof g=="function"&&g.call(d,d,j,l);h!=null&&d.execute(h,j,l)},k)};
a.createConditions=function(b,d,e){var f=b.graph.getModel(),g=f.getChildCount(d),h=[];h.nocell=d==null;h.ncells=b.graph.getSelectionCount()>1;h.notRoot=f.getRoot()!=f.getParent(b.graph.getDefaultParent());h.cell=d!=null;f=d!=null&&b.graph.getSelectionCount()==1;h.nonEmpty=f&&g>0;h.expandable=f&&b.graph.isCellFoldable(d,false);h.collapsable=f&&b.graph.isCellFoldable(d,true);h.validRoot=f&&b.graph.isValidRoot(d);h.emptyValidRoot=h.validRoot&&g==0;h.swimlane=f&&b.graph.isSwimlane(d);g=this.config.getElementsByTagName("condition");
for(f=0;f<g.length;f++){var j=mxUtils.eval(mxUtils.getTextContent(g[f])),k=g[f].getAttribute("name");if(k!=null&&typeof j=="function")h[k]=j(b,d,e)}return h};function mxDefaultToolbar(b,d){this.editor=d;b!=null&&d!=null&&this.init(b)}a=mxDefaultToolbar.prototype;a.editor=null;a.toolbar=null;a.resetHandler=null;a.spacing=4;a.connectOnDrop=false;
a.init=function(b){if(b!=null){this.toolbar=new mxToolbar(b);this.toolbar.addListener(mxEvent.SELECT,mxUtils.bind(this,function(d,e){var f=e.getProperty("function");this.editor.insertFunction=f!=null?mxUtils.bind(this,function(){f.apply(this,arguments);this.toolbar.resetMode()}):null}));this.resetHandler=mxUtils.bind(this,function(){this.toolbar!=null&&this.toolbar.resetMode(true)});this.editor.graph.addListener(mxEvent.DOUBLE_CLICK,this.resetHandler);this.editor.addListener(mxEvent.ESCAPE,this.resetHandler)}};
a.addItem=function(b,d,e,f){var g=mxUtils.bind(this,function(){this.editor.execute(e)});return this.toolbar.addItem(b,d,g,f)};a.addSeparator=function(b){b=b||mxClient.imageBasePath+"/separator.gif";this.toolbar.addSeparator(b)};a.addCombo=function(){return this.toolbar.addCombo()};a.addActionCombo=function(b){return this.toolbar.addActionCombo(b)};a.addActionOption=function(b,d,e){var f=mxUtils.bind(this,function(){this.editor.execute(e)});this.addOption(b,d,f)};
a.addOption=function(b,d,e){return this.toolbar.addOption(b,d,e)};a.addMode=function(b,d,e,f,g){var h=mxUtils.bind(this,function(){this.editor.setMode(e);g!=null&&g(this.editor)});return this.toolbar.addSwitchMode(b,d,h,f)};
a.addPrototype=function(b,d,e,f,g){var h=null;if(e==null)h=this.toolbar.addMode(b,d,null,f);else{var j=function(){return typeof e=="function"?e():e.clone()},k=mxUtils.bind(this,function(l,m){typeof g=="function"?g(this.editor,j(),l,m):this.drop(j(),l,m);this.toolbar.resetMode();mxEvent.consume(l)});h=this.toolbar.addMode(b,d,k,f);this.installDropHandler(h,function(l,m,n){k(m,n)})}return h};
a.drop=function(b,d,e){var f=this.editor.graph,g=f.getModel();if(e==null||g.isEdge(e)||!this.connectOnDrop||!f.isCellConnectable(e)){for(;e!=null&&!f.isValidDropTarget(e,[b],d);)e=g.getParent(e);this.insert(b,d,e)}else this.connect(b,d,e)};
a.insert=function(b,d,e){var f=this.editor.graph;if(f.canImportCell(b)){var g=mxEvent.getClientX(d),h=mxEvent.getClientY(d);g=mxUtils.convertPoint(f.container,g,h);return f.isSplitEnabled()&&f.isSplitTarget(e,[b],d)?f.splitEdge(e,[b],null,g.x,g.y):this.editor.addVertex(e,b,g.x,g.y)}return null};
a.connect=function(b,d,e){d=this.editor.graph;var f=d.getModel();if(e!=null&&d.isCellConnectable(b)&&d.isEdgeValid(null,e,b)){var g=null;f.beginUpdate();try{var h=f.getGeometry(e),j=f.getGeometry(b).clone();j.x=h.x+(h.width-j.width)/2;j.y=h.y+(h.height-j.height)/2;var k=this.spacing*d.gridSize,l=f.getDirectedEdgeCount(e,true)*20;if(this.editor.horizontalFlow)j.x+=(j.width+h.width)/2+k+l;else j.y+=(j.height+h.height)/2+k+l;b.setGeometry(j);var m=f.getParent(e);d.addCell(b,m);d.constrainChild(b);g=
this.editor.createEdge(e,b);if(f.getGeometry(g)==null){var n=new mxGeometry;n.relative=true;f.setGeometry(g,n)}d.addEdge(g,m,e,b)}finally{f.endUpdate()}d.setSelectionCells([b,g]);d.scrollCellToVisible(b)}};
a.installDropHandler=function(b,d){var e=document.createElement("img");e.setAttribute("src",b.getAttribute("src"));var f=mxUtils.bind(this,function(){e.style.width=2*b.offsetWidth+"px";e.style.height=2*b.offsetHeight+"px";mxUtils.makeDraggable(b,this.editor.graph,d,e);mxEvent.removeListener(e,"load",f)});mxClient.IS_IE?f():mxEvent.addListener(e,"load",f)};
a.destroy=function(){if(this.resetHandler!=null){this.editor.graph.removeListener("dblclick",this.resetHandler);this.editor.removeListener("escape",this.resetHandler);this.resetHandler=null}if(this.toolbar!=null){this.toolbar.destroy();this.toolbar=null}};
function mxEditor(b){this.actions=[];this.addActions();if(document.body!=null){this.cycleAttributeValues=[];this.popupHandler=new mxDefaultPopupMenu;this.undoManager=new mxUndoManager;this.graph=this.createGraph();this.toolbar=this.createToolbar();this.keyHandler=new mxDefaultKeyHandler(this);this.configure(b);this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName;!mxClient.IS_LOCAL&&this.urlInit!=null&&this.createSession();if(this.onInit!=null){if(b=document.cookie.indexOf("mxgraph=seen")<
0)document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2199 02:47:11 UTC; path=/";this.onInit(b)}mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}}mxResources.add(mxClient.basePath+"/resources/editor");mxEditor.prototype=new mxEventSource;a=mxEditor.prototype;a.constructor=mxEditor;a.askZoomResource=mxClient.language!="none"?"askZoom":"";a.lastSavedResource=mxClient.language!="none"?"lastSaved":"";
a.currentFileResource=mxClient.language!="none"?"currentFile":"";a.propertiesResource=mxClient.language!="none"?"properties":"";a.tasksResource=mxClient.language!="none"?"tasks":"";a.helpResource=mxClient.language!="none"?"help":"";a.outlineResource=mxClient.language!="none"?"outline":"";a.outline=null;a.graph=null;a.graphRenderHint=null;a.toolbar=null;a.status=null;a.popupHandler=null;a.undoManager=null;a.keyHandler=null;a.actions=null;a.dblClickAction="edit";a.swimlaneRequired=false;
a.disableContextMenu=true;a.insertFunction=null;a.forcedInserting=false;a.templates=null;a.defaultEdge=null;a.defaultEdgeStyle=null;a.defaultGroup=null;a.groupBorderSize=null;a.filename=null;a.linefeed="&#xa;";a.postParameterName="xml";a.escapePostData=true;a.urlPost=null;a.urlImage=null;a.urlInit=null;a.urlNotify=null;a.urlPoll=null;a.horizontalFlow=false;a.layoutDiagram=false;a.swimlaneSpacing=0;a.maintainSwimlanes=false;a.layoutSwimlanes=false;a.cycleAttributeValues=null;
a.cycleAttributeIndex=0;a.cycleAttributeName="fillColor";a.helpWindowImage=null;a.urlHelp=null;a.tasksWindowImage=null;a.tasksTop=20;a.helpWidth=300;a.helpHeight=260;a.propertiesWidth=240;a.propertiesHeight=null;a.movePropertiesDialog=false;a.validating=false;a.modified=false;a.isModified=function(){return this.modified};a.setModified=function(b){this.modified=b};
a.addActions=function(){this.addAction("save",function(b){b.save()});this.addAction("print",function(b){(new mxPrintPreview(b.graph,1)).open()});this.addAction("show",function(b){mxUtils.show(b.graph,null,10,10)});this.addAction("exportImage",function(b){var d=b.getUrlImage();if(d==null||mxClient.IS_LOCAL)b.execute("show");else{var e=mxUtils.getViewXml(b.graph,1);e=mxUtils.getXml(e,"\n");mxUtils.submit(d,b.postParameterName+"="+e)}});this.addAction("refresh",function(b){b.graph.refresh()});this.addAction("cut",
function(b){b.graph.isEnabled()&&mxClipboard.cut(b.graph)});this.addAction("copy",function(b){b.graph.isEnabled()&&mxClipboard.copy(b.graph)});this.addAction("paste",function(b){b.graph.isEnabled()&&mxClipboard.paste(b.graph)});this.addAction("delete",function(b){b.graph.isEnabled()&&b.graph.removeCells()});this.addAction("group",function(b){b.graph.isEnabled()&&b.graph.setSelectionCell(b.groupCells())});this.addAction("ungroup",function(b){b.graph.isEnabled()&&b.graph.setSelectionCells(b.graph.ungroupCells())});
this.addAction("removeFromParent",function(b){b.graph.isEnabled()&&b.graph.removeCellsFromParent()});this.addAction("undo",function(b){b.graph.isEnabled()&&b.undo()});this.addAction("redo",function(b){b.graph.isEnabled()&&b.redo()});this.addAction("zoomIn",function(b){b.graph.zoomIn()});this.addAction("zoomOut",function(b){b.graph.zoomOut()});this.addAction("actualSize",function(b){b.graph.zoomActual()});this.addAction("fit",function(b){b.graph.fit()});this.addAction("showProperties",function(b,d){b.showProperties(d)});
this.addAction("selectAll",function(b){b.graph.isEnabled()&&b.graph.selectAll()});this.addAction("selectNone",function(b){b.graph.isEnabled()&&b.graph.clearSelection()});this.addAction("selectVertices",function(b){b.graph.isEnabled()&&b.graph.selectVertices()});this.addAction("selectEdges",function(b){b.graph.isEnabled()&&b.graph.selectEdges()});this.addAction("edit",function(b,d){b.graph.isEnabled()&&b.graph.isCellEditable(d)&&b.graph.startEditingAtCell(d)});this.addAction("toBack",function(b){b.graph.isEnabled()&&
b.graph.orderCells(true)});this.addAction("toFront",function(b){b.graph.isEnabled()&&b.graph.orderCells(false)});this.addAction("enterGroup",function(b,d){b.graph.enterGroup(d)});this.addAction("exitGroup",function(b){b.graph.exitGroup()});this.addAction("home",function(b){b.graph.home()});this.addAction("selectPrevious",function(b){b.graph.isEnabled()&&b.graph.selectPreviousCell()});this.addAction("selectNext",function(b){b.graph.isEnabled()&&b.graph.selectNextCell()});this.addAction("selectParent",
function(b){b.graph.isEnabled()&&b.graph.selectParentCell()});this.addAction("selectChild",function(b){b.graph.isEnabled()&&b.graph.selectChildCell()});this.addAction("collapse",function(b){b.graph.isEnabled()&&b.graph.foldCells(true)});this.addAction("collapseAll",function(b){if(b.graph.isEnabled()){var d=b.graph.getChildVertices();b.graph.foldCells(true,false,d)}});this.addAction("expand",function(b){b.graph.isEnabled()&&b.graph.foldCells(false)});this.addAction("expandAll",function(b){if(b.graph.isEnabled()){var d=
b.graph.getChildVertices();b.graph.foldCells(false,false,d)}});this.addAction("bold",function(b){b.graph.isEnabled()&&b.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)});this.addAction("italic",function(b){b.graph.isEnabled()&&b.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)});this.addAction("underline",function(b){b.graph.isEnabled()&&b.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)});this.addAction("shadow",
function(b){b.graph.isEnabled()&&b.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_SHADOW)});this.addAction("alignCellsLeft",function(b){b.graph.isEnabled()&&b.graph.alignCells(mxConstants.ALIGN_LEFT)});this.addAction("alignCellsCenter",function(b){b.graph.isEnabled()&&b.graph.alignCells(mxConstants.ALIGN_CENTER)});this.addAction("alignCellsRight",function(b){b.graph.isEnabled()&&b.graph.alignCells(mxConstants.ALIGN_RIGHT)});this.addAction("alignCellsTop",function(b){b.graph.isEnabled()&&
b.graph.alignCells(mxConstants.ALIGN_TOP)});this.addAction("alignCellsMiddle",function(b){b.graph.isEnabled()&&b.graph.alignCells(mxConstants.ALIGN_MIDDLE)});this.addAction("alignCellsBottom",function(b){b.graph.isEnabled()&&b.graph.alignCells(mxConstants.ALIGN_BOTTOM)});this.addAction("alignFontLeft",function(b){b.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)});this.addAction("alignFontCenter",function(b){b.graph.isEnabled()&&b.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)});
this.addAction("alignFontRight",function(b){b.graph.isEnabled()&&b.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)});this.addAction("alignFontTop",function(b){b.graph.isEnabled()&&b.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)});this.addAction("alignFontMiddle",function(b){b.graph.isEnabled()&&b.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)});this.addAction("alignFontBottom",function(b){b.graph.isEnabled()&&b.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,
mxConstants.ALIGN_BOTTOM)});this.addAction("zoom",function(b){var d=b.graph.getView().scale*100;d=parseFloat(mxUtils.prompt(mxResources.get(b.askZoomResource)||b.askZoomResource,d))/100;isNaN(d)||b.graph.getView().setScale(d)});this.addAction("toggleTasks",function(b){b.tasks!=null?b.tasks.setVisible(!b.tasks.isVisible()):b.showTasks()});this.addAction("toggleHelp",function(b){b.help!=null?b.help.setVisible(!b.help.isVisible()):b.showHelp()});this.addAction("toggleOutline",function(b){b.outline==
null?b.showOutline():b.outline.setVisible(!b.outline.isVisible())});this.addAction("toggleConsole",function(){mxLog.setVisible(!mxLog.isVisible())})};
a.createSession=function(){var b=null;b=this.connect(this.urlInit,this.urlPoll,this.urlNotify,mxUtils.bind(this,function(d){this.fireEvent(new mxEventObject(mxEvent.SESSION,"session",d))}));b.addListener(mxEvent.FIRED,mxUtils.bind(this,function(d,e){d=e.getProperty("changes");d.length<10&&mxEffects.animateChanges(this.graph,d)}));b.addListener(mxEvent.CONNECT,mxUtils.bind(this,function(){this.resetHistory()}))};a.configure=function(b){if(b!=null){(new mxCodec(b.ownerDocument)).decode(b,this);this.resetHistory()}};
a.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"};a.resetHistory=function(){this.lastSnapshot=(new Date).getTime();this.undoManager.clear();this.ignoredChanges=0;this.setModified(false)};a.addAction=function(b,d){this.actions[b]=d};
a.execute=function(b){var d=this.actions[b];if(d!=null)try{var e=arguments;e[0]=this;d.apply(this,e)}catch(f){mxUtils.error("Cannot execute "+b+": "+f.message,280,true);throw f;}else mxUtils.error("Cannot find action "+b,280,true)};a.addTemplate=function(b,d){this.templates[b]=d};a.getTemplate=function(b){return this.templates[b]};
a.createGraph=function(){var b=new mxGraph(null,null,this.graphRenderHint);b.setTooltips(true);b.setPanning(true);this.installDblClickHandler(b);this.installUndoHandler(b);this.installDrillHandler(b);this.installChangeHandler(b);this.installInsertHandler(b);b.panningHandler.factoryMethod=mxUtils.bind(this,function(d,e,f){return this.createPopupMenu(d,e,f)});b.connectionHandler.factoryMethod=mxUtils.bind(this,function(d,e){return this.createEdge(d,e)});this.createSwimlaneManager(b);this.createLayoutManager(b);
return b};a.createSwimlaneManager=function(b){b=new mxSwimlaneManager(b,false);b.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow});b.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes});return b};
a.createLayoutManager=function(b){var d=new mxLayoutManager(b),e=this;d.getLayout=function(f){var g=null,h=e.graph.getModel();if(h.getParent(f)!=null)if(e.layoutSwimlanes&&b.isSwimlane(f)){if(e.swimlaneLayout==null)e.swimlaneLayout=e.createSwimlaneLayout();g=e.swimlaneLayout}else if(e.layoutDiagram&&(b.isValidRoot(f)||h.getParent(h.getParent(f))==null)){if(e.diagramLayout==null)e.diagramLayout=e.createDiagramLayout();g=e.diagramLayout}return g};return d};
a.setGraphContainer=function(b){if(this.graph.container==null){this.graph.init(b);this.rubberband=new mxRubberband(this.graph);this.disableContextMenu&&mxEvent.disableContextMenu(b);mxClient.IS_IE&&new mxDivResizer(b)}};a.installDblClickHandler=function(b){b.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(d,e){d=e.getProperty("cell");if(d!=null&&b.isEnabled()&&this.dblClickAction!=null){this.execute(this.dblClickAction,d);e.consume()}}))};
a.installUndoHandler=function(b){var d=mxUtils.bind(this,function(e,f){this.undoManager.undoableEditHappened(f.getProperty("edit"))});b.getModel().addListener(mxEvent.UNDO,d);b.getView().addListener(mxEvent.UNDO,d);d=function(e,f){e=f.getProperty("edit").changes;b.setSelectionCells(b.getSelectionCellsForChanges(e))};this.undoManager.addListener(mxEvent.UNDO,d);this.undoManager.addListener(mxEvent.REDO,d)};
a.installDrillHandler=function(b){var d=mxUtils.bind(this,function(){this.fireEvent(new mxEventObject(mxEvent.ROOT))});b.getView().addListener(mxEvent.DOWN,d);b.getView().addListener(mxEvent.UP,d)};
a.installChangeHandler=function(b){var d=mxUtils.bind(this,function(e,f){this.setModified(true);this.validating==true&&b.validateGraph();e=f.getProperty("changes");for(f=0;f<e.length;f++){var g=e[f];if(g.constructor==mxRootChange||g.constructor==mxValueChange&&g.cell==this.graph.model.root||g.constructor==mxCellAttributeChange&&g.cell==this.graph.model.root){this.fireEvent(new mxEventObject(mxEvent.ROOT));break}}});b.getModel().addListener(mxEvent.CHANGE,d)};
a.installInsertHandler=function(b){var d=this;b.addMouseListener({mouseDown:function(e,f){if(d.insertFunction!=null&&!f.isPopupTrigger()&&(d.forcedInserting||f.getState()==null)){d.graph.clearSelection();d.insertFunction(f.getEvent(),f.getCell());this.isActive=true;f.consume()}},mouseMove:function(e,f){this.isActive&&f.consume()},mouseUp:function(e,f){if(this.isActive){this.isActive=false;f.consume()}}})};
a.createDiagramLayout=function(){var b=this.graph.gridSize,d=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*b,2*b);d.isVertexIgnored=function(e){return!d.graph.isSwimlane(e)};return d};a.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)};a.createToolbar=function(){return new mxDefaultToolbar(null,this)};a.setToolbarContainer=function(b){this.toolbar.init(b);mxClient.IS_IE&&new mxDivResizer(b)};
a.setStatusContainer=function(b){if(this.status==null){this.status=b;this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var d=(new Date).toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+d)}));this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename)}));mxClient.IS_IE&&new mxDivResizer(b)}};
a.setStatus=function(b){if(this.status!=null&&b!=null)this.status.innerHTML=b};a.setTitleContainer=function(b){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){b.innerHTML=this.getTitle()}));mxClient.IS_IE&&new mxDivResizer(b)};a.treeLayout=function(b,d){b!=null&&(new mxCompactTreeLayout(this.graph,d)).execute(b)};
a.getTitle=function(){for(var b="",d=this.graph,e=d.getCurrentRoot();e!=null&&d.getModel().getParent(d.getModel().getParent(e))!=null;){if(d.isValidRoot(e))b=" > "+d.convertValueToString(e)+b;e=d.getModel().getParent(e)}return this.getRootTitle()+b};a.getRootTitle=function(){return this.graph.convertValueToString(this.graph.getModel().getRoot())};a.undo=function(){this.undoManager.undo()};a.redo=function(){this.undoManager.redo()};
a.groupCells=function(){var b=this.groupBorderSize!=null?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),b)};a.createGroup=function(){return this.graph.getModel().cloneCell(this.defaultGroup)};a.open=function(b){if(b!=null){this.readGraphModel(mxUtils.load(b).getXml().documentElement);this.filename=b;this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",b))}};a.readGraphModel=function(b){(new mxCodec(b.ownerDocument)).decode(b,this.graph.getModel());this.resetHistory()};
a.save=function(b,d){b=b||this.getUrlPost();if(b!=null&&b.length>0){d=this.writeGraphModel(d);this.postDiagram(b,d);this.setModified(false)}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",b))};a.postDiagram=function(b,d){if(this.escapePostData)d=encodeURIComponent(d);mxUtils.post(b,this.postParameterName+"="+d,mxUtils.bind(this,function(e){this.fireEvent(new mxEventObject(mxEvent.POST,"request",e,"url",b,"data",d))}))};
a.writeGraphModel=function(b){b=b!=null?b:this.linefeed;var d=(new mxCodec).encode(this.graph.getModel());return mxUtils.getXml(d,b)};a.getUrlPost=function(){return this.urlPost};a.getUrlImage=function(){return this.urlImage};
a.connect=function(b,d,e,f){var g=null;if(!mxClient.IS_LOCAL){g=new mxSession(this.graph.getModel(),b,d,e);g.addListener(mxEvent.RECEIVE,mxUtils.bind(this,function(h,j){h=j.getProperty("node");h.nodeName=="mxGraphModel"&&this.readGraphModel(h)}));g.addListener(mxEvent.DISCONNECT,f);g.addListener(mxEvent.CONNECT,f);g.addListener(mxEvent.NOTIFY,f);g.addListener(mxEvent.GET,f);g.start()}return g};
a.swapStyles=function(b,d){var e=this.graph.getStylesheet().styles[d];this.graph.getView().getStylesheet().putCellStyle(d,this.graph.getStylesheet().styles[b]);this.graph.getStylesheet().putCellStyle(b,e);this.graph.refresh()};
a.showProperties=function(b){b=b||this.graph.getSelectionCell();if(b==null){b=this.graph.getCurrentRoot();if(b==null)b=this.graph.getModel().getRoot()}if(b!=null){this.graph.stopEditing(true);var d=mxUtils.getOffset(this.graph.container),e=d.x+10;d=d.y;if(this.properties!=null&&!this.movePropertiesDialog){e=this.properties.getX();d=this.properties.getY()}else{var f=this.graph.getCellBounds(b);if(f!=null){e+=f.x+Math.min(200,f.width);d+=f.y}}this.hideProperties();b=this.createProperties(b);if(b!=null){this.properties=
new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,b,e,d,this.propertiesWidth,this.propertiesHeight,false);this.properties.setVisible(true)}}};a.isPropertiesVisible=function(){return this.properties!=null};
a.createProperties=function(b){var d=this.graph.getModel(),e=d.getValue(b);if(mxUtils.isNode(e)){var f=new mxForm("properties");f.addText("ID",b.getId()).setAttribute("readonly","true");var g=null,h=null,j=null,k=null,l=null;if(d.isVertex(b)){g=d.getGeometry(b);if(g!=null){h=f.addText("top",g.y);j=f.addText("left",g.x);k=f.addText("width",g.width);l=f.addText("height",g.height)}}var m=d.getStyle(b),n=f.addText("Style",m||""),o=e.attributes,p=[];for(e=0;e<o.length;e++)p[e]=f.addTextarea(o[e].nodeName,
o[e].nodeValue,o[e].nodeName=="label"?4:2);e=mxUtils.bind(this,function(){this.hideProperties();d.beginUpdate();try{if(g!=null){g=g.clone();g.x=parseFloat(j.value);g.y=parseFloat(h.value);g.width=parseFloat(k.value);g.height=parseFloat(l.value);d.setGeometry(b,g)}n.value.length>0?d.setStyle(b,n.value):d.setStyle(b,null);for(var q=0;q<o.length;q++){var r=new mxCellAttributeChange(b,o[q].nodeName,p[q].value);d.execute(r)}this.graph.isAutoSizeCell(b)&&this.graph.updateCellSize(b)}finally{d.endUpdate()}});
m=mxUtils.bind(this,function(){this.hideProperties()});f.addButtons(e,m);return f.table}return null};a.hideProperties=function(){if(this.properties!=null){this.properties.destroy();this.properties=null}};
a.showTasks=function(){if(this.tasks==null){var b=document.createElement("div");b.style.padding="4px";b.style.paddingLeft="20px";var d=document.body.clientWidth;d=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,b,d-220,this.tasksTop,200);d.setClosable(true);d.destroyOnClose=false;var e=mxUtils.bind(this,function(){mxEvent.release(b);b.innerHTML="";this.createTasks(b)});this.graph.getModel().addListener(mxEvent.CHANGE,e);this.graph.getSelectionModel().addListener(mxEvent.CHANGE,
e);this.graph.addListener(mxEvent.ROOT,e);this.tasksWindowImage!=null&&d.setImage(this.tasksWindowImage);this.tasks=d;this.createTasks(b)}this.tasks.setVisible(true)};a.refreshTasks=function(b){if(this.tasks!=null){b=this.tasks.content;mxEvent.release(b);b.innerHTML="";this.createTasks(b)}};a.createTasks=function(){};
a.showHelp=function(){if(this.help==null){var b=document.createElement("iframe");b.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);b.setAttribute("height","100%");b.setAttribute("width","100%");b.setAttribute("frameborder","0");b.style.backgroundColor="white";var d=document.body.clientWidth,e=document.body.clientHeight||document.documentElement.clientHeight,f=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,b,(d-this.helpWidth)/2,(e-this.helpHeight)/3,this.helpWidth,
this.helpHeight);f.setMaximizable(true);f.setClosable(true);f.destroyOnClose=false;f.setResizable(true);this.helpWindowImage!=null&&f.setImage(this.helpWindowImage);if(mxClient.IS_NS){d=function(){b.setAttribute("height",f.div.offsetHeight-26+"px")};f.addListener(mxEvent.RESIZE_END,d);f.addListener(mxEvent.MAXIMIZE,d);f.addListener(mxEvent.NORMALIZE,d);f.addListener(mxEvent.SHOW,d)}this.help=f}this.help.setVisible(true)};
a.showOutline=function(){if(this.outline==null){var b=document.createElement("div");b.style.overflow="hidden";b.style.width="100%";b.style.height="100%";b.style.background="white";b.style.cursor="move";var d=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,b,600,480,200,200,false),e=new mxOutline(this.graph,b);d.setClosable(true);d.setResizable(true);d.destroyOnClose=false;d.addListener(mxEvent.RESIZE_END,function(){e.update()});this.outline=d;this.outline.outline=e}this.outline.setVisible(true);
this.outline.outline.refresh()};a.setMode=function(b){if(b=="select"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(false)}else if(b=="connect"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(true)}else if(b=="pan"){this.graph.panningHandler.useLeftButtonForPanning=true;this.graph.setConnectable(false)}};a.createPopupMenu=function(b,d,e){this.popupHandler.createMenu(this,b,d,e)};
a.createEdge=function(){var b=null;if(this.defaultEdge!=null)b=this.graph.getModel().cloneCell(this.defaultEdge);else{b=new mxCell("");b.setEdge(true);var d=new mxGeometry;d.relative=true;b.setGeometry(d)}d=this.getEdgeStyle();d!=null&&b.setStyle(d);return b};a.getEdgeStyle=function(){return this.defaultEdgeStyle};
a.consumeCycleAttribute=function(b){return this.cycleAttributeValues!=null&&this.cycleAttributeValues.length>0&&this.graph.isSwimlane(b)?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null};a.cycleAttribute=function(b){if(this.cycleAttributeName!=null){var d=this.consumeCycleAttribute(b);d!=null&&b.setStyle(b.getStyle()+";"+this.cycleAttributeName+"="+d)}};
a.addVertex=function(b,d,e,f){for(var g=this.graph.getModel();b!=null&&!this.graph.isValidDropTarget(b);)b=g.getParent(b);b=b!=null?b:this.graph.getSwimlaneAt(e,f);var h=this.graph.getView().scale,j=g.getGeometry(d),k=g.getGeometry(b);if(this.graph.isSwimlane(d)&&!this.graph.swimlaneNesting)b=null;else if(b==null&&this.swimlaneRequired)return null;else if(b!=null&&k!=null){var l=this.graph.getView().getState(b);if(l!=null){e-=l.origin.x*h;f-=l.origin.y*h;if(this.graph.isConstrainedMoving){k=j.width;
var m=j.height,n=l.x+l.width;if(e+k>n)e-=e+k-n;n=l.y+l.height;if(f+m>n)f-=f+m-n}}else if(k!=null){e-=k.x*h;f-=k.y*h}}j=j.clone();j.x=this.graph.snap(e/h-this.graph.getView().translate.x-this.graph.gridSize/2);j.y=this.graph.snap(f/h-this.graph.getView().translate.y-this.graph.gridSize/2);d.setGeometry(j);if(b==null)b=this.graph.getDefaultParent();this.cycleAttribute(d);this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",d,"parent",b));g.beginUpdate();try{d=this.graph.addCell(d,b);
if(d!=null){this.graph.constrainChild(d);this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",d))}}finally{g.endUpdate()}if(d!=null){this.graph.setSelectionCell(d);this.graph.scrollCellToVisible(d);this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",d))}return d};
a.destroy=function(){if(!this.destroyed){this.destroyed=true;this.tasks!=null&&this.tasks.destroy();this.outline!=null&&this.outline.destroy();this.properties!=null&&this.properties.destroy();this.keyHandler!=null&&this.keyHandler.destroy();this.rubberband!=null&&this.rubberband.destroy();this.toolbar!=null&&this.toolbar.destroy();this.graph!=null&&this.graph.destroy();this.templates=this.status=null}};
var mxCodecRegistry={codecs:[],aliases:[],register:function(b){if(b!=null){var d=b.getName();mxCodecRegistry.codecs[d]=b;var e=mxUtils.getFunctionName(b.template.constructor);e!=d&&mxCodecRegistry.addAlias(e,d)}return b},addAlias:function(b,d){mxCodecRegistry.aliases[b]=d},getCodec:function(b){var d=null;if(b!=null){d=mxUtils.getFunctionName(b);var e=mxCodecRegistry.aliases[d];if(e!=null)d=e;d=mxCodecRegistry.codecs[d];if(d==null)try{d=new mxObjectCodec(new b);mxCodecRegistry.register(d)}catch(f){}}return d}};
function mxCodec(b){this.document=b||mxUtils.createXmlDocument();this.objects=[]}a=mxCodec.prototype;a.document=null;a.objects=null;a.encodeDefaults=false;a.putObject=function(b,d){return this.objects[b]=d};a.getObject=function(b){var d=null;if(b!=null){d=this.objects[b];if(d==null){d=this.lookup(b);if(d==null){b=this.getElementById(b);if(b!=null)d=this.decode(b)}}}return d};a.lookup=function(){return null};
a.getElementById=function(b,d){d=d||"id";return mxUtils.selectSingleNode(this.document,"//*[@"+d+"='"+b+"']")};a.getId=function(b){var d=null;if(b!=null){d=this.reference(b);if(d==null&&b.constructor==mxCell){d=b.getId();if(d==null){d=mxCellPath.create(b);if(d.length==0)d="root"}}}return d};a.reference=function(){return null};
a.encode=function(b){var d=null;if(b!=null&&b.constructor!=null){var e=mxCodecRegistry.getCodec(b.constructor);if(e!=null)d=e.encode(this,b);else if(isNode(b))d=mxClient.IS_IE?b.value.cloneNode(true):this.document.importNode(b.value,true);else mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(b.constructor))}return d};
a.decode=function(b,d){var e=null;if(b!=null&&b.nodeType==mxConstants.NODETYPE_ELEMENT){var f=null;try{f=eval(b.nodeName)}catch(g){}try{var h=mxCodecRegistry.getCodec(f);if(h!=null)e=h.decode(this,b,d);else{e=b.cloneNode(true);e.removeAttribute("as")}}catch(j){mxLog.debug("Cannot decode "+b.nodeName+": "+j.message)}}return e};a.encodeCell=function(b,d,e){d.appendChild(this.encode(b));if(e==null||e){e=b.getChildCount();for(var f=0;f<e;f++)this.encodeCell(b.getChildAt(f),d)}};
a.isCellCodec=function(b){if(b!=null&&typeof b.isCellCodec=="function")return b.isCellCodec();return false};
a.decodeCell=function(b,d){var e=null;if(b!=null&&b.nodeType==mxConstants.NODETYPE_ELEMENT){e=mxCodecRegistry.getCodec(b.nodeName);if(!this.isCellCodec(e))for(var f=b.firstChild;f!=null&&!this.isCellCodec(e);){e=mxCodecRegistry.getCodec(f.nodeName);f=f.nextSibling}this.isCellCodec(e)||(e=mxCodecRegistry.getCodec(mxCell));e=e.decode(this,b);if(d==null||d){b=e.getParent();b!=null&&b.insert(e);b=e.getTerminal(true);b!=null&&b.insertEdge(e,true);b=e.getTerminal(false);b!=null&&b.insertEdge(e,false)}}return e};
a.setAttribute=function(b,d,e){d!=null&&e!=null&&b.setAttribute(d,e)};function mxObjectCodec(b,d,e,f){this.template=b;this.exclude=d!=null?d:[];this.idrefs=e!=null?e:[];this.mapping=f!=null?f:[];this.reverse={};for(var g in this.mapping)this.reverse[this.mapping[g]]=g}a=mxObjectCodec.prototype;a.template=null;a.exclude=null;a.idrefs=null;a.mapping=null;a.reverse=null;a.getName=function(){return mxUtils.getFunctionName(this.template.constructor)};a.cloneTemplate=function(){return new this.template.constructor};
a.getFieldName=function(b){if(b!=null){var d=this.reverse[b];if(d!=null)b=d}return b};a.getAttributeName=function(b){if(b!=null){var d=this.mapping[b];if(d!=null)b=d}return b};a.isExcluded=function(b,d){return d==mxObjectIdentity.FIELD_NAME||mxUtils.indexOf(this.exclude,d)>=0};a.isReference=function(b,d){return mxUtils.indexOf(this.idrefs,d)>=0};a.encode=function(b,d){var e=b.document.createElement(this.getName());d=this.beforeEncode(b,d,e);this.encodeObject(b,d,e);return this.afterEncode(b,d,e)};
a.encodeObject=function(b,d,e){b.setAttribute(e,"id",b.getId(d));for(var f in d){var g=f,h=d[g];if(h!=null&&!this.isExcluded(d,g,h,true)){if(mxUtils.isNumeric(g))g=null;this.encodeValue(b,d,g,h,e)}}};
a.encodeValue=function(b,d,e,f,g){if(f!=null){if(this.isReference(d,e,f,true)){var h=b.getId(f);if(h==null){mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+e+"="+f);return}f=h}h=this.template[e];if(e==null||b.encodeDefaults||h!=f){e=this.getAttributeName(e);this.writeAttribute(b,d,e,f,g)}}};a.writeAttribute=function(b,d,e,f,g){typeof f!="object"?this.writePrimitiveAttribute(b,d,e,f,g):this.writeComplexAttribute(b,d,e,f,g)};
a.writePrimitiveAttribute=function(b,d,e,f,g){f=this.convertValueToXml(f);if(e==null){d=b.document.createElement("add");typeof f=="function"?d.appendChild(b.document.createTextNode(f)):b.setAttribute(d,"value",f);g.appendChild(d)}else typeof f!="function"&&b.setAttribute(g,e,f)};a.writeComplexAttribute=function(b,d,e,f,g){b=b.encode(f);if(b!=null){e!=null&&b.setAttribute("as",e);g.appendChild(b)}else mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+e+": "+f)};
a.convertValueToXml=function(b){if(typeof b.length=="undefined"&&(b==true||b==false))b=b==true?"1":"0";return b};a.convertValueFromXml=function(b){if(mxUtils.isNumeric(b))b=parseFloat(b);return b};a.beforeEncode=function(b,d){return d};a.afterEncode=function(b,d,e){return e};a.decode=function(b,d,e){var f=d.getAttribute("id"),g=b.objects[f];if(g==null){g=e||this.cloneTemplate();f!=null&&b.putObject(f,g)}d=this.beforeDecode(b,d,g);this.decodeNode(b,d,g);return this.afterDecode(b,d,g)};
a.decodeNode=function(b,d,e){if(d!=null){this.decodeAttributes(b,d,e);this.decodeChildren(b,d,e)}};a.decodeAttributes=function(b,d,e){d=d.attributes;if(d!=null)for(var f=0;f<d.length;f++)this.decodeAttribute(b,d[f],e)};
a.decodeAttribute=function(b,d,e){var f=d.nodeName;if(f!="as"&&f!="id"){d=this.convertValueFromXml(d.nodeValue);var g=this.getFieldName(f);if(this.isReference(e,g,d,false)){b=b.getObject(d);if(b==null){mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+f+"="+d);return}d=b}this.isExcluded(e,f,d,false)||(e[f]=d)}};
a.decodeChildren=function(b,d,e){for(d=d.firstChild;d!=null;){var f=d.nextSibling;d.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(b,d,e)&&this.decodeChild(b,d,e);d=f}};
a.decodeChild=function(b,d,e){var f=this.getFieldName(d.getAttribute("as"));if(f==null||!this.isExcluded(e,f,d,false)){var g=null,h=e[f];if(d.nodeName=="add"){g=d.getAttribute("value");if(g==null)g=mxUtils.eval(mxUtils.getTextContent(d))}else{if(h instanceof Array&&h.length>0)h=null;g=b.decode(d,h)}if(g!=null&&g!=h)if(f!=null&&f.length>0)e[f]=g;else e.push(g)}};
a.processInclude=function(b,d,e){if(d.nodeName=="include"){d=d.getAttribute("name");if(d!=null)try{var f=mxUtils.load(d).getDocumentElement();f!=null&&b.decode(f,e)}catch(g){}return true}return false};a.beforeDecode=function(b,d){return d};a.afterDecode=function(b,d,e){return e};
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxCell,["children","edges","overlays","mxTransient"],["parent","source","target"]);b.isCellCodec=function(){return true};b.isExcluded=function(d,e,f,g){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||g&&e=="value"&&f.nodeType==mxConstants.NODETYPE_ELEMENT};b.afterEncode=function(d,e,f){if(e.value!=null&&e.value.nodeType==mxConstants.NODETYPE_ELEMENT){var g=f;f=mxClient.IS_IE?e.value.cloneNode(true):d.document.importNode(e.value,
true);f.appendChild(g);d=g.getAttribute("id");f.setAttribute("id",d);g.removeAttribute("id")}return f};b.beforeDecode=function(d,e,f){var g=e,h=this.getName();if(e.nodeName!=h){g=e.getElementsByTagName(h)[0];if(g!=null&&g.parentNode==e){mxUtils.removeWhitespace(g,true);mxUtils.removeWhitespace(g,false);g.parentNode.removeChild(g);g=g}else g=null;f.value=e.cloneNode(true);e=f.value.getAttribute("id");if(e!=null){f.setId(e);f.value.removeAttribute("id")}}else f.setId(e.getAttribute("id"));if(g!=null)for(e=
0;e<this.idrefs.length;e++){h=this.idrefs[e];var j=g.getAttribute(h);if(j!=null){g.removeAttribute(h);var k=d.objects[j]||d.lookup(j);if(k==null){j=d.getElementById(j);if(j!=null)k=(mxCodecRegistry.codecs[j.nodeName]||this).decode(d,j)}f[h]=k}}return g};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxGraphModel);b.encode=function(d,e){var f=d.document.createElement(this.getName()),g=d.document.createElement("root");d.encodeCell(e.getRoot(),g);f.appendChild(g);return f};b.decodeChild=function(d,e,f){e.nodeName=="root"?this.decodeRoot(d,e,f):mxObjectCodec.prototype.decodeChild.apply(this,arguments)};b.decodeRoot=function(d,e,f){var g=null;for(e=e.firstChild;e!=null;){var h=d.decodeCell(e);if(h!=null&&h.getParent()==null)g=h;e=e.nextSibling}g!=
null&&f.setRoot(g)};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxRootChange,["model","previous","root"]);b.afterEncode=function(d,e,f){d.encodeCell(e.root,f);return f};b.beforeDecode=function(d,e,f){if(e.firstChild!=null&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var g=e.firstChild;f.root=d.decodeCell(g,false);f=g.nextSibling;g.parentNode.removeChild(g);for(g=f;g!=null;){f=g.nextSibling;d.decodeCell(g);g.parentNode.removeChild(g);g=f}}return e};b.afterDecode=function(d,e,f){f.previous=
f.root;return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxChildChange,["model","previous","previousIndex","child"],["parent"]);b.isReference=function(d,e,f,g){if(e=="child"&&(d.previous!=null||!g))return true;return mxUtils.indexOf(this.idrefs,e)>=0};b.afterEncode=function(d,e,f){this.isReference(e,"child",e.child,true)?f.setAttribute("child",d.getId(e.child)):d.encodeCell(e.child,f);return f};b.beforeDecode=function(d,e,f){if(e.firstChild!=null&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var g=
e.firstChild;f.child=d.decodeCell(g,false);f=g.nextSibling;g.parentNode.removeChild(g);for(g=f;g!=null;){f=g.nextSibling;if(g.nodeType==mxConstants.NODETYPE_ELEMENT){var h=g.getAttribute("id");d.lookup(h)==null&&d.decodeCell(g)}g.parentNode.removeChild(g);g=f}}else{g=e.getAttribute("child");f.child=d.getObject(g)}return e};b.afterDecode=function(d,e,f){f.previous=f.parent;f.previousIndex=f.index;return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxTerminalChange,["model","previous"],["cell","terminal"]);b.afterDecode=function(d,e,f){f.previous=f.terminal;return f};return b}());var mxGenericChangeCodec=function(b,d){b=new mxObjectCodec(b,["model","previous"],["cell"]);b.afterDecode=function(e,f,g){if(mxUtils.isNode(g.cell))g.cell=e.decodeCell(g.cell);if(g.previous==null)g.previous=g[d];return g};return b};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange,"value"));
mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange,"style"));mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange,"geometry"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange,"collapsed"));mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange,"visible"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange,"value"));
mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph,["graphListeners","eventListeners","view","container","cellRenderer","editor","selection"])}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxGraphView);b.encode=function(d,e){return this.encodeCell(d,e,e.graph.getModel().getRoot())};b.encodeCell=function(d,e,f){var g=e.graph.getModel(),h=e.getState(f),j=g.getChildCount(f),k=g.getParent(f),l=e.graph.getCellGeometry(f),m=null;if(k==g.getRoot())m="layer";else if(k==null)m="graph";else if(g.isEdge(f))m="edge";else if(j>0&&l!=null)m="group";else if(g.isVertex(f))m="vertex";if(m!=null){var n=d.document.createElement(m);if(e.graph.getLabel(f)!=
null){n.setAttribute("label",e.graph.getLabel(f));e.graph.isHtmlLabel(f)&&n.setAttribute("html",true)}if(k==null){h=e.getGraphBounds();if(h!=null){n.setAttribute("x",Math.round(h.x));n.setAttribute("y",Math.round(h.y));n.setAttribute("width",Math.round(h.width));n.setAttribute("height",Math.round(h.height))}n.setAttribute("scale",e.scale)}else if(h!=null&&l!=null){for(var o in h.style){k=h.style[o];if(typeof k=="function"&&typeof k=="object")k=mxStyleRegistry.getName(k);k!=null&&typeof k!="function"&&
typeof k!="object"&&n.setAttribute(o,k)}k=h.absolutePoints;if(k!=null&&k.length>0){l=Math.round(k[0].x)+","+Math.round(k[0].y);for(o=1;o<k.length;o++)l+=" "+Math.round(k[o].x)+","+Math.round(k[o].y);n.setAttribute("points",l)}else{n.setAttribute("x",Math.round(h.x));n.setAttribute("y",Math.round(h.y));n.setAttribute("width",Math.round(h.width));n.setAttribute("height",Math.round(h.height))}h=h.absoluteOffset;if(h!=null){h.x!=0&&n.setAttribute("dx",Math.round(h.x));h.y!=0&&n.setAttribute("dy",Math.round(h.y))}}}for(o=
0;o<j;o++)n.appendChild(this.encodeCell(d,e,g.getChildAt(f,o)));return n};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxStylesheet);b.encode=function(d,e){var f=d.document.createElement(this.getName());for(var g in e.styles){var h=e.styles[g],j=d.document.createElement("add");if(g!=null){j.setAttribute("as",g);for(var k in h){var l=d.document.createElement("add");l.setAttribute("as",k);var m=typeof h[k];if(m=="function"){m=mxStyleRegistry.getName(h[k]);m!=null&&l.setAttribute("value",m)}else m!="object"&&l.setAttribute("value",h[k]);j.appendChild(l)}j.childNodes.length>
0&&f.appendChild(j)}}return f};b.decode=function(d,e,f){f=f||new this.template.constructor;var g=e.getAttribute("id");if(g!=null)d.objects[g]=f;for(e=e.firstChild;e!=null;){if(!this.processInclude(d,e,f)&&e.nodeName=="add"){g=e.getAttribute("as");if(g!=null){var h=e.getAttribute("extend"),j=h!=null?mxUtils.clone(f.styles[h]):null;if(j==null){h!=null&&mxLog.warn("mxStylesheetCodec.decode: stylesheet "+h+" not found to extend");j={}}for(h=e.firstChild;h!=null;){if(h.nodeType==mxConstants.NODETYPE_ELEMENT){var k=
h.getAttribute("as");if(h.nodeName=="add"){var l=mxUtils.getTextContent(h),m=null;if(l!=null&&l.length>0)m=mxUtils.eval(l);else{m=h.getAttribute("value");if(mxUtils.isNumeric(m))m=parseFloat(m)}if(m!=null)j[k]=m}else h.nodeName=="remove"&&delete j[k]}h=h.nextSibling}f.putCellStyle(g,j)}}e=e.nextSibling}return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxDefaultKeyHandler);b.encode=function(){return null};b.decode=function(d,e,f){if(f!=null)for(e=e.firstChild;e!=null;){if(!this.processInclude(d,e,f)&&e.nodeName=="add"){var g=e.getAttribute("as"),h=e.getAttribute("action"),j=e.getAttribute("control");f.bindAction(g,h,j)}e=e.nextSibling}return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxDefaultToolbar);b.encode=function(){return null};b.decode=function(d,e,f){if(f!=null){var g=f.editor;g.graph.getModel();for(e=e.firstChild;e!=null;){if(e.nodeType==mxConstants.NODETYPE_ELEMENT)if(!this.processInclude(d,e,f))if(e.nodeName=="separator")f.addSeparator();else if(e.nodeName=="br")f.toolbar.addBreak();else if(e.nodeName=="hr")f.toolbar.addLine();else if(e.nodeName=="add"){var h=e.getAttribute("as");h=mxResources.get(h)||
h;var j=e.getAttribute("icon"),k=e.getAttribute("pressedIcon"),l=e.getAttribute("action"),m=e.getAttribute("mode"),n=e.getAttribute("template");if(l!=null)f.addItem(h,j,l,k);else if(m!=null){var o=mxUtils.eval(mxUtils.getTextContent(e));f.addMode(h,j,m,k,o)}else if(n!=null){n=g.templates[n];l=e.getAttribute("style");if(l!=null){n=n.clone();n.setStyle(l)}l=null;m=mxUtils.getTextContent(e);if(m!=null&&m.length>0)l=mxUtils.eval(m);f.addPrototype(h,j,n,k,l)}else{k=mxUtils.getChildNodes(e);if(k.length>
0)if(j==null){n=f.addActionCombo(h);for(h=0;h<k.length;h++){l=k[h];if(l.nodeName=="separator")f.addOption(n,"---");else if(l.nodeName=="add"){j=l.getAttribute("as");l=l.getAttribute("action");f.addActionOption(n,j,l)}}}else{var p=null,q=f.addPrototype(h,j,function(){var r=g.templates[p.value];if(r!=null){r=r.clone();var s=p.options[p.selectedIndex].cellStyle;s!=null&&r.setStyle(s);return r}else mxLog.warn("Template "+r+" not found");return null});p=f.addCombo();mxEvent.addListener(p,"change",function(){f.toolbar.selectMode(q,
function(r){r=mxUtils.convertPoint(g.graph.container,mxEvent.getClientX(r),mxEvent.getClientY(r));return g.addVertex(null,o(),r.x,r.y)});f.toolbar.noReset=false});for(h=0;h<k.length;h++){l=k[h];if(l.nodeName=="separator")f.addOption(p,"---");else if(l.nodeName=="add"){j=l.getAttribute("as");m=l.getAttribute("template");f.addOption(p,j,m||n).cellStyle=l.getAttribute("style")}}}}}e=e.nextSibling}}return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxDefaultPopupMenu);b.encode=function(){return null};b.decode=function(d,e,f){var g=e.getElementsByTagName("include")[0];if(g!=null)this.processInclude(d,g,f);else if(f!=null)f.config=e;return f};return b}());
mxCodecRegistry.register(function(){var b=new mxObjectCodec(new mxEditor,["modified","lastSnapshot","ignoredChanges","undoManager","graphContainer","toolbarContainer"]);b.afterDecode=function(d,e,f){d=e.getAttribute("defaultEdge");if(d!=null){e.removeAttribute("defaultEdge");f.defaultEdge=f.templates[d]}d=e.getAttribute("defaultGroup");if(d!=null){e.removeAttribute("defaultGroup");f.defaultGroup=f.templates[d]}return f};b.decodeChild=function(d,e,f){if(e.nodeName=="Array"){if(e.getAttribute("as")==
"templates"){this.decodeTemplates(d,e,f);return}}else if(e.nodeName=="ui"){this.decodeUi(d,e,f);return}mxObjectCodec.prototype.decodeChild.apply(this,arguments)};b.decodeUi=function(d,e,f){for(d=e.firstChild;d!=null;){if(d.nodeName=="add"){e=d.getAttribute("as");var g=d.getAttribute("element"),h=d.getAttribute("style"),j=null;if(g!=null){j=document.getElementById(g);if(j!=null&&h!=null)j.style.cssText+=";"+h}else{g=parseInt(d.getAttribute("x"));var k=parseInt(d.getAttribute("y")),l=d.getAttribute("width"),
m=d.getAttribute("height");j=document.createElement("div");j.style.cssText=h;(new mxWindow(mxResources.get(e)||e,j,g,k,l,m,false,true)).setVisible(true)}if(e=="graph")f.setGraphContainer(j);else if(e=="toolbar")f.setToolbarContainer(j);else if(e=="title")f.setTitleContainer(j);else if(e=="status")f.setStatusContainer(j);else e=="map"&&f.setMapContainer(j)}else if(d.nodeName=="resource")mxResources.add(d.getAttribute("basename"));else d.nodeName=="stylesheet"&&mxClient.link("stylesheet",d.getAttribute("name"));
d=d.nextSibling}};b.decodeTemplates=function(d,e,f){if(f.templates==null)f.templates=[];e=mxUtils.getChildNodes(e);for(var g=0;g<e.length;g++){for(var h=e[g].getAttribute("as"),j=e[g].firstChild;j!=null&&j.nodeType!=1;)j=j.nextSibling;if(j!=null)f.templates[h]=d.decodeCell(j)}};return b}());mxClient.IS_NS&&!mxClient.IS_GC&&1&&mxClient.include("chrome://global/content/contentAreaUtils.js");mxClient.IS_IE&&window.attachEvent("onunload",function(){mxClient.unload()});